<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../../css/wolai.css"/><title>Windows-12.1.0经典模式 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font less-lead"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="Windows-12.1.0经典模式" class="main-title"></div></div></header><article><h1 id="9DFQYHU1cGHxUu4iGBLQDU" class="wolai-block"><span class="inline-wrap">安装<span class="jill"></span>ogg</span></h1><ol class="wolai-block"><li id="qbbtTfXc1fqqrK7MQYg4gd"><div class="marker"></div><span class="inline-wrap">运行<span class="jill"></span>setup.exe<span class="jill"></span>进行安装<span class="jill"></span>ogg</span></li><li id="gHz1N3AwnmEPEeyxkhaaSP"><div class="marker"></div><span class="inline-wrap">安装完成后，运行<span class="jill"></span>ggsci.exe</span></li><li id="e56mgXyDwqquR5BCwsmsxY"><div class="marker"></div><span class="inline-wrap">在<span class="jill"></span>sysdm.cpl<span class="jill"></span>设定<span class="jill"></span>ORACLE_SID<span class="jill"></span>和<span class="jill"></span>ORALCE_HOME</span></li></ol><h1 id="uQ2AN53CCTuuQ1GQYiVUSm" class="wolai-block"><span class="inline-wrap">补充：目标库<span class="jill"></span>DDL</span></h1><div id="aPEooaHXVZBYSQMh3ckr8u" class="wolai-block wolai-text"><div><span class="inline-wrap">如果目标库是空库，初始化之前需要先执行源库的<span class="jill"></span>DDL<span class="jill"></span>语句，</span></div></div><blockquote id="wt8W64P5pXVWMQk1ueJUNw" class="wolai-block"><span class="inline-wrap">前置语句</span></blockquote><code-block id="g8VgcknNNkpHYvebqvzpHi" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">set</span> long <span class="token number">99999</span>         
<span class="token keyword">set</span> pagesize <span class="token number">1000</span></pre></div></code-block><ol class="wolai-block"><li id="pUABWcCij6Bttf9q5mXt6w"><div class="marker"></div><span class="inline-wrap">确定<span class="jill"></span>schema<span class="jill"></span>的表空间</span><code-block id="crzCoa82qC2D3nyDafax9L" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">select</span> DEFAULT_TABLESPACE<span class="token punctuation">,</span>TEMPORARY_TABLESPACE <span class="token keyword">from</span> dba_users <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">'TENGFEI'</span><span class="token punctuation">;</span></pre></div></code-block></li><li id="u7Xgz9LzRUNsZvtmmjiNGA"><div class="marker"></div><span class="inline-wrap">导出用户表空间<span class="jill"></span>DDL</span><code-block id="2uptye3EWx1PYc6k9bHrqB" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SELECT</span> DBMS_METADATA<span class="token punctuation">.</span>GET_DDL<span class="token punctuation">(</span><span class="token string">'TABLESPACE'</span><span class="token punctuation">,</span> TS<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> DBA_TABLESPACES TS <span class="token keyword">where</span> ts<span class="token punctuation">.</span>tablespace_name<span class="token operator">=</span><span class="token string">'XY'</span><span class="token punctuation">;</span></pre></div></code-block></li><li id="8EmxssDEkV4TNpbeJgyaRV"><div class="marker"></div><span class="inline-wrap">导出<span class="jill"></span>schemaDDL</span><code-block id="7skzDt89e32tcxSKgHaVQX" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SELECT</span> DBMS_METADATA<span class="token punctuation">.</span>GET_DDL<span class="token punctuation">(</span><span class="token string">'USER'</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span> <span class="token keyword">FROM</span> DBA_USERS <span class="token keyword">WHERE</span> USERNAME<span class="token operator">=</span><span class="token string">'TENGFEI'</span><span class="token punctuation">;</span>

<span class="token comment">-- GRANT UNLIMITED TABLESPACE TO &lt;SCHEMA></span>
<span class="token comment">-- GRANT CREATE SESSION TO &lt;SCHEMA></span></pre></div></code-block></li><li id="e99Y5gRViZmSZEtsiRqJR4"><div class="marker"></div><span class="inline-wrap">连接业务用户后，导出表、索引、存储过程<span class="jill"></span>DDL</span><code-block id="oKBYKPt55xtjbkjr2ra5Hg" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SELECT</span> DBMS_METADATA<span class="token punctuation">.</span>GET_DDL<span class="token punctuation">(</span>U<span class="token punctuation">.</span>OBJECT_TYPE<span class="token punctuation">,</span> u<span class="token punctuation">.</span>object_name<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> USER_OBJECTS u
<span class="token keyword">where</span> U<span class="token punctuation">.</span>OBJECT_TYPE <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'TABLE'</span><span class="token punctuation">,</span><span class="token string">'INDEX'</span><span class="token punctuation">,</span><span class="token string">'PROCEDURE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></li></ol><h1 id="qiduj2i3DdDTSpCab3Rn4n" class="wolai-block"><span class="inline-wrap">一、双端：基础配置</span></h1><ol class="wolai-block"><li id="f1wwrCfEcdh1EyP6iFYDkP"><div class="marker"></div><span class="inline-wrap">打开数据库附加日志和<span class="jill"></span>force log</span><code-block id="tq3svoygtd1fmcGBUUfRTC" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">select</span> open_mode<span class="token punctuation">,</span>force_logging<span class="token punctuation">,</span>supplemental_log_data_min <span class="token keyword">from</span> v$<span class="token keyword">database</span><span class="token punctuation">;</span>
OPEN_MODE	           <span class="token keyword">FOR</span> SUPPLEME
<span class="token comment">-------------------- --- --------</span>
<span class="token keyword">READ</span> <span class="token keyword">WRITE</span>	         <span class="token keyword">NO</span> <span class="token keyword">NO</span>


<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">shutdown</span> immediate<span class="token punctuation">;</span> 
<span class="token keyword">SQL</span><span class="token operator">></span> startup mount<span class="token punctuation">;</span> 
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">force</span> logging<span class="token punctuation">;</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">database</span> archivelog<span class="token punctuation">;</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">open</span><span class="token punctuation">;</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">add</span> supplemental log <span class="token keyword">data</span><span class="token punctuation">;</span>
<span class="token comment">-- 关闭补充日志:alter database drop supplemental log data;</span></pre></div></code-block></li><li id="nrQqhtstUb4azVLSwzXQuz"><div class="marker"></div><span class="inline-wrap">创建<span class="jill"></span>ogg<span class="jill"></span>表空间,并创建用户</span><code-block id="gAev9VPTa7xiPpM37hpvw3" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">tablespace</span> ogg datafile <span class="token string">'C:\app\Administrator\oradata\ogg01.dbf'</span> size <span class="token number">50</span>M autoextend <span class="token keyword">on</span><span class="token punctuation">;</span>
<span class="token keyword">Tablespace</span> created<span class="token punctuation">.</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">create</span> <span class="token keyword">user</span> ogg identified <span class="token keyword">by</span> ogg <span class="token keyword">default</span> <span class="token keyword">tablespace</span> ogg<span class="token punctuation">;</span>
<span class="token keyword">User</span> created<span class="token punctuation">.</span></pre></div></code-block></li><li id="kuac6Txz1zhgeSTCpu2Mrb"><div class="marker"></div><span class="inline-wrap">使用<span class="jill"></span>sqlplus<span class="jill"></span>安装<span class="jill"></span>marker<span class="jill"></span>表和<span class="jill"></span>Security Role</span><code-block id="iWL4R2XpVxT1mP3KDh8upq" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token comment">-- 进入ogg安装目录</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token variable">@marker_setup.sql</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token variable">@role_setup.sql</span>
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">GRANT</span> GGS_GGSUSER_ROLE <span class="token keyword">TO</span> <span class="token operator">&lt;</span>loggedUser<span class="token operator">></span><span class="token punctuation">;</span></pre></div></code-block></li><li id="rJ32jeTA9LzikBhqRo8nd6"><div class="marker"></div><span class="inline-wrap">赋权</span><span class="inline-wrap">
</span><span class="inline-wrap">连接资源、查找任何字典和表、在<span class="jill"></span>dmbs<span class="jill"></span>闪回表执行、闪回修改插入更新任何表、</span><code-block id="wEk4tua62h8EqGPdoZaeBE" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">grant</span> <span class="token keyword">CONNECT</span><span class="token punctuation">,</span> RESOURCE <span class="token keyword">to</span> ogg<span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">SELECT</span> <span class="token keyword">ANY</span> DICTIONARY <span class="token keyword">to</span> ogg<span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">EXECUTE</span> <span class="token keyword">on</span> DBMS_FLASHBACK <span class="token keyword">to</span> ogg<span class="token punctuation">;</span>
<span class="token keyword">grant</span> 
<span class="token keyword">select</span> <span class="token keyword">any</span> <span class="token keyword">table</span><span class="token punctuation">,</span>
flashback <span class="token keyword">any</span> <span class="token keyword">table</span><span class="token punctuation">,</span>
<span class="token keyword">insert</span> <span class="token keyword">any</span> <span class="token keyword">table</span><span class="token punctuation">,</span>
<span class="token keyword">update</span> <span class="token keyword">any</span> <span class="token keyword">table</span><span class="token punctuation">,</span>
<span class="token keyword">alter</span> <span class="token keyword">any</span> <span class="token keyword">table</span><span class="token punctuation">,</span>
<span class="token keyword">delete</span> <span class="token keyword">any</span> <span class="token keyword">table</span> <span class="token keyword">to</span> ogg<span class="token punctuation">;</span>
</pre></div></code-block></li><li id="g8sPoJLMh3mYVYVnTKK8fT"><div class="marker"></div><span class="inline-wrap">创建管理目录</span><code-block id="cQnupFHVtAFFaX9wQbPJq3" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>WIN<span class="token operator">-</span>QHLFMQGHCTV<span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> <span class="token keyword">create</span> subdirs

Creating subdirectories under <span class="token keyword">current</span> directory C:\ogg

Parameter <span class="token keyword">file</span>                 C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirprm: created<span class="token punctuation">.</span>
Report <span class="token keyword">file</span>                    C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirrpt: created<span class="token punctuation">.</span>
<span class="token keyword">Checkpoint</span> <span class="token keyword">file</span>                C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirchk: created<span class="token punctuation">.</span>
Process <span class="token keyword">status</span> files           C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirpcs: created<span class="token punctuation">.</span>
<span class="token keyword">SQL</span> script files               C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirsql: created<span class="token punctuation">.</span>
<span class="token keyword">Database</span> definitions files     C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirdef: created<span class="token punctuation">.</span>
Extract <span class="token keyword">data</span> files             C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirdat: created<span class="token punctuation">.</span>
<span class="token keyword">Temporary</span> files                C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirtmp: created<span class="token punctuation">.</span>
Credential store files         C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dircrd: created<span class="token punctuation">.</span>
Masterkey wallet files         C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirwlt: created<span class="token punctuation">.</span>
<span class="token keyword">Dump</span> files                     C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirdmp: created<span class="token punctuation">.</span></pre></div></code-block></li><li id="wB58pXsWLfK1Gda9U3ukHE"><div class="marker"></div><span class="inline-wrap">==源端==：从<span class="jill"></span>sqplus<span class="jill"></span>创建的用户登录<span class="jill"></span>ggsci</span><code-block id="pErdBKn7Wq9CqYsFv2ieuM" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>WIN<span class="token operator">-</span>QHLFMQGHCTV<span class="token punctuation">)</span> <span class="token number">1</span><span class="token operator">></span> dblogin userid ogg<span class="token punctuation">,</span>password ogg
Successfully logged <span class="token keyword">into</span> <span class="token keyword">database</span><span class="token punctuation">.</span>

<span class="token comment"># 源端添加表级TRANDATA</span>
GGSCI <span class="token punctuation">(</span>WIN<span class="token operator">-</span>QHLFMQGHCTV<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> <span class="token keyword">add</span> trandata tengfei<span class="token punctuation">.</span><span class="token operator">*</span>
Logging <span class="token keyword">of</span> supplemental redo <span class="token keyword">data</span> enabled <span class="token keyword">for</span> <span class="token keyword">table</span> TENGFEI<span class="token punctuation">.</span>IDT<span class="token punctuation">.</span>

<span class="token comment"># 查看哪些表添加了TRANDATA</span>
GGSCI <span class="token punctuation">(</span>WIN<span class="token operator">-</span>QHLFMQGHCTV<span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> info trandata tengfei<span class="token punctuation">.</span><span class="token operator">*</span>
Logging <span class="token keyword">of</span> supplemental redo log <span class="token keyword">data</span> <span class="token operator">is</span> enabled <span class="token keyword">for</span> <span class="token keyword">table</span> TENGFEI<span class="token punctuation">.</span>IDT<span class="token punctuation">.</span>
<span class="token keyword">Columns</span> supplementally logged <span class="token keyword">for</span> <span class="token keyword">table</span> TENGFEI<span class="token punctuation">.</span>IDT: ID3<span class="token punctuation">,</span> ID2<span class="token punctuation">,</span> ID<span class="token punctuation">.</span></pre></div></code-block></li></ol><h1 id="sRktr6G4DYZJaoux77sJe3" class="wolai-block"><span class="inline-wrap">二、双端：配置与启动管理进程与服务</span></h1><h2 id="5DSoafsXBKxCfkVEa9o8wp" class="wolai-block"><span class="inline-wrap">配置服务</span></h2><ol class="wolai-block"><li id="tvQF51Q4djmcvwZJaxwh6n"><div class="marker"></div><span class="inline-wrap">进入安装目录，配置全局文件，指定<span class="jill"></span>mgr<span class="jill"></span>的服务名</span><code-block id="tCpkMgaYGtamvT2rmPFBcr" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">EDIT</span> <span class="token constant">PARAMS</span> <span class="token constant">GLOBALS</span></pre></div></code-block></li><li id="qZvb8ZBfKmrvfdPbTpTJbY"><div class="marker"></div><span class="inline-wrap">使用<span class="jill"></span>ogg-mgr<span class="jill"></span>作为服务名(如不指定默认使用<span class="jill"></span>GGSMGR)</span><code-block id="5VL89vbk7QQdujDP7BBRxe" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">MGRSERVNAME</span> ogg<span class="token operator">-</span>mgr</pre></div></code-block></li><li id="nmhVbMY4FBynhiNrbipTyd"><div class="marker"></div><span class="inline-wrap">进入安装目录，使用管理员打开命令行</span><code-block id="dh6Do6ziB2DNjvBRwWW5JD" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token punctuation">.</span>\install<span class="token punctuation">.</span><span class="token property-access">exe</span> <span class="token constant">ADDSERVICE</span></pre></div></code-block></li><li id="tSusUF6dv1yBqXV9n4pUnJ"><div class="marker"></div><span class="inline-wrap">设定为自动启动</span><code-block id="9SevBnD8nRNST6BM8fNYjT" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token punctuation">.</span>\install<span class="token punctuation">.</span><span class="token property-access">exe</span> <span class="token constant">AUTOSTART</span></pre></div></code-block></li><li id="fxx3ke6pfwGUFVfRZbdstf"><div class="marker"></div><span class="inline-wrap">判断安装情况</span><code-block id="qFoMKq2w6UPpw2SVtJ235T" class="wolai-block"><div class="wolai-pre"><div data-lang="Powershell" class="marker"></div><pre><span class="token function">PS</span> C:\ogg> <span class="token function">GET-Service</span> <span class="token operator">-</span>Name ogg-mgr

Status   Name               DisplayName
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span>               <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
Stopped  ogg-mgr             ogg-mgr</pre></div></code-block></li></ol><div id="iwkaVbVshnPN2TQeXZmJ9Q" class="wolai-block wolai-text"><div><span class="inline-wrap">其他运行方式参考：</span></div></div><div id="abDSp1Cga6sHC5wSvqvxvh" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 370px"><span class="inline-wrap">选项</span></th><th style="width: 370px"><span class="inline-wrap">描述</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">ADDEVENTS</span></td><td><span class="inline-wrap">将<span class="jill"></span>Oracle GoldenGate<span class="jill"></span>事件添加到<span class="jill"></span>Windows<span class="jill"></span>事件管理器中。</span></td></tr><tr><td><span class="inline-wrap">ADDSERVICE</span></td><td><span class="inline-wrap">将管理器添加为服务，其名称由</span><span class="inline-wrap"><code>GLOBALS</code></span><span class="inline-wrap">文件中的</span><span class="inline-wrap"><code>MGRSERVNAME</code></span><span class="inline-wrap">参数（如果有的话）或</span><span class="inline-wrap"><code>GGSMGR</code></span><span class="inline-wrap">默认值指定。ADDSERVICE<span class="jill"></span>将服务配置为本地系统帐户运行，这是大多数<span class="jill"></span>Windows<span class="jill"></span>应用程序的标准，因为该服务可以独立于用户登录和密码更改运行。要将管理器作为特定帐户运行，请使用</span><span class="inline-wrap"><code>USER</code></span><span class="inline-wrap">和</span><span class="inline-wrap"><code>PASSWORD</code></span><span class="inline-wrap">选项。</span><span class="inline-wrap"><a href="https://docs.oracle.com/en/middleware/goldengate/core/19.1/installing/installing-manager-windows-service.html#fn_1"><span></span></a></span><span class="inline-wrap"><a href="https://docs.oracle.com/en/middleware/goldengate/core/19.1/installing/installing-manager-windows-service.html#fn_1"><span>Foot 1</span></a></span><span class="inline-wrap">安装该服务是为了在系统启动时启动（请参阅</span><span class="inline-wrap"><code>AUTOSTART</code></span><span class="inline-wrap">）。要在安装后启动它，请重新启动系统或从控制面板中的服务小程序手动启动服务。</span></td></tr><tr><td><span class="inline-wrap">AUTOSTART</span></td><td><span class="inline-wrap">设置使用</span><span class="inline-wrap"><code>ADDSERVICE</code></span><span class="inline-wrap">创建的服务，以便在系统启动时启动。除非使用</span><span class="inline-wrap"><code>MANUALSTART</code></span><span class="inline-wrap">，否则这是默认值。</span></td></tr><tr><td><span class="inline-wrap">MANUALSTART</span></td><td><span class="inline-wrap">设置使用</span><span class="inline-wrap"><code>ADDSERVICE</code></span><span class="inline-wrap">创建的服务，以通过控制面板中的<span class="jill"></span>GGSCI、脚本或服务小程序手动启动。默认是</span><span class="inline-wrap"><code>AUTOSTART</code></span><span class="inline-wrap">。</span></td></tr><tr><td><span class="inline-wrap"><code>USER</code></span><span class="inline-wrap"> </span><span class="inline-wrap"><i></i></span><span class="inline-wrap"><i><code>name</code></i></span></td><td><span class="inline-wrap">指定执行管理器的域用户帐户。对于*</span><span class="inline-wrap"><code>name</code></span><span class="inline-wrap">*，包括域名、向后斜杠和用户名，例如</span><span class="inline-wrap"><code>HEADQT\GGSMGR</code></span><span class="inline-wrap">。默认情况下，安装管理器服务以使用本地系统帐户。</span></td></tr><tr><td><span class="inline-wrap"><code>PASSWORD</code></span><span class="inline-wrap"> </span><span class="inline-wrap"><i></i></span><span class="inline-wrap"><i><code>password</code></i></span></td><td><span class="inline-wrap">为使用</span><span class="inline-wrap"><code>USER</code></span><span class="inline-wrap">指定的用户指定密码。</span></td></tr></tbody></table></div><h2 id="jz7QCdK3SKsTSg1PNxaBBy" class="wolai-block"><span class="inline-wrap">配置进程参数</span></h2><div id="xh8db87dqSG4D5JRQFb9G1" class="wolai-block wolai-text"><div><span class="inline-wrap">==注：配置时需要在原先的文件夹下==</span></div></div><ol class="wolai-block"><li id="fgPAR3w7UUgH3mjRRRNXYZ"><div class="marker"></div><span class="inline-wrap">配置<span class="jill"></span>MGR<span class="jill"></span>管理进程</span><code-block id="cFTL3kcgi32gbosZmenAPD" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">4</span><span class="token operator">></span> edit params mgr
<span class="token comment"># 添加以下内容</span>
<span class="token comment"># PORT 7809：OGG 管理进程监控端口。</span>
<span class="token comment"># PURGEOLDEXTRACTS：清除不需要的 trail 文件。</span>
<span class="token comment"># /ogg/dirdat：trail 文件存放位置。</span>
<span class="token comment"># USECHECKPOINTS：使用检查点队列。</span>
port <span class="token number">7809</span>
purgeoldextracts C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\dirdat<span class="token punctuation">,</span> usecheckpoints</pre></div></code-block></li><li id="wJLDcDFyDKQLr9CMeKE38y"><div class="marker"></div><span class="inline-wrap">启动<span class="jill"></span>mgr</span><code-block id="hcndVrDZH7sDHB9Vkzd2AA" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">5</span><span class="token operator">></span> <span class="token keyword">start</span> mgr
Manager started<span class="token punctuation">.</span></pre></div></code-block></li><li id="inXLSV69rTdWFtDXMHTbCJ"><div class="marker"></div><span class="inline-wrap">查看状态(如果不是下方的特定的消息可通过<span class="jill"></span>view report mgr<span class="jill"></span>查看错误)</span><span class="inline-wrap">
</span><span class="inline-wrap">ggsci<span class="jill"></span>方式：</span><code-block id="d2tA6VKkkUH8K6hiWA9WH9" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">6</span><span class="token operator">></span> info mgr
Manager <span class="token operator">is</span> running <span class="token punctuation">(</span>IP port ogg1<span class="token punctuation">.</span><span class="token number">7809</span><span class="token punctuation">)</span><span class="token punctuation">.</span></pre></div></code-block><div id="tmB2rvrGbvoaoLNxZEyaiP" class="wolai-block wolai-text"><div><span class="inline-wrap">ps<span class="jill"></span>方式：</span></div></div><code-block id="raFLF28PSjuMMicggQNkBg" class="wolai-block"><div class="wolai-pre"><div data-lang="Powershell" class="marker"></div><pre><span class="token function">PS</span> C:\Users\Administrator> <span class="token function">get-service</span> <span class="token operator">-</span>name ogg-mgr

Status   Name               DisplayName
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>   <span class="token operator">--</span><span class="token operator">--</span>               <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
Running  ogg-mgr            ogg-mgr</pre></div></code-block></li></ol><h1 id="tKM3FbXkZYLAMMLUuJfJjM" class="wolai-block"><span class="inline-wrap">三、双端：配置与初始化进程</span></h1><ol class="wolai-block"><li id="xvD58MPRE9pw7ahhAbjkdr"><div class="marker"></div><span class="inline-wrap">源端添加<span class="jill"></span>EINI_1（extract<span class="jill"></span>进程）</span><code-block id="m54SPnaFGbWBfSXn89w7PH" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>WIN<span class="token operator">-</span>QHLFMQGHCTV<span class="token punctuation">)</span> <span class="token number">1</span><span class="token operator">></span> <span class="token keyword">add</span> extract eini_1<span class="token punctuation">,</span> sourceistable
<span class="token comment"># 参考命令： add extract eini_1 tranlog,begin now.</span>
EXTRACT added<span class="token punctuation">.</span></pre></div></code-block></li><li id="6U3bSmjhLEWeUckujBfSQ5"><div class="marker"></div><span class="inline-wrap">目标端添加<span class="jill"></span>RINI_1（REPLICAT<span class="jill"></span>进程）</span><code-block id="6XXzpEj5vKs2qt6QteVYSX" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg2<span class="token punctuation">)</span> <span class="token number">1</span><span class="token operator">></span> <span class="token keyword">ADD</span> REPLICAT RINI_1<span class="token punctuation">,</span> SPECIALRUN
REPLICAT added<span class="token punctuation">.</span>
<span class="token comment"># 将生成./dirchk/RINI_1.cpr文件</span></pre></div></code-block></li><li id="5ZWTPsRRh7LqAztub1EYcQ"><div class="marker"></div><span class="inline-wrap">查看<span class="jill"></span>EINI_1<span class="jill"></span>的进程状态</span><span class="inline-wrap">
</span><span class="inline-wrap">还没有配置和启动时，该进程是<span class="jill"></span>STOPPED<span class="jill"></span>状态</span><code-block id="rsaBfrTbF9qJkiHVsREkuS" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">9</span><span class="token operator">></span> INFO EXTRACT EINI_1

EXTRACT    EINI_1    Initialized   <span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">12</span> <span class="token number">09</span>:<span class="token number">05</span>   <span class="token keyword">Status</span> STOPPED
<span class="token keyword">Checkpoint</span> Lag       <span class="token operator">Not</span> Available
Log <span class="token keyword">Read</span> <span class="token keyword">Checkpoint</span>  <span class="token operator">Not</span> Available
                     <span class="token keyword">First</span> Record         Record <span class="token number">0</span>
Task                 SOURCEISTABLE</pre></div></code-block></li><li id="w7D9Mhn3qQmMHLFRfV3wdD"><div class="marker"></div><span class="inline-wrap">源端：配置名为</span><span class="inline-wrap"><b>EINI_1</b></span><span class="inline-wrap">的<span class="jill"></span>extract<span class="jill"></span>进程</span><span class="inline-wrap">
</span><span class="inline-wrap">==注：TABLE<span class="jill"></span>可以指定*号作为通配符,或具体表==</span><code-block id="tg5WaBxnBkKXkLwFEPckhB" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">10</span><span class="token operator">></span> edit params eini_1

extract <span class="token constant">EINI_1</span>
<span class="token function">setenv</span> <span class="token punctuation">(</span><span class="token constant">NLS_LANG</span><span class="token operator">=</span><span class="token constant">SIMPLIFIED</span> <span class="token constant">CHINESE_CHINA</span><span class="token punctuation">.</span><span class="token constant">ZHS16GBK</span><span class="token punctuation">)</span>
userid ogg<span class="token punctuation">,</span> <span class="token constant">PASSWORD</span> ogg
rmthost <span class="token number">192.168</span><span class="token number">.245</span><span class="token number">.44</span><span class="token punctuation">,</span> mgrport <span class="token number">7809</span>
rmttask replicat<span class="token punctuation">,</span> group <span class="token constant">RINI_1</span>
<span class="token constant">TABLE</span> tengfei<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">;</span></pre></div></code-block></li><li id="1N9c8s6zSfj29DB4dggvqz"><div class="marker"></div><span class="inline-wrap">目标端：配置名为</span><span class="inline-wrap"><b>RINI_1</b></span><span class="inline-wrap">的<span class="jill"></span>REPLICAT<span class="jill"></span>进程</span><span class="inline-wrap">
</span><span class="inline-wrap">==注：map<span class="jill"></span>与<span class="jill"></span>target<span class="jill"></span>可以指定*号作为通配符,或具体表==</span><code-block id="qPqNkXunfL75HDyVY86rmg" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ora2<span class="token punctuation">)</span> <span class="token number">6</span><span class="token operator">></span> edit params rini_1

<span class="token constant">REPLICAT</span> <span class="token constant">RINI_1</span>
<span class="token function">setenv</span> <span class="token punctuation">(</span><span class="token constant">NLS_LANG</span><span class="token operator">=</span><span class="token constant">SIMPLIFIED</span> <span class="token constant">CHINESE_CHINA</span><span class="token punctuation">.</span><span class="token constant">ZHS16GBK</span><span class="token punctuation">)</span>
assumetargetdefs
userid ogg<span class="token punctuation">,</span>password ogg
discardfile <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\<span class="token maybe-class-name">RINIaa</span><span class="token punctuation">.</span><span class="token property-access">dsc</span><span class="token punctuation">,</span> purge
map tengfei<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> target tengfei<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">;</span></pre></div></code-block></li></ol><div id="fEtGUNLeJxpibRuXbS4Luz" class="wolai-block wolai-text"><div><span class="inline-wrap">==注：初始化数据工作只会做一次，目标端<span class="jill"></span>Rini_1<span class="jill"></span>不用手动启动==</span></div></div><ol class="wolai-block"><li id="vnN3jrAwMCFmm4NJP4AkCy"><div class="marker"></div><span class="inline-wrap">源端启动</span><code-block id="sideuWG75WgqFYZ4Z6AbbV" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> start extract eini_1
<span class="token maybe-class-name">Sending</span> <span class="token constant">START</span> request to <span class="token constant">MANAGER</span> <span class="token spread operator">...</span>
<span class="token constant">EXTRACT</span> <span class="token constant">EINI_1</span> starting</pre></div></code-block></li><li id="nDPFN8NjEQaWNkZbChQCGg"><div class="marker"></div><span class="inline-wrap">查看进程</span><code-block id="mPzvWp6M17MwPbHNZi6fim" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span><span class="token constant">WIN</span><span class="token operator">-</span><span class="token constant">QHLFMQGHCTV</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> view report eini_1</pre></div></code-block></li><li id="wHS1LovfCrBEUQA6GWxM6d"><div class="marker"></div><span class="inline-wrap">执行完后<span class="jill"></span>ggerr.log：</span><code-block id="ems76FPZW2AqMfuw8FW8Ng" class="wolai-block"><div class="wolai-pre"><div data-lang="Powershell" class="marker"></div><pre><span class="token comment"># 输出尾部40行</span>
<span class="token function">PS</span> C:\ogg> <span class="token function">Get-Content</span> <span class="token punctuation">.</span>\ggserr<span class="token punctuation">.</span>log <span class="token operator">-</span>Tail 40
<span class="token comment"># 持续加载</span>
<span class="token function">PS</span> C:\ogg> <span class="token function">Get-Content</span> <span class="token punctuation">.</span>\ggserr<span class="token punctuation">.</span>log <span class="token operator">-</span>wait</pre></div></code-block></li></ol><blockquote id="gMNqVVJ6wWC78WxLWqWoMT" class="wolai-block"><span class="inline-wrap">INFO    OGG-00991  Oracle GoldenGate Capture for Oracle, eini_1.prm:  EXTRACT EINI_1 stopped normally.</span></blockquote><h1 id="3ZLDFtGGFFdWCvQpY1yQzs" class="wolai-block"><span class="inline-wrap">四、配置检查点</span></h1><div id="sz89QwQisygwqmx3zPUFCy" class="wolai-block wolai-text"><div><span class="inline-wrap">为了让 OGG 网络中断、服务器宕机、掉电等在突发情况也能正确断点续传，ORACLE 建议配置 OGG 的检查点队列。</span><span class="inline-wrap"><a href="http://www.dba-oracle.com/t_goldengate_checkpoint_table.htm"><span>参考文档</span></a></span></div></div><ol class="wolai-block"><li id="1R1hhcm1Hm25zd3R9EUjkw"><div class="marker"></div><span class="inline-wrap">源端和目标端配置并添加信息</span><code-block id="g2aQ5VXhGcsiiWgfZfLF6R" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>stream<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> <span class="token constant">EDIT</span> <span class="token constant">PARAMS</span> <span class="token punctuation">.</span><span class="token operator">/</span><span class="token constant">GLOBALS</span>
<span class="token constant">CHECKPOINTTABLE</span> ogg<span class="token punctuation">.</span><span class="token property-access">ggschkpt</span></pre></div></code-block></li><li id="huezpasY2HmhEygSaeXGhR"><div class="marker"></div><span class="inline-wrap">使用<span class="jill"></span>ogg<span class="jill"></span>用户登录数据库</span><code-block id="ngaUL69BDzH4z5Um8dkZZh" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre>dblogin userid ogg<span class="token punctuation">,</span>password ogg </pre></div></code-block></li><li id="3ce5gn4faFWrv8fih8ptcf"><div class="marker"></div><span class="inline-wrap">创建检查点</span><code-block id="7ea3sXaPHi9EsxqEM6smrK" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre>add checkpointtable ogg<span class="token punctuation">.</span><span class="token property-access">ggschkpt</span></pre></div></code-block></li><li id="521Xppuf2FdbSCJj3kCZoC"><div class="marker"></div><span class="inline-wrap">从<span class="jill"></span>SQLPLUS<span class="jill"></span>使用<span class="jill"></span>ogg<span class="jill"></span>用户登录并查看检查点表</span><code-block id="1bi3tZFZZDAfw74tyj2dG8" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre><span class="token keyword">SQL</span><span class="token operator">></span> conn ogg<span class="token operator">/</span>ogg
<span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tab<span class="token punctuation">;</span>

TNAME			                     TABTYPE	CLUSTERID
<span class="token comment">------------------------------ ------- ----------</span>
GGSCHKPT		                   <span class="token keyword">TABLE</span>
GGSCHKPT_LOX		               <span class="token keyword">TABLE</span>
GGS_DDL_COLUMNS 	             <span class="token keyword">TABLE</span>
GGS_DDL_HIST		               <span class="token keyword">TABLE</span>
GGS_DDL_HIST_ALT	             <span class="token keyword">TABLE</span>
GGS_DDL_LOG_GROUPS	           <span class="token keyword">TABLE</span>
GGS_DDL_OBJECTS 	             <span class="token keyword">TABLE</span>
GGS_DDL_PARTITIONS	           <span class="token keyword">TABLE</span>
GGS_DDL_PRIMARY_KEYS	         <span class="token keyword">TABLE</span>
GGS_DDL_RULES		               <span class="token keyword">TABLE</span>
GGS_DDL_RULES_LOG	             <span class="token keyword">TABLE</span>

TNAME			                     TABTYPE	CLUSTERID
<span class="token comment">------------------------------ ------- ----------</span>
GGS_MARKER		                 <span class="token keyword">TABLE</span>
GGS_SETUP		                   <span class="token keyword">TABLE</span>
GGS_STICK		                   <span class="token keyword">TABLE</span>
GGS_TEMP_COLS		               <span class="token keyword">TABLE</span>
GGS_TEMP_UK		                 <span class="token keyword">TABLE</span>

<span class="token number">16</span> <span class="token keyword">rows</span> selected<span class="token punctuation">.</span></pre></div></code-block></li></ol><h1 id="qTAjUZXmLKrS6NvMBkZvDt" class="wolai-block"><span class="inline-wrap">五、源端：配置捕获、PUMP<span class="jill"></span>进程</span></h1><h2 id="hRyRuXNWdhtBTYCMTtA1Xk" class="wolai-block"><span class="inline-wrap">1. 配置捕获进程</span></h2><ol class="wolai-block"><li id="rskv3LvSQ8NGYp9iW2frZP"><div class="marker"></div><span class="inline-wrap">源端配置<span class="jill"></span>EORA_1<span class="jill"></span>进程：</span><code-block id="7V4nFgTKhKk8LSD5FjA9aw" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">1</span><span class="token operator">></span> edit params eora_1

EXTRACT EORA_1
<span class="token comment">-- 需要确定语言select userenv('language') from dual;</span>
SETENV <span class="token punctuation">(</span>NLS_LANG<span class="token operator">=</span>SIMPLIFIED CHINESE_CHINA<span class="token punctuation">.</span>ZHS16GBK<span class="token punctuation">)</span>
USERID ogg<span class="token punctuation">,</span> PASSWORD ogg
EXTTRAIL C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\aa
<span class="token comment">-- 多个表用*号</span>
<span class="token keyword">TABLE</span> tengfei<span class="token punctuation">.</span>idt<span class="token punctuation">;</span></pre></div></code-block><div id="92ErVPFN25Kfd7W4dAHbf8" class="wolai-block wolai-text"><div><span class="inline-wrap">EXTTRAIL 为端的<span class="jill"></span>dirdat<span class="jill"></span>路径</span></div></div></li><li id="3iYEq4dzXnrSoizhw9tKn6"><div class="marker"></div><span class="inline-wrap">开始捕获</span><span class="inline-wrap">
</span><span class="inline-wrap">TRAIL 文件可以理解为存放捕获进程捕获的日志文件</span><code-block id="hLfxz1MXCcWT6BjUwFupSU" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> <span class="token keyword">add</span> extract eora_1<span class="token punctuation">,</span> tranlog<span class="token punctuation">,</span> <span class="token keyword">begin</span> now
EXTRACT added<span class="token punctuation">.</span>
GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> <span class="token keyword">add</span> exttrail C:\app\Administrator\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\aa<span class="token punctuation">,</span> extract eora_1<span class="token punctuation">,</span> megabytes <span class="token number">5</span>
EXTTRAIL added<span class="token punctuation">.</span></pre></div></code-block><div id="eiqsXwnayueHkzaQpH3emo" class="wolai-block wolai-text"><div><span class="inline-wrap">EXTTRAIL 参数是 TRAIL 队列文件存放的路径和命名格式</span></div></div></li><li id="t7kfSoEqXsd6BvAzpfs3ao"><div class="marker"></div><span class="inline-wrap">启动进程</span><code-block id="9Wi5tCKiwPdiDuZ8hyaxK7" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">4</span><span class="token operator">></span> <span class="token keyword">start</span> extract eora_1

Sending <span class="token keyword">START</span> request <span class="token keyword">to</span> MANAGER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
EXTRACT EORA_1 <span class="token keyword">starting</span></pre></div></code-block><div id="kwiDfc4nr83CeqEQGPvZ72" class="wolai-block wolai-text"><div><span class="inline-wrap">查看进程：</span><span class="inline-wrap"><code>info extract eora_1</code></span></div></div></li></ol><h2 id="2zGXadwSMjyUbd5wgBVarZ" class="wolai-block"><span class="inline-wrap">2. PUMP<span class="jill"></span>传输进程</span></h2><ol class="wolai-block"><li id="odzVRcAB6devjuvdCCxX1f"><div class="marker"></div><span class="inline-wrap">源端配置</span><span class="inline-wrap">
</span><span class="inline-wrap">此步骤也是非必须的，如果不配置传输进程，OGG 会通过 EXTRACT 进程传输 TRAIL 队列文件，但是和检查点队列一样，为了保证断点续传 ORACLE 建议配置 PUMP 传输进程。</span><code-block id="p6XWZdtmuQxBy5CH3M63sd" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> <span class="token constant">EDIT</span> <span class="token constant">PARAMS</span> <span class="token constant">PORA_1</span>
<span class="token constant">EXTRACT</span> <span class="token constant">PORA_1</span>
<span class="token constant">SETENV</span> <span class="token punctuation">(</span><span class="token constant">NLS_LANG</span><span class="token operator">=</span><span class="token constant">SIMPLIFIED</span> <span class="token constant">CHINESE_CHINA</span><span class="token punctuation">.</span><span class="token constant">ZHS16GBK</span><span class="token punctuation">)</span>
<span class="token constant">PASSTHRU</span>
<span class="token constant">RMTHOST</span> <span class="token number">192.168</span><span class="token number">.245</span><span class="token number">.44</span><span class="token punctuation">,</span> <span class="token constant">MGRPORT</span> <span class="token number">7809</span>
<span class="token constant">RMTTRAIL</span> <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\pa
<span class="token constant">TABLE</span> tengfei<span class="token punctuation">.</span><span class="token property-access">idt</span><span class="token punctuation">;</span></pre></div></code-block></li><li id="uF1bvauidaC7snLo1YLvvX"><div class="marker"></div><span class="inline-wrap">添加<span class="jill"></span>pump<span class="jill"></span>进程到<span class="jill"></span>OGG，并制定本地的<span class="jill"></span>TRAIL<span class="jill"></span>文件</span><code-block id="pfJtP3bmvWjSgN4RaEr5GQ" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre> <span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> <span class="token constant">ADD</span> <span class="token constant">EXTRACT</span> <span class="token constant">PORA_1</span><span class="token punctuation">,</span> <span class="token constant">EXTTRAILSOURCE</span> <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\aa</pre></div></code-block></li><li id="hVRfQRcTTbn5zpQ4xDABos"><div class="marker"></div><span class="inline-wrap">查看状态</span><code-block id="8uxQitP2fdKD6VStdJ7cwT" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">4</span><span class="token operator">></span> <span class="token constant">INFO</span> <span class="token constant">EXTRACT</span> <span class="token constant">PORA_1</span>

<span class="token constant">EXTRACT</span>    <span class="token constant">PORA_1</span>    <span class="token maybe-class-name">Initialized</span>   <span class="token number">2021</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">05</span> <span class="token number">14</span><span class="token operator">:</span><span class="token number">38</span>   <span class="token maybe-class-name">Status</span> <span class="token constant">STOPPED</span>
<span class="token maybe-class-name">Checkpoint</span> <span class="token maybe-class-name">Lag</span>       <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> <span class="token punctuation">(</span>updated <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">35</span> ago<span class="token punctuation">)</span>
<span class="token maybe-class-name">Log</span> <span class="token maybe-class-name">Read</span> <span class="token maybe-class-name">Checkpoint</span>  <span class="token maybe-class-name">File</span> <span class="token comment">//u01/app/ogg/dirdat/aa000000</span>
                     <span class="token maybe-class-name">First</span> <span class="token maybe-class-name">Record</span>  <span class="token constant">RBA</span> <span class="token number">0</span></pre></div></code-block></li><li id="iMaFQjkC4cyjY8z9P4oziL"><div class="marker"></div><span class="inline-wrap">为 PUMP 进程 PORA_1 指定将本地 TRAIL 文件传输到目标端后保存成目标端 TRAIL 文件的名字</span><code-block id="9HEtt8CDULgYCxD3DdL2pW" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">5</span><span class="token operator">></span> <span class="token constant">ADD</span> <span class="token constant">RMTTRAIL</span> <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\pa<span class="token punctuation">,</span> <span class="token constant">EXTRACT</span> <span class="token constant">PORA_1</span><span class="token punctuation">,</span> <span class="token constant">MEGABYTES</span> <span class="token number">5</span>
<span class="token constant">RMTTRAIL</span> added<span class="token punctuation">.</span></pre></div></code-block></li><li id="veU1g6unZMT544pV1CS2QQ"><div class="marker"></div><span class="inline-wrap">启动进程</span><code-block id="pvdmB9cTTfSSShG2VVB6Wx" class="wolai-block"><div class="wolai-pre"><div data-lang="Sql" class="marker"></div><pre>GGSCI <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">6</span><span class="token operator">></span> <span class="token keyword">start</span> extract pora_1
Sending <span class="token keyword">START</span> request <span class="token keyword">to</span> MANAGER <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
EXTRACT PORA_1 <span class="token keyword">starting</span></pre></div></code-block></li><li id="bXH6wdW5b3edbybi5v52Eu"><div class="marker"></div><span class="inline-wrap">查看状态</span><span class="inline-wrap">
</span><span class="inline-wrap">注：正常情况将在目标端<span class="jill"></span>dirdata<span class="jill"></span>文件夹下生成<span class="jill"></span>pa000000<span class="jill"></span>文件</span><code-block id="jRndWsHxWiGrLkjSsYzwby" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg1<span class="token punctuation">)</span> <span class="token number">5</span><span class="token operator">></span> info extract pora_1

<span class="token constant">EXTRACT</span>    <span class="token constant">PORA_1</span>    <span class="token maybe-class-name">Last</span> <span class="token maybe-class-name">Started</span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">05</span> <span class="token number">14</span><span class="token operator">:</span><span class="token number">54</span>   <span class="token maybe-class-name">Status</span> <span class="token constant">RUNNING</span>
<span class="token maybe-class-name">Checkpoint</span> <span class="token maybe-class-name">Lag</span>       <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> <span class="token punctuation">(</span>updated <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">07</span> ago<span class="token punctuation">)</span>
<span class="token maybe-class-name">Log</span> <span class="token maybe-class-name">Read</span> <span class="token maybe-class-name">Checkpoint</span>  <span class="token maybe-class-name">File</span> <span class="token operator">/</span>u01<span class="token operator">/</span>app<span class="token operator">/</span>ogg<span class="token operator">/</span>dirdat<span class="token operator">/</span>aa000000
                     <span class="token maybe-class-name">First</span> <span class="token maybe-class-name">Record</span>  <span class="token constant">RBA</span> <span class="token number">1043</span></pre></div></code-block><div id="5fTz4s1PQAjh7vdfxyJmx4" class="wolai-block wolai-text"><div><span class="inline-wrap">注：当状态为<span class="jill"></span>abended<span class="jill"></span>时，可通过查看<span class="jill"></span>ggserr.log<span class="jill"></span>检查报错</span></div></div></li></ol><h1 id="iDH3sQcDDDJrENsKtLWJQt" class="wolai-block"><span class="inline-wrap">六、目标端配置同步进程</span></h1><ol class="wolai-block"><li id="tSkZwbQkmiTdxpGjBRbSxW"><div class="marker"></div><span class="inline-wrap">添加进程</span><code-block id="3JeUSw2VrWjzAXh7w1QG6y" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg2<span class="token punctuation">)</span> <span class="token number">1</span><span class="token operator">></span>  <span class="token constant">ADD</span> <span class="token constant">REPLICAT</span> <span class="token constant">RORA_1</span><span class="token punctuation">,</span> exttrail <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\pa<span class="token punctuation">,</span> checkpointtable ogg<span class="token punctuation">.</span><span class="token property-access">ggschkpt</span></pre></div></code-block></li><li id="iGw1G9L89VvdSyNxZEoXg2"><div class="marker"></div><span class="inline-wrap">编辑进程</span><code-block id="jXZ4ne8p8HTL2GL4KaLPx2" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg2<span class="token punctuation">)</span> <span class="token number">2</span><span class="token operator">></span> edit params rora_1
<span class="token constant">REPLICAT</span> <span class="token constant">RORA_1</span>
<span class="token constant">SETENV</span> <span class="token punctuation">(</span><span class="token constant">NLS_LANG</span><span class="token operator">=</span><span class="token constant">SIMPLIFIED</span> <span class="token constant">CHINESE_CHINA</span><span class="token punctuation">.</span><span class="token constant">ZHS16GBK</span><span class="token punctuation">)</span>
<span class="token constant">USERID</span> ogg<span class="token punctuation">,</span> <span class="token constant">PASSWORD</span> ogg
<span class="token constant">HANDLECOLLISIONS</span>
<span class="token constant">ASSUMETARGETDEFS</span>
<span class="token constant">DISCARDFILE</span> <span class="token constant">C</span><span class="token operator">:</span>\app\<span class="token maybe-class-name">Administrator</span>\product\<span class="token number">12.1</span><span class="token number">.2</span>\oggcore_1\<span class="token maybe-class-name">RORA_aa</span><span class="token punctuation">.</span><span class="token constant">DSC</span><span class="token punctuation">,</span> <span class="token constant">PURGE</span>
<span class="token constant">MAP</span> tengfei<span class="token punctuation">.</span><span class="token property-access">idt</span><span class="token punctuation">,</span> <span class="token constant">TARGET</span> tengfei<span class="token punctuation">.</span><span class="token property-access">idt</span><span class="token punctuation">;</span></pre></div></code-block></li><li id="hy39KgN7uxuLhDJi5vDGgE"><div class="marker"></div><span class="inline-wrap">启动进程</span><code-block id="4ACftqV8VCzM7owuQ9bgkd" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg2<span class="token punctuation">)</span> <span class="token number">3</span><span class="token operator">></span> start replicat rora_1
<span class="token maybe-class-name">Sending</span> <span class="token constant">START</span> request to <span class="token constant">MANAGER</span> <span class="token spread operator">...</span>
<span class="token constant">REPLICAT</span> <span class="token constant">RORA_1</span> starting</pre></div></code-block></li><li id="qkFZ38KqMzp73pvCEQsCGc"><div class="marker"></div><span class="inline-wrap">查看进程</span><code-block id="t8W1SJY9MbVwCL8qPnViTS" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre><span class="token constant">GGSCI</span> <span class="token punctuation">(</span>ogg2<span class="token punctuation">)</span> <span class="token number">4</span><span class="token operator">></span> info replicat rora_1

<span class="token constant">REPLICAT</span>   <span class="token constant">RORA_1</span>    <span class="token maybe-class-name">Initialized</span>   <span class="token number">2021</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span><span class="token number">05</span> <span class="token number">14</span><span class="token operator">:</span><span class="token number">58</span>   <span class="token maybe-class-name">Status</span> <span class="token constant">STOPPED</span>
<span class="token maybe-class-name">Checkpoint</span> <span class="token maybe-class-name">Lag</span>       <span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span><span class="token operator">:</span><span class="token number">00</span> <span class="token punctuation">(</span>updated <span class="token number">00</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">56</span> ago<span class="token punctuation">)</span>
<span class="token maybe-class-name">Log</span> <span class="token maybe-class-name">Read</span> <span class="token maybe-class-name">Checkpoint</span>  <span class="token maybe-class-name">Not</span> <span class="token maybe-class-name">Available</span>
<span class="token maybe-class-name">Task</span>                 <span class="token constant">SPECIALRUN</span></pre></div></code-block></li></ol><div id="g23WuvBcyL8W6GZHQm1uud" class="wolai-block wolai-text"><div><span class="inline-wrap">到此配置完成，可检查数据同步情况！</span></div></div></article><footer></footer></body></html>