<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>6.2.6源码编译 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font less-lead"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="6.2.6源码编译" class="main-title"></div></div></header><article><div id="hqVHCw7aw4QeTqqJhBSdeU" class="wolai-bookmark wolai-block"><a href="https://www.zabbix.com/cn/download_sources">Download Zabbix sources</a><div class="info-box"><div class="text-pane"><div data-title="Download Zabbix sources"></div><div data-desc="Download sources from Git repository or ready-to-use Zabbix distributives"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://assets.zabbix.com/img/apple-touch-icon-180x180-precomposed.png&quot;)"></div><div data-hostname="www.zabbix.com"></div></div></div><div class="preview-pane"></div></div></div><div id="omY4UFDwyLPBrjhAVHxKqh" class="wolai-bookmark wolai-block"><a href="https://www.zabbix.com/cn/download">下载Zabbix</a><div class="info-box"><div class="text-pane"><div data-title="下载Zabbix"></div><div data-desc="Zabbix is being downloaded over 4 000 000 times every year for a reason. Download Zabbix for free and try it yourself!"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://assets.zabbix.com/img/apple-touch-icon-180x180-precomposed.png&quot;)"></div><div data-hostname="www.zabbix.com"></div></div></div><div class="preview-pane"></div></div></div><div id="n8JGfGxZVnhNVEeXLFdsZh" class="wolai-bookmark wolai-block"><a href="https://www.zabbix.com/documentation/6.2/en/manual/installation/install">3 Installation from sources</a><div class="info-box"><div class="text-pane"><div data-title="3 Installation from sources"></div><div class="icon-host"><div class="icon icon-image" style="background-image: url(&quot;https://www.zabbix.com/documentation/6.2/images/apple-touch-icon.png&quot;)"></div><div data-hostname="www.zabbix.com"></div></div></div><div class="preview-pane"></div></div></div><h1 id="qt5vZA327b7ETbpoV78SJK" class="wolai-block"><span class="inline-wrap">go<span class="jill"></span>安装</span></h1><h1 id="cAMqb7461Pxmu2BV4RcT2p" class="wolai-block"><span class="inline-wrap">PHP<span class="jill"></span>安装</span></h1><div id="2egf7CjTBUPUj3eqj9Loba" class="wolai-block wolai-text"><div><span class="inline-wrap">配置文件：php.ini</span></div></div><code-block id="1PvH1ewvoMUKPG6nxQv8DX" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token punctuation">[</span><span class="token constant">PHP</span><span class="token punctuation">]</span>
expose_php <span class="token operator">=</span> <span class="token maybe-class-name">Of</span>
short_open_tag <span class="token operator">=</span> <span class="token maybe-class-name">On</span>
cgi<span class="token punctuation">.</span><span class="token property-access">fix_pathinfo</span><span class="token operator">=</span><span class="token number">1</span>
max_execution_time <span class="token operator">=</span> <span class="token number">300</span>
max_input_time <span class="token operator">=</span> <span class="token number">300</span>
memory_limit <span class="token operator">=</span> 256M
post_max_size <span class="token operator">=</span> 100M
upload_max_filesize <span class="token operator">=</span> 10M
upload_max_filesize
<span class="token punctuation">[</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">]</span>
date<span class="token punctuation">.</span><span class="token property-access">timezone</span> <span class="token operator">=</span> <span class="token maybe-class-name">Asia</span><span class="token operator">/</span><span class="token maybe-class-name">Shanghai</span></pre></div></code-block><div id="kmML7rDGWdXnX8NE1ZYtd3" class="wolai-block wolai-text"><div><span class="inline-wrap">配置文件：php-fpm.ini</span></div></div><code-block id="x1pJWQ75FgJDUjuebaJuWf" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">listen<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">9000</span>
include<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>services<span class="token operator">/</span>php<span class="token operator">-</span><span class="token number">7.4</span><span class="token number">.13</span><span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span><span class="token property-access">d</span><span class="token comment">/*.conf</span></pre></div></code-block><h1 id="1PfLEL3ifTEMVotBGsjkXK" class="wolai-block"><span class="inline-wrap">MySQL 配置(版本至少<span class="jill"></span>8.00.0)</span></h1><div id="evUezAuqrK3JjPnKTM6UJm" class="wolai-block wolai-text"><div><span class="inline-wrap">创建数据库用户</span></div></div><code-block id="pk1AV22E9YyS2JjHuvDwpS" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment"># mysql -uroot -p</span>
mysql<span class="token operator">></span> create database zabbix character <span class="token builtin class-name">set</span> utf8mb4 collate utf8mb4_bin<span class="token punctuation">;</span>
mysql<span class="token operator">></span> create user <span class="token string">'zabbix'</span>@<span class="token string">'localhost'</span> identified by <span class="token string">'A7i53KT8QfkyjGdw1q'</span><span class="token punctuation">;</span>
mysql<span class="token operator">></span> grant all privileges on zabbix.* to <span class="token string">'zabbix'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
mysql<span class="token operator">></span> <span class="token builtin class-name">set</span> global log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
mysql<span class="token operator">></span> flush privileges<span class="token punctuation">;</span>
mysql<span class="token operator">></span> quit<span class="token punctuation">;</span></pre></div></code-block><div id="aRVzf4KYgbLmidB4A1dJW1" class="wolai-block wolai-text"><div><span class="inline-wrap">导入初始<span class="jill"></span>schema<span class="jill"></span>和数据</span></div></div><code-block id="6E3XRTWVU4oVQJuS9q7oLV" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment"># 来自源码文件夹中的目录</span>
<span class="token builtin class-name">echo</span> <span class="token string">"/root/zabbix-6.2.6/database/mysql/schema.sql
/root/zabbix-6.2.6/database/mysql/images.sql
/root/zabbix-6.2.6/database/mysql/data.sql"</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> line
<span class="token keyword">do</span> 
/usr/local/services/mysql-8.0.31/bin/mysql --default-character-set<span class="token operator">=</span>utf8mb4 <span class="token parameter variable">-uzabbix</span> <span class="token parameter variable">-p</span> zabbix <span class="token operator">&lt;</span> <span class="token variable">$line</span>
<span class="token keyword">done</span></pre></div></code-block><div id="7wXXDc59vhymKNgnmFkka6" class="wolai-block wolai-text"><div><span class="inline-wrap">导入<span class="jill"></span>schema<span class="jill"></span>后全局禁用<span class="jill"></span>log_bin_trust_function_creators</span></div></div><code-block id="x8Nb4pHYPPo2nKGSgBsuLa" class="wolai-block"><div class="wolai-pre"><div data-lang="SQL" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment"># mysql -uroot -p</span>
mysql<span class="token operator">></span> <span class="token keyword">set</span> <span class="token keyword">global</span> log_bin_trust_function_creators <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
mysql<span class="token operator">></span> quit<span class="token punctuation">;</span></pre></div></code-block><div id="1b7E21fx9F8EVL3Jh2Nhhy" class="wolai-block wolai-text"><div><span class="inline-wrap">添加防火墙配置</span></div></div><code-block id="bJR9yyMxRz3u6EYNUaFtr1" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>add<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">10051</span><span class="token operator">/</span>tcp <span class="token operator">--</span>permanent
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload</pre></div></code-block><h1 id="fFY5o79omJDUZzuWMajr8Y" class="wolai-block"><span class="inline-wrap">zabbix 安装</span></h1><div id="wrM7iX2Atjq7RnjE9utU5K" class="wolai-block wolai-text"><div><span class="inline-wrap">下载源码</span></div></div><code-block id="rb73rVMbkSMwNUTPta2QyA" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">wget</span> https://cdn.zabbix.com/zabbix/sources/stable/6.2/zabbix-6.2.6.tar.gz</pre></div></code-block><div id="ogo3G17d7WXdSfNxSpnYw1" class="wolai-block wolai-text"><div><span class="inline-wrap">安装依赖</span></div></div><code-block id="ntNbQnfktRyhStCx1JiQnp" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> gcc mysql-devel net-snmp-devel libxml2-devel  unixODBC-devel libcurl-devel libssh2-devel  openssl-devel openldap-devel libevent-devel pcre-devel OpenIPMI-devel</pre></div></code-block><div id="mqEDKrvfuXQQj6oqofoeTH" class="wolai-block wolai-text"><div><span class="inline-wrap">对于<span class="jill"></span>Enable web service<span class="jill"></span>需要<span class="jill"></span>go<span class="jill"></span>环境</span></div></div><code-block id="uCu4FepVU5UexGaKvxwuie" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/services/zabbix-6.2.6 --enable-server --with-net-snmp --enable-agent --with-mysql --enable-ipv6 --with-libcurl --with-libxml2 --enable-webservice</pre></div></code-block><div id="hEsCFkRwKsJNDKJMATiLxg" class="wolai-block wolai-text"><div><span class="inline-wrap">开始编译安装</span></div></div><code-block id="gLoK5enox7rk2wmrSUydh4" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">make</span> <span class="token function">install</span> </pre></div></code-block><div id="tfUHLL1qQM1fEvqjJmpLW9" class="wolai-block wolai-text"><div><span class="inline-wrap">创建<span class="jill"></span>zabbix<span class="jill"></span>用户</span></div></div><code-block id="1LYRL3t1xZeKASLPaXwGBp" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">groupadd</span> <span class="token parameter variable">--system</span> zabbix
<span class="token function">useradd</span> <span class="token parameter variable">--system</span> <span class="token parameter variable">-g</span> zabbix <span class="token parameter variable">-d</span> /usr/lib/zabbix <span class="token parameter variable">-s</span> /sbin/nologin <span class="token parameter variable">-c</span> <span class="token string">"Zabbix Monitoring System"</span> zabbix</pre></div></code-block><div id="8vHQtZkM7M2upzurdzD7ri" class="wolai-block wolai-text"><div><span class="inline-wrap">修改文件夹权限</span></div></div><code-block id="vsUUFKUwhKAbifEPwdiwRd" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"> chown <span class="token operator">-</span><span class="token constant">R</span> zabbix<span class="token punctuation">.</span><span class="token property-access">zabbix</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>services<span class="token operator">/</span>zabbix<span class="token operator">-</span><span class="token number">6.2</span><span class="token number">.6</span><span class="token operator">/</span></pre></div></code-block><h1 id="jz7WX5WdR8m9Aw4kDhhwR6" class="wolai-block"><span class="inline-wrap">zabbix 配置</span></h1><h2 id="k6GgUVbs4Mj6mGrLE3fPFD" class="wolai-block"><span class="inline-wrap">zabbix_server</span></h2><div id="iTURxvhBTdS5FVRodquL5e" class="wolai-block wolai-text"><div><span class="inline-wrap">基本配置</span></div></div><code-block id="c8FYQJ87u5JqGaRhagzcgW" class="wolai-block"><div class="wolai-pre"><div data-lang="Ini" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token key attr-name">LogFile</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/logs/zabbix_server.log</span>
<span class="token key attr-name">DBHost</span><span class="token punctuation">=</span><span class="token value attr-value">localhost</span>
<span class="token key attr-name">DBName</span><span class="token punctuation">=</span><span class="token value attr-value">zabbix</span>
<span class="token key attr-name">DBUser</span><span class="token punctuation">=</span><span class="token value attr-value">zabbix</span>
<span class="token key attr-name">DBPassword</span><span class="token punctuation">=</span><span class="token value attr-value">233</span>
<span class="token key attr-name">DBSocket</span><span class="token punctuation">=</span><span class="token value attr-value">/tmp/mysql.sock</span>
<span class="token key attr-name">Timeout</span><span class="token punctuation">=</span><span class="token value attr-value">4</span>
<span class="token key attr-name">AlertScriptsPath</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/shell</span>
<span class="token key attr-name">ExternalScripts</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/shell</span>
<span class="token key attr-name">LogSlowQueries</span><span class="token punctuation">=</span><span class="token value attr-value">3000</span>
<span class="token key attr-name">StatsAllowedIP</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">WebServiceURL</span><span class="token punctuation">=</span><span class="token value attr-value">http://127.0.0.1:10053/report</span></pre></div></code-block><div id="nicbWwEf2rgPzUCMdkF8Lf" class="wolai-block wolai-text"><div><span class="inline-wrap">获取所有配置</span></div></div><code-block id="pvTA5HQtJSxhetsU4jBxoJ" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">grep</span> <span class="token string">"^[[:alnum:]]"</span> /usr/local/services/zabbix-6.2.6/etc/zabbix_server.conf</pre></div></code-block><div id="xn2nupnjkVCsURFGrPPnwR" class="wolai-block wolai-text"><div><span class="inline-wrap">参考启动命令</span></div></div><code-block id="6oWECmTSCM9PxpqyL6CS97" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">/usr/local/services/zabbix-6.2.6/sbin/zabbix_server <span class="token parameter variable">-c</span> /usr/local/services/zabbix-6.2.6/etc/zabbix_server.conf</pre></div></code-block><div id="s96ef1WHnVgaZt4uAcLsMH" class="wolai-block wolai-text"><div><span class="inline-wrap">systemd<span class="jill"></span>配置文件：/usr/lib/systemd/system/zabbix_server.service</span></div></div><code-block id="wZ4jqZGnWiozPHBGTpLUUS" class="wolai-block"><div class="wolai-pre"><div data-lang="Ini" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">Zabbix Server</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">syslog.target</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network.target</span>

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">forking</span>
<span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">on-failure</span>
<span class="token key attr-name">PIDFile</span><span class="token punctuation">=</span><span class="token value attr-value">/tmp/zabbix_server.pid</span>
<span class="token key attr-name">KillMode</span><span class="token punctuation">=</span><span class="token value attr-value">control-group</span>
<span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/sbin/zabbix_server -c /usr/local/services/zabbix-6.2.6/etc/zabbix_server.conf</span>
<span class="token key attr-name">ExecStop</span><span class="token punctuation">=</span><span class="token value attr-value">/bin/kill -SIGTERM $MAINPID</span>
<span class="token key attr-name">RestartSec</span><span class="token punctuation">=</span><span class="token value attr-value">10s</span>

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span></pre></div></code-block><div id="1BZpSpdq12axysamhZaSY9" class="wolai-block wolai-text"><div><span class="inline-wrap">开机自启</span></div></div><code-block id="qv2oDWPpEyiWxbqLgKMxWo" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">systemctl start zabbix_server
systemctl enable zabbix_server</pre></div></code-block><h2 id="mBeqF33QKgyLLV3Ko714VR" class="wolai-block"><span class="inline-wrap">zabbix_web_service</span></h2><div id="6regJPTvFrdbUjF3pT6hW3" class="wolai-block wolai-text"><div><span class="inline-wrap">参考启动</span></div></div><code-block id="jnQau9cGRWpHsZue8WMDiC" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>services<span class="token operator">/</span>zabbix<span class="token operator">-</span><span class="token number">6.2</span><span class="token number">.6</span><span class="token operator">/</span>sbin<span class="token operator">/</span>zabbix_web_service <span class="token operator">-</span>c <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>services<span class="token operator">/</span>zabbix<span class="token operator">-</span><span class="token number">6.2</span><span class="token number">.6</span><span class="token operator">/</span>etc<span class="token operator">/</span>zabbix_web_service<span class="token punctuation">.</span><span class="token property-access">conf</span></pre></div></code-block><div id="mJ6XmWEMDSS4YU1M3CznNR" class="wolai-block wolai-text"><div><span class="inline-wrap">systemd<span class="jill"></span>配置文件：/usr/lib/systemd/system/zabbix_web_service.service</span></div></div><code-block id="iwzRWiMrSgwQ9iVCXdDeM2" class="wolai-block"><div class="wolai-pre"><div data-lang="Ini" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">Zabbix Web Service</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">syslog.target</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network.target</span>
 
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">simple</span>
<span class="token key attr-name">PIDFile</span><span class="token punctuation">=</span><span class="token value attr-value">/tmp/zabbix_web_service.pid</span>
<span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">on-failure</span>
<span class="token key attr-name">KillMode</span><span class="token punctuation">=</span><span class="token value attr-value">control-group</span>
<span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/sbin/zabbix_web_service -c /usr/local/services/zabbix-6.2.6/etc/zabbix_web_service.conf</span>
<span class="token key attr-name">ExecStop</span><span class="token punctuation">=</span><span class="token value attr-value">/bin/kill -SIGTERM $MAINPID</span>
<span class="token key attr-name">RestartSec</span><span class="token punctuation">=</span><span class="token value attr-value">10s</span>
 
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span></pre></div></code-block><div id="vL7mdB5rFwbVzeH4uJvAYo" class="wolai-block wolai-text"><div><span class="inline-wrap">开机自启</span></div></div><code-block id="edAANSanjqvVzSg9QB88Gx" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">sysmtemctl start zabbix<span class="token operator">-</span>web<span class="token operator">-</span>service
sysmtemctl enable zabbix<span class="token operator">-</span>web<span class="token operator">-</span>service</pre></div></code-block><h2 id="gK7j2FfjSU6ZdL1yGaL6Mu" class="wolai-block"><span class="inline-wrap">zabbix_agentd</span></h2><h3 id="qjJ65evEoYiApAEU7W4MSi" class="wolai-block"><span class="inline-wrap">二进制安装（Centos7）</span></h3><div id="bYHwBwsk1uaSnkARXnv9kw" class="wolai-block wolai-text"><div><span class="inline-wrap">添加用户和组</span></div></div><code-block id="taNaVJQHGGLFGXLhjJmVM2" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">sudo</span> <span class="token function">groupadd</span> <span class="token parameter variable">--system</span> zabbix <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">useradd</span> <span class="token parameter variable">--system</span> <span class="token parameter variable">-g</span> zabbix <span class="token parameter variable">-d</span> /usr/lib/zabbix <span class="token parameter variable">-s</span> /sbin/nologin <span class="token parameter variable">-c</span> <span class="token string">"Zabbix Monitoring System"</span> zabbix</pre></div></code-block><div id="d63xo5CNA75nzzas92KhuJ" class="wolai-block wolai-text"><div><span class="inline-wrap">修改文件夹权限</span></div></div><code-block id="sX47Mz16VHVLiXJcUyznKr" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">chown</span> <span class="token parameter variable">-R</span> zabbix.zabbix /usr/local/services/zabbix-6.2.6/</pre></div></code-block><div id="7Xw2DDBZ2CqCDrv2s9tteT" class="wolai-block wolai-text"><div><span class="inline-wrap">配置文件：/usr/local/services/zabbix-6.2.6/etc/zabbix_agentd.conf</span></div></div><code-block id="uUqxEo39x55ENpoFTAnD8Y" class="wolai-block"><div class="wolai-pre"><div data-lang="Ini" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token key attr-name">PidFile</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/zabbix_agentd.pid</span>
<span class="token key attr-name">LogFile</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/logs/zabbix_agentd.log</span>
<span class="token key attr-name">DebugLevel</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
<span class="token key attr-name">Server</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.0.25</span>
<span class="token comment">#ServerActive=192.168.0.25</span>
<span class="token key attr-name">Hostname</span><span class="token punctuation">=</span><span class="token value attr-value">node21</span>
<span class="token key attr-name">AllowRoot</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
<span class="token key attr-name">User</span><span class="token punctuation">=</span><span class="token value attr-value">zabbix</span>
<span class="token key attr-name">Include</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/etc/zabbix_agentd.conf.d</span>
<span class="token key attr-name">Include</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/etc/zabbix_agentd.conf.d/*.conf</span></pre></div></code-block><div id="koaoz6964MqKQteXX2xbRv" class="wolai-block wolai-text"><div><span class="inline-wrap">systemd<span class="jill"></span>配置文件：/usr/lib/systemd/system/zabbix_agentd.service</span></div></div><code-block id="hzaneUxk969TySTXunubLm" class="wolai-block"><div class="wolai-pre"><div data-lang="Ini" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Unit</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Description</span><span class="token punctuation">=</span><span class="token value attr-value">Zabbix Agentd</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">syslog.target</span>
<span class="token key attr-name">After</span><span class="token punctuation">=</span><span class="token value attr-value">network.target</span>
 
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Service</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Type</span><span class="token punctuation">=</span><span class="token value attr-value">forking</span>
<span class="token key attr-name">PIDFile</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/zabbix_agentd.pid</span>
<span class="token key attr-name">Restart</span><span class="token punctuation">=</span><span class="token value attr-value">on-failure</span>
<span class="token key attr-name">KillMode</span><span class="token punctuation">=</span><span class="token value attr-value">control-group</span>
<span class="token key attr-name">ExecStart</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/services/zabbix-6.2.6/sbin/zabbix_agentd -c /usr/local/services/zabbix-6.2.6/etc/zabbix_agentd.conf</span>
<span class="token key attr-name">ExecStop</span><span class="token punctuation">=</span><span class="token value attr-value">/bin/kill -SIGTERM $MAINPID</span>
<span class="token key attr-name">RestartSec</span><span class="token punctuation">=</span><span class="token value attr-value">10s</span>
 
<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">Install</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">WantedBy</span><span class="token punctuation">=</span><span class="token value attr-value">multi-user.target</span></pre></div></code-block><div id="bdEodpsTmFrrsDtxhcp7A6" class="wolai-block wolai-text"><div><span class="inline-wrap">开机自启</span></div></div><code-block id="okhhrcHdonv1439X8xGkCQ" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">systemctl start zabbix_agentd
systemctl enable zabbix_agentd</pre></div></code-block><div id="cxbVuNYgUwuVdDJkjjQKZD" class="wolai-block wolai-text"><div><span class="inline-wrap">添加防火墙端口</span></div></div><code-block id="agWyGH4cqUqKbFv9QSE5r2" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>add<span class="token operator">-</span>port<span class="token operator">=</span><span class="token number">10050</span><span class="token operator">/</span>tcp <span class="token operator">--</span>permanent
firewall<span class="token operator">-</span>cmd <span class="token operator">--</span>reload</pre></div></code-block><h3 id="dtbvJ2dZUfXepYoqSPZP9o" class="wolai-block"><span class="inline-wrap">yum 安装（Centos6）</span></h3><code-block id="2gavpkJ8SkcfNVQ5PyuhgH" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">rpm <span class="token operator">-</span><span class="token maybe-class-name">Uvh</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>repo<span class="token punctuation">.</span><span class="token property-access">zabbix</span><span class="token punctuation">.</span><span class="token property-access">com</span><span class="token operator">/</span>zabbix<span class="token operator">/</span><span class="token number">6.2</span><span class="token operator">/</span>rhel<span class="token operator">/</span><span class="token number">6</span><span class="token operator">/</span>x86_64<span class="token operator">/</span>zabbix<span class="token operator">-</span>release<span class="token operator">-</span><span class="token number">6.2</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token property-access">el6</span><span class="token punctuation">.</span><span class="token property-access">noarch</span><span class="token punctuation">.</span><span class="token property-access">rpm</span>
yum clean all
yum install zabbix<span class="token operator">-</span>agent
</pre></div></code-block><div id="7bqJ58xaBv55BZ7r29CzzB" class="wolai-block wolai-text"><div><span class="inline-wrap">配置文件路径</span></div></div><code-block id="xgSdrEzZzk5dwJAbTQueg6" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span><span class="token property-access">d</span><span class="token operator">/</span>zabbix<span class="token operator">-</span>agent
<span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span><span class="token property-access">d</span><span class="token operator">/</span>zabbix_agentd</pre></div></code-block><div id="6kZp8kBsNStdbLu1gEE796" class="wolai-block wolai-text"><div><span class="inline-wrap">启动</span></div></div><code-block id="1uF4ZUNnDBkej2ytG8Rvuk" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">service zabbix<span class="token operator">-</span>agent restart</pre></div></code-block><div id="waYpb9pJCAWyrrH633JhtF" class="wolai-block wolai-text"><div><span class="inline-wrap">开机自启</span></div></div><code-block id="3xztmSTnKvBPerEZn2uqny" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">chkconfig <span class="token operator">--</span>level <span class="token number">35</span> zabbix<span class="token operator">-</span>agent on</pre></div></code-block></article><footer></footer></body></html>