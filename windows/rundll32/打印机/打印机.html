<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>打印机 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font less-lead"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="打印机" class="main-title"></div></div></header><article><h1 id="5zHJ9wCj4aCVRZwzjztuMz" class="wolai-block"><span class="inline-wrap">打印机 - printui.dll</span></h1><h2 id="s8cHJVawqH1FPt3TLk6mED" class="wolai-block"><span class="inline-wrap">用法</span></h2><div id="nLKU8QSx3pC5oKwBpwSKMP" class="wolai-block wolai-text"><div><span class="inline-wrap">rundll32 printui.dll,PrintUIEntry [options] [@commandfile]</span></div></div><h2 id="eiX2ESsukivMvYkxZAaNpd" class="wolai-block"><span class="inline-wrap">重点</span></h2><div id="cjJxnrQT3xTDXmByHQeQUq" class="wolai-block wolai-text"><div><span class="inline-wrap">添加打印机：</span></div></div><code-block id="3xcAhEeqBv8FUBjjbzdRN6" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre>rundll32 printui<span class="token punctuation">.</span><span class="token property-access">dll</span><span class="token punctuation">,</span><span class="token maybe-class-name">PrintUIEntry</span> <span class="token operator">/</span><span class="token keyword">in</span> <span class="token operator">/</span>n <span class="token string">"\\192.168.0.219\HP LaserJet Professional M1136 MFP"</span></pre></div></code-block><div id="4sMkqKNYUUCs9PK2xnMqbc" class="wolai-block wolai-text"><div><span class="inline-wrap">删除打印机</span></div></div><code-block id="sawMVZUza9pXFYkP7Hrym4" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre>rundll32 printui<span class="token punctuation">.</span><span class="token property-access">dll</span><span class="token punctuation">,</span><span class="token maybe-class-name">PrintUIEntry</span> <span class="token operator">/</span>dn <span class="token operator">/</span>n <span class="token string">"\\192.168.0.219\HP LaserJet Professional M1136 MFP"</span></pre></div></code-block><div id="x8RNRWiYdnmwBa99CnCrfw" class="wolai-block wolai-text"><div><span class="inline-wrap">查看打印机<span class="jill"></span>1</span></div></div><code-block id="8jCxj8arvFEUJy8FsR3P5c" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre>rundll32 printui<span class="token punctuation">.</span><span class="token property-access">dll</span><span class="token punctuation">,</span><span class="token maybe-class-name">PrintUIEntry</span> <span class="token operator">/</span>ge \\<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.219</span>查看打印机<span class="token number">2</span>：net view \\<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.219</span></pre></div></code-block><h2 id="dWpYSCzQKFhWR93rF3tPEL" class="wolai-block"><span class="inline-wrap">参数</span></h2><div id="jwXGR8HtcLHno4csWzrSET" class="wolai-block wolai-text"><div><span class="inline-wrap">/a[file] 二进制文件名
/b[name] 基本打印机名
/c[name] 如果操作在远程机器上，unc 机器名
/dl 删除本地打印机
/dn 删除网络打印机连接
/dd 删除打印机驱动程序
/e 显示打印首选项
/f[file] inf 文件或输出文件
/F[file] 使用 /f 指定的 INF 文件可能依赖的 INF 文件的位置
/ga 添加每个机器打印机连接(用户登录时此连接将传播到用户)
/ge 枚举每个机器打印机连接
/gd 删除每个机器打印机连接(用户登录时此连接将被删除)
/h[arch] 驱动程序体系结构，为下列之一: x86 或 x64 或 Itanium
/ia 用 INF 文件安装打印机驱动程序
/id 用添加打印机驱动程序向导安装打印机驱动程序
/if 用 INF 文件安装打印机
/ii 用带 INF 文件的添加打印机向导安装打印机
/il 用添加打印机向导安装打印机
/im 使用添加打印机向导安装打印机(跳过网络列出的打印机)
/in 添加网络打印机连接
/ip 使用网络打印机安装向导安装打印机
/j[provider] 打印提供程序名称
/k 安装打印机时将测试页打印到指定打印机，不能与命令组合使用
/l[path] 打印机驱动程序源路径
/m[model] 打印机驱动程序型号名称
/n[name] 打印机名称
/o 显示打印机队列视图
/p 显示打印机属性
/q 安静模式，不显示错误消息
/r[port] 端口名称
/s 显示服务器属性
/Ss 将打印机设置存储到文件
/Sr 从文件还原打印机设置
存储或还原必须放在命令末尾的打印机设置选项标志:
2	PRINTER_INFO_2
7	PRINTER_INFO_7
c	颜色配置文件
d	PrinterData
s	安全描述符
g	全局 DevMode
m	最低设置
u	用户 DevMode
r	解决名称冲突
f	强制使用名称
p	解析端口
i	驱动程序名称冲突
/u 使用现有打印机驱动程序(如果已安装)
/t[#] 起始的从零开始的索引页
/v[version] 驱动程序版本，为下列之一:“类型 2 - 内核模式”或“类型 3 - 用户模式”
/w 如果在 inf 中找不到指定的驱动程序，则提示用户找一个驱动程序
/y 将打印机设置为默认打印机
/Xg 获取打印机设置
/Xs 设置打印机设置
/z 不自动共享此打印机
/Y 不自动生成打印机名称
/K 更改 /h 的含义，使其接受 2、3、4 (分别代表 x86、x64 或 Itanium)，并更改 /v 的含义，使其接受 3 (代表“类型 3 - 用户模式”)
/Z 共享此打印机，只能与 /if 选项一起使用
/? 提供此消息的帮助
@[file] 命令行参数文件
/Mw[message] 提交命令之前显示警告消息
/Mq[message] 提交命令之前显示确认消息
/W[flags] 指定向导(用于 APW 和 APDW)的标志和开关
r	使向导可以从上一页重新启动
/G[flags] 指定全局标志和开关
w	禁止显示安装驱动程序警告 UI (超安静模式)
/R 强制使用所选驱动程序替换现有驱动程序</span></div></div><h2 id="aEgogU3ecUw2B19FCmVCs7" class="wolai-block"><span class="inline-wrap">例如:</span></h2><div id="dQW4coGjN5QRAg5dQMs5mv" class="wolai-block wolai-text"><div><span class="inline-wrap">运行服务器属性:
rundll32 printui.dll,PrintUIEntry /s /t1 /c\machine
运行打印机属性:
rundll32 printui.dll,PrintUIEntry /p /n\machine\printer
本地运行添加打印机向导:
rundll32 printui.dll,PrintUIEntry /il
在 \machine:
rundll32 printui.dll,PrintUIEntry /im /c\machine 上运行添加打印机向导
运行队列查看:
rundll32 printui.dll,PrintUIEntry /o /n\machine\printer
运行 INF 安装:
rundll32 printui.dll,PrintUIEntry /if /b &quot;Test Printer&quot; /f c:\infpath\infFile.inf /r &quot;lpt1:&quot; /m &quot;Brother DCP-128C&quot;
运行 INF 安装(具有 INF 依赖关系)。在此示例中，prnbr002.inf 依赖于 ntprint.inf
rundll32 printui.dll, PrintUIEntry /ia /m &quot;Brother DCP-128C&quot; /K /h x64 /v 3 /f &quot;c:\infpath\prnbr002.inf&quot; /F &quot;c:\infpath\ntprint.inf&quot;
使用 INF 运行添加打印机向导:
rundll32 printui.dll,PrintUIEntry /ii /f c:\infpath\infFile.inf
使用内置打印机驱动程序添加打印机:
rundll32 printui.dll,PrintUIEntry /if /b &quot;Test Printer&quot; /r &quot;lpt1:&quot; /m &quot;Brother DCP-128C&quot;
添加每个机器打印机连接(用户登录时此连接将传播到用户):
rundll32 printui.dll,PrintUIEntry /ga /c\machine /n\machine\printer /j&quot;LanMan Print Services&quot;
删除每个机器打印机连接(用户登录时此连接将被删除):
rundll32 printui.dll,PrintUIEntry /gd /c\machine /n\machine\printer
枚举每个机器打印机连接:
rundll32 printui.dll,PrintUIEntry /ge /c\machine
使用 INF 添加打印机驱动程序:
rundll32 printui.dll,PrintUIEntry /ia /c\machine /m &quot;Brother DCP-128C&quot; /h &quot;x86&quot; /v &quot;Type 3 - User Mode&quot; /f c:\infpath\infFile.inf
使用 INF 添加打印机驱动程序:
rundll32 printui.dll,PrintUIEntry /ia /K /c\machine /m &quot;Brother DCP-128C&quot; /h &quot;x86&quot; /v 3
添加内置打印机驱动程序:
rundll32 printui.dll,PrintUIEntry /ia /c\machine /m &quot;Brother DCP-128C&quot; /h &quot;Intel&quot; /v &quot;Type 3 - Kernel Mode&quot;
删除打印机驱动程序:
rundll32 printui.dll,PrintUIEntry /dd /c\machine /m &quot;Brother DCP-128C&quot; /h &quot;x86&quot; /v &quot;Type 3 - User Mode&quot;
删除打印机驱动程序:
rundll32 printui.dll,PrintUIEntry /dd /K /c\machine /m &quot;Brother DCP-128C&quot; /h &quot;x86&quot; /v 3
将打印机设置为默认打印机:
rundll32 printui.dll,PrintUIEntry /y /n &quot;printer&quot;
设置打印机注解:
rundll32 printui.dll,PrintUIEntry /Xs /n  &quot;printer&quot; comment &quot;My Cool Printer&quot;
取得打印机设置:
rundll32 printui.dll,PrintUIEntry /Xg /n &quot;printer&quot;
取得文件中的打印机设置保存结果:
rundll32 printui.dll,PrintUIEntry /f &quot;results.txt&quot; /Xg /n &quot;printer&quot;
设置打印机设置命令使用:
rundll32 printui.dll,PrintUIEntry /Xs /n &quot;printer&quot; ?
将所有打印机设置存入一个文件:
rundll32 printui.dll,PrintUIEntry /Xs /n &quot;printer&quot; ?
从一个文件还原所有打印机设置:
rundll32 printui.dll,PrintUIEntry /Sr /n &quot;printer&quot; /a &quot;file.dat&quot;
将二级打印机信息存入一个文件:
rundll32 printui.dll,PrintUIEntry /Ss /n &quot;printer&quot; /a &quot;file.dat&quot; 2
从一个文件还原打印机安全描述符:
rundll32 printui.dll,PrintUIEntry /Sr /n &quot;printer&quot; /a &quot;file.dat&quot; s
从一个文件还原打印机全局 devmode 和打印机数据:
rundll32 printui.dll,PrintUIEntry /Sr /n &quot;printer&quot; /a &quot;file.dat&quot; g d
从文件最少设置还原并分析端口名:
rundll32 printui.dll,PrintUIEntry /Sr /n &quot;printer&quot; /a &quot;file.dat&quot; m p
启用打印机的客户端呈现:
rundll32 printui.dll,PrintUIEntry /Xs /n&quot;printer&quot; ClientSideRender enabled
禁用打印机的客户端呈现:
rundll32 printui.dll,PrintUIEntry /Xs /n&quot;printer&quot; ClientSideRender disabled</span></div></div></article><footer></footer></body></html>