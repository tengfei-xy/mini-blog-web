<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>语法 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font less-lead"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="语法" class="main-title"></div></div></header><article><h1 id="gjESFBJvr96NtMtgMGDzpF" class="wolai-block"><span class="inline-wrap">基本概念</span><details id="kVSUxHf82JCXDD6VVt6LTu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">保留字</span></summary><div id="kK6WF2TqDq3PPeEh8oNk9S" class="wolai-block wolai-text"><div><span class="inline-wrap">具有特殊用途的字词，比如<span class="jill"></span>MOV（代表一条指令），不能单作变量和其他用途，不区分大小写，</span></div></div></details><details id="3doByk34L7PrGFKFaciMFv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">标志符</span></summary><div id="n2SaTf24thnDT3pACg6Gb2" class="wolai-block wolai-text"><div><span class="inline-wrap">程序员定义的名词，用来表示变量，常量、过程等</span></div></div></details><details id="wWDwFCJqBxp8tAwYKZxhno" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">命令</span></summary><div id="2rkvK8C6PbhLfJ3VV641hC" class="wolai-block wolai-text"><div><span class="inline-wrap">命令是与指令集无关的一些操作，可以指挥汇编器去做某件事，例如定义变量、指明内存段等</span></div></div></details><details id="boaLiHYfnyg1aJyBJpjpBU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">段</span></summary><div id="jQt9sNFtgeXDup9eco1VHn" class="wolai-block wolai-text"><div><span class="inline-wrap">是用相关命令所标出的特殊段落。汇编器预先定义了几种这样的段落。NASM<span class="jill"></span>中，</span><span class="inline-wrap"><code>SELECTION .bss</code></span><span class="inline-wrap">表示未初始化的变量，</span><span class="inline-wrap"><code>SECTION .data</code></span><span class="inline-wrap">表示已初始化的变量，</span><span class="inline-wrap"><code>SECTION .text</code></span><span class="inline-wrap">可执行的代码/指令</span></div></div></details><details id="7YsqC64vS7YscN4uwTe5tG" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">指令</span></summary><div id="3zYY2xBwdZ7Ji7ar8QoHZh" class="wolai-block wolai-text"><div><span class="inline-wrap">是程序中的可执行语句</span></div></div></details><details id="7UwHGL5PrhMu7zZQFNawQc" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">字面值</span></summary><details id="cMenhfVFPfvLLaQfuf6m1E" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">整数字面值</span></summary><div id="piNJmch6oiuLH8eVZTz8As" class="wolai-block wolai-simple-table"><table><tbody><tr><td style="width: 100px"><span class="inline-wrap">基数</span></td><td style="width: 100px"><span class="inline-wrap">进制</span></td><td style="width: 100px"><span class="inline-wrap">示例</span></td><td style="width: 394px"><span class="inline-wrap">注意</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">b</span></td><td style="width: 100px"><span class="inline-wrap">二进制</span></td><td style="width: 100px"><span class="inline-wrap">00011111b</span></td><td style="width: 394px"><span class="inline-wrap"></span><br/></td></tr><tr><td style="width: 100px"><span class="inline-wrap">d</span></td><td style="width: 100px"><span class="inline-wrap">十进制</span></td><td style="width: 100px"><span class="inline-wrap">31,31d</span></td><td style="width: 394px"><span class="inline-wrap"></span><br/></td></tr><tr><td style="width: 100px"><span class="inline-wrap">h</span></td><td style="width: 100px"><span class="inline-wrap">十六进制</span></td><td style="width: 100px"><span class="inline-wrap">1Fh</span></td><td style="width: 394px"><span class="inline-wrap">建议<span class="jill"></span>0<span class="jill"></span>开头，不如从<span class="jill"></span>A-F<span class="jill"></span>开头，可能会被单作标志符</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">q,o</span></td><td style="width: 100px"><span class="inline-wrap">八进制</span></td><td style="width: 100px"><span class="inline-wrap">37o</span></td><td style="width: 394px"><span class="inline-wrap"></span><br/></td></tr></tbody></table></div></details><details id="xAe9BtVFdqEs8BxfxAXQ54" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">字符字面值</span></summary><div id="a5tnTAyDrkmCrGnhZAJuE7" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>&quot;a&quot;</code></span><span class="inline-wrap"> 或</span><span class="inline-wrap"><code>&#39;A&#39;</code></span><span class="inline-wrap">都是有效的</span></div></div></details><details id="8wJnameLdpjfXM82Fz1KU1" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">字符串字面值</span></summary><div id="mAQ2dTLeH1BCzVaRXkrfr1" class="wolai-block wolai-text"><div><span class="inline-wrap">说明：以<span class="jill"></span>BYTE（字符）数组的方式存储，需要<span class="jill"></span>null<span class="jill"></span>结尾,</span><span class="inline-wrap">NASM<span class="jill"></span>中需要以<span class="jill"></span>0<span class="jill"></span>来设置最后一个字节</span></div></div><div id="Ttzkx93PYifyEVB6RNKA3" class="wolai-block wolai-text"><div><span class="inline-wrap">格式：</span></div></div><code-block id="2TEfP42xuT4WPemZsUes4z" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token literal-property property">motd</span><span class="token operator">:</span> <span class="token constant">DB</span> <span class="token string">"This string \"contains\" dobule quotes!"</span><span class="token punctuation">,</span><span class="token number">0</span></pre></div></code-block></details></details><details id="5CfXhapZTiMcLSu5prWctF" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">符号</span></summary><details id="nHmvrih8Ts4pLC3H9aUTjv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">[]</span></summary><div id="qQtMrpfskinMBXVFb4Pu46" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：</span><span class="inline-wrap"><code>[...]</code></span><span class="inline-wrap"> 表示要操作的是内存地址，而不是直接操作寄存器。</span></div></div><code-block id="fXZNtsWoy6Y1fQRmwLeJWE" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">mov word <span class="token punctuation">[</span>bp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span>
<span class="token punctuation">;</span><span class="token punctuation">[</span>bp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> 表示以基址指针（<span class="token constant">BP</span>）为基址，偏移量为<span class="token number">4</span>的位置，将值<span class="token number">20</span>存储到该内存位置。</pre></div></code-block></details><details id="tug2m8qkkT4EN6D8DQ8Gdf" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">$</span></summary><div id="kfwPGFgZcj1BECGgScWkbD" class="wolai-block wolai-text"><div><span class="inline-wrap">$<span class="jill"></span>表示表示当前行被编译后的地址。</span></div></div><div id="m4mDxTrftFW7gWGEBBvoau" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>JMP $</code></span><span class="inline-wrap">表示死循环，十六进制机器码是<span class="jill"></span>E9FDFF。E9<span class="jill"></span>表示跳转，EDFF<span class="jill"></span>确定跳转地址。x86<span class="jill"></span>是小端模式保存，所以地址偏移地址是<span class="jill"></span>0xfffd，即-3。这条指令长度为<span class="jill"></span>3<span class="jill"></span>个字节,所以会跳转到<span class="jill"></span>JMP<span class="jill"></span>前。执行后，再跳转。</span></div></div></details><details id="iMh6mFYHdWRJAX1s1GuYSh" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">$$</span></summary><div id="77w32wDcV733s1XZHnf9M7" class="wolai-block wolai-text"><div><span class="inline-wrap">$$<span class="jill"></span>表示<span class="jill"></span>Section（节）初始处被编译后的地址。Section<span class="jill"></span>既可以是数据段，也可以是代码段，而不是函数。</span></div></div><div id="4UgquXEmP5gRsDHEQLDW6m" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>$-$$</code></span><span class="inline-wrap">表示本行程序距离<span class="jill"></span>Section<span class="jill"></span>起始处的偏移。</span></div></div></details></details></h1><h1 id="kdu9f5CtSvFBNUVXDfkpxG" class="wolai-block"><span class="inline-wrap">定义数据</span><div id="rS6qtAfwcw2bHjB2B4RymS" class="wolai-block wolai-text"><div><span class="inline-wrap">根据数据长度来确定数据，高级语言根据数据内容来确定数据类型。</span></div></div><details id="7cc1jPQ18nVF9SsM1oY1dV" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">长度类型</span></summary><div id="x17pcXCNKpskEwgEu6UCAK" class="wolai-block wolai-simple-table"><table><tbody><tr><td style="width: 100px"><span class="inline-wrap">初始化命令</span></td><td style="width: 115px"><span class="inline-wrap">未初始化方式</span></td><td style="width: 100px"><span class="inline-wrap">长度</span></td><td style="width: 100px"><span class="inline-wrap">备注</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">DB</span></td><td style="width: 115px"><span class="inline-wrap">RESB</span></td><td style="width: 100px"><span class="inline-wrap">1<span class="jill"></span>个字节</span></td><td style="width: 100px"><span class="inline-wrap">byte</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">DW</span></td><td style="width: 115px"><span class="inline-wrap">RESW</span></td><td style="width: 100px"><span class="inline-wrap">2<span class="jill"></span>个字节</span></td><td style="width: 100px"><span class="inline-wrap">word</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">DD</span></td><td style="width: 115px"><span class="inline-wrap">RESD</span></td><td style="width: 100px"><span class="inline-wrap">4<span class="jill"></span>个字节</span></td><td style="width: 100px"><span class="inline-wrap">dword</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">DQ</span></td><td style="width: 115px"><span class="inline-wrap">RESQ</span></td><td style="width: 100px"><span class="inline-wrap">8<span class="jill"></span>个字节</span></td><td style="width: 100px"><span class="inline-wrap">qword</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">DT</span></td><td style="width: 115px"><span class="inline-wrap">REST</span></td><td style="width: 100px"><span class="inline-wrap">10<span class="jill"></span>个字节</span></td><td style="width: 100px"><span class="inline-wrap">tword</span></td></tr></tbody></table></div></details><details id="5KTJdapukLDtjKUuzJwzgz" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">定义格式</span></summary><details id="sJTGi1vdYg6AeCQYsSWpAL" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">一般格式</span></summary><code-block id="m84hbn2KNw9aPf1HNZo7ax" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">标志符: 命令 初始化器 <span class="token punctuation">[</span>,初始化器<span class="token punctuation">]</span><span class="token punctuation">..</span>.</pre></div></code-block></details><details id="9TXykp4TQb2HWLro4bnVHP" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">初始化定义方式</span></summary><code-block id="xtmZhRXorgwUajSHZkUScW" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">wageArray: DD <span class="token number">75,100</span>,125</pre></div></code-block></details><details id="6xHuonFLeQhAPaSBpc46di" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">对于未初始化的变量</span></summary><div id="pcohYf6XZnAtW6Pms4UzzR" class="wolai-block wolai-text"><div><span class="inline-wrap">NASM<span class="jill"></span>需要放入.bss<span class="jill"></span>段中,示例如下</span></div></div><code-block id="mBThVnPpnCmWaSvuNXempz" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">SECTION</span> <span class="token punctuation">.</span><span class="token property-access">bss</span>
<span class="token literal-property property">memAddr</span><span class="token operator">:</span> <span class="token constant">RESD</span> <span class="token number">1</span>  <span class="token punctuation">;</span><span class="token maybe-class-name">Reserves</span> <span class="token number">1</span> <span class="token constant">DWORD</span> <span class="token punctuation">(</span><span class="token number">4</span> bytes<span class="token punctuation">)</span>
<span class="token literal-property property">buffer</span><span class="token operator">:</span>  <span class="token constant">RESB</span> <span class="token number">64</span> <span class="token punctuation">;</span><span class="token maybe-class-name">Reserver</span> <span class="token number">64</span> bytes</pre></div></code-block></details></details><details id="gJCnpec2CSD7tuBH7TB6Wv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">常量/符号常量</span></summary><div id="te3QoFZ2AvSMD7ScgMCAeu" class="wolai-block wolai-text"><div><span class="inline-wrap">说明： 用以表示程序执行期间绝对不会变化的值</span></div></div><details id="hfYx2dSgN8y64nYW1eimKD" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><code-block id="uccArDGkX993pk545Z9R6Y" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token literal-property property">identifier</span><span class="token operator">:</span> <span class="token constant">EQU</span> expression <span class="token punctuation">;</span> numeric operations
<span class="token literal-property property">identifier</span><span class="token operator">:</span> <span class="token constant">EQU</span> <span class="token number">0</span>          <span class="token punctuation">;</span> a single <span class="token function">value</span><span class="token punctuation">(</span>constant<span class="token punctuation">)</span>
<span class="token literal-property property">identifier</span><span class="token operator">:</span> <span class="token constant">EQU</span> <span class="token string">"text"</span>     <span class="token punctuation">;</span> text can be four characters <span class="token function">max</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">-</span>bit<span class="token punctuation">)</span></pre></div></code-block></details></details><details id="jqTytmDLwgKyw4QFDsiUYV" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">赋值</span></summary><div id="5s33cgt72pfvkYTQManXsC" class="wolai-block wolai-text"><div><span class="inline-wrap">定义常量</span></div></div><code-block id="fPN1gUDDmTzB66tmXhQ7f9" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token maybe-class-name">BaseOfStack</span>  equ  <span class="token number">0x7c00</span> <span class="token punctuation">;</span>定义常量</pre></div></code-block><div id="j99Th1BQveiwsyDXmsKH98" class="wolai-block wolai-text"><div><span class="inline-wrap">赋值方向从右到左</span></div></div><code-block id="xnmTgQ7Ldd78qfY9UzKtx5" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">ADD</span> 目的操作数，源操作数</pre></div></code-block></details></h1><h1 id="5ETB142FvyGV1geodWdvhv" class="wolai-block"><span class="inline-wrap">寄存器</span><details id="dMoxgii88oGWWMM4DyabUY" class="def-color wolai-block"><summary><div class="marker"></div><span class="inline-wrap">通用目的寄存器(Genernal Purpose Register)</span></summary><div id="ttswFzxPeVFitngFMHAzsG" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 85px"><span class="inline-wrap">64<span class="jill"></span>位</span></th><th style="width: 61px"><span class="inline-wrap">32<span class="jill"></span>位</span></th><th style="width: 66px"><span class="inline-wrap">16<span class="jill"></span>位</span></th><th style="width: 71px"><span class="inline-wrap">高<span class="jill"></span>8<span class="jill"></span>位</span></th><th style="width: 67px"><span class="inline-wrap">低<span class="jill"></span>8<span class="jill"></span>位</span></th><th style="width: 198px"><span class="inline-wrap">名称</span></th><th style="width: 554px"><span class="inline-wrap">作用</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">RAX</span></td><td><span class="inline-wrap">EAX</span></td><td><span class="inline-wrap">AX</span></td><td><span class="inline-wrap">AH</span></td><td><span class="inline-wrap">AL</span></td><td><span class="inline-wrap">累加寄存器</span></td><td><span class="inline-wrap">数值计算、函数返回</span></td></tr><tr><td><span class="inline-wrap">RBX</span></td><td><span class="inline-wrap">EBX</span></td><td><span class="inline-wrap">BX</span></td><td><span class="inline-wrap">BH</span></td><td><span class="inline-wrap">BL</span></td><td><span class="inline-wrap">基址寄存器</span></td><td><span class="inline-wrap">地址索引</span></td></tr><tr><td><span class="inline-wrap">RCS</span></td><td><span class="inline-wrap">ECS</span></td><td><span class="inline-wrap">CX</span></td><td><span class="inline-wrap">CH</span></td><td><span class="inline-wrap">CL</span></td><td><span class="inline-wrap">计数寄存器</span></td><td><span class="inline-wrap">循环计数</span></td></tr><tr><td><span class="inline-wrap">RDX</span></td><td><span class="inline-wrap">EDX</span></td><td><span class="inline-wrap">DX</span></td><td><span class="inline-wrap">DH</span></td><td><span class="inline-wrap">DL</span></td><td><span class="inline-wrap">数据寄存器</span></td><td><span class="inline-wrap">数据传递</span></td></tr><tr><td><span class="inline-wrap">RSI</span></td><td><span class="inline-wrap">ESI</span></td><td><span class="inline-wrap">SI</span></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap">源变址寄存器/索引寄存器</span></td><td><span class="inline-wrap">存放相对于<span class="jill"></span>DS<span class="jill"></span>段之源变址指针，保存、加载或扫描大量的数据</span></td></tr><tr><td><span class="inline-wrap">RDI</span></td><td><span class="inline-wrap">EDI</span></td><td><span class="inline-wrap">DI</span></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap">目的变址寄存器</span></td><td><span class="inline-wrap">存放相对于 ES 段之目的变址指针，保存、加载或扫描大量的数据</span></td></tr><tr><td><span class="inline-wrap">RBP</span></td><td><span class="inline-wrap">EBP</span></td><td><span class="inline-wrap">BP</span></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap">基址指针寄存器</span></td><td><span class="inline-wrap">指向栈中的数据，可用作<span class="jill"></span>SS<span class="jill"></span>的一个相对基址位置</span></td></tr><tr><td><span class="inline-wrap">RSP</span></td><td><span class="inline-wrap">ESP</span></td><td><span class="inline-wrap">SP</span></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap">堆栈指针</span></td><td><span class="inline-wrap">与<span class="jill"></span>SS<span class="jill"></span>配合使用，可指向活动堆栈顶部。</span></td></tr><tr><td><span class="inline-wrap">R8-R15</span></td><td><br/></td><td><br/></td><td><span class="inline-wrap"></span><br/></td><td><span class="inline-wrap"></span><br/></td><td><br/></td><td><br/></td></tr></tbody></table></div></details><details id="vsnuAZvGf7FX3q8Mstq5wf" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">段寄存器（Segment Register）</span></summary><div id="hxt2Xd8EYVXr8ixj9Xbcjj" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 64.66666666666666px"><span class="inline-wrap">32<span class="jill"></span>位</span></th><th style="width: 59.66666666666666px"><span class="inline-wrap">16<span class="jill"></span>位</span></th><th style="width: 117.66666666666666px"><span class="inline-wrap">名称</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">CS</span></td><td><span class="inline-wrap">CS</span></td><td><span class="inline-wrap">代码段寄存器</span></td></tr><tr><td><span class="inline-wrap">DS</span></td><td><span class="inline-wrap">DS</span></td><td><span class="inline-wrap">数据段寄存器</span></td></tr><tr><td><span class="inline-wrap">ES</span></td><td><span class="inline-wrap">ES</span></td><td><span class="inline-wrap">堆栈段寄存器</span></td></tr><tr><td><span class="inline-wrap">SS</span></td><td><span class="inline-wrap">SS</span></td><td><span class="inline-wrap">附加段寄存器</span></td></tr><tr><td><span class="inline-wrap">FD</span></td><td><br/></td><td><br/></td></tr><tr><td><span class="inline-wrap">GS</span></td><td><br/></td><td><br/></td></tr></tbody></table></div></details><details id="obbp7JUPnyeMvjPFT4U7Mr" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">指令指针寄存器</span><span class="inline-wrap">（</span><span class="inline-wrap">Instruction Pointer Register）</span></summary><div id="i4izq8HgDbKdrb9PStA5v3" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 74px"><span class="inline-wrap">64<span class="jill"></span>位</span></th><th style="width: 63px"><span class="inline-wrap">32<span class="jill"></span>位</span></th><th style="width: 69px"><span class="inline-wrap">16<span class="jill"></span>位</span></th><th style="width: 192px"><span class="inline-wrap">名称</span></th><th style="width: 271px"><span class="inline-wrap">作用</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">RIP</span></td><td><span class="inline-wrap">EIP</span></td><td><span class="inline-wrap">IP</span></td><td><span class="inline-wrap">扩展板的指令指针寄存器</span></td><td><span class="inline-wrap">获取、解码并执行的指令。（自动调整）</span></td></tr></tbody></table></div></details><details id="5w5EEwurzniWRJEDgbYjY1" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">标志寄存器(Flags Register)</span></summary><div id="peasoSYs5hPkUnkYdueS7k" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 81px"><span class="inline-wrap">64<span class="jill"></span>位</span></th><th style="width: 74px"><span class="inline-wrap">32<span class="jill"></span>位</span></th><th style="width: 67px"><span class="inline-wrap">16<span class="jill"></span>位</span></th><th style="width: 151px"><span class="inline-wrap">名称</span></th><th style="width: 165px"><span class="inline-wrap">作用</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">RFLAGS</span></td><td><span class="inline-wrap">EFLAGS</span></td><td><span class="inline-wrap">FLAGS</span></td><td><span class="inline-wrap">状态与控制寄存器。</span></td><td><span class="inline-wrap">不应该直接修改。</span></td></tr></tbody></table></div></details><details id="3Jvfoocha9WwitJ4sQfyhY" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">方向标志寄存器（DF）</span></summary><div id="2RJPVb1YUPJKngbnE5i81" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：它用于控制字符串操作指令中的传输方向</span></div></div><details id="6921ykbtvrfEsqZdVGDy4W" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">清零（设置位<span class="jill"></span>0）</span></summary><div id="hs1kFpts7GDcFBAMNJZ6dp" class="wolai-block wolai-text"><div><span class="inline-wrap">命令：cld</span></div></div><div id="sWwRMeQfU11qCLbjSrDNRK" class="wolai-block wolai-text"><div><span class="inline-wrap">举例：字符串操作指令将递减（反向）源和目标指针。这意味着数据将从高地址向低地址传输</span></div></div><div id="d3RgYfYUi54Vo8cB9zituG" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：在字符串复制操作中，数据将从目标字符串的末尾向起始位置复制。</span></div></div></details><details id="nw9LNdEyQaojQpi4BUP7Lu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">置位（设置位<span class="jill"></span>1）</span></summary><div id="ktbdD5onuAwnz5ZeKoFizT" class="wolai-block wolai-text"><div><span class="inline-wrap">命令：</span><span class="inline-wrap"><code>std</code></span></div></div><div id="eaHZ8mN59u9E4mm6JTBvRV" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：字符串操作指令将递增（正向）源和目标指针。这意味着数据将从低地址向高地址传输。</span></div></div><div id="jiWHfE9dBoFXodSwLZw2q1" class="wolai-block wolai-text"><div><span class="inline-wrap">举例：在字符串复制操作中，数据将从源字符串的起始位置向末尾复制。</span></div></div></details></details></h1><h1 id="pZzwJjfpxUsMkqRqNLtRTj" class="wolai-block"><span class="inline-wrap">标志位</span><details id="svJ1QCb85qzavS8rU5Cy9q" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><div id="gwM7hzLG8xG2tU9ejXcih" class="wolai-block wolai-text"><div><span class="inline-wrap">标志位是指表示处理器状态的单个位</span></div></div></details><details id="2r7b6T6rGfxHkz3s8z87kv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">分类</span></summary><details id="tr5oQ6wXwjAd3mPqSV3iLR" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">ZF（零标志位）</span></summary><div id="gJLMrp5WSRQsBM3URHhWQb" class="wolai-block wolai-text"><div><span class="inline-wrap">如果结果为零，则设置为<span class="jill"></span>1；否则为<span class="jill"></span>0。</span></div></div></details><details id="fGDKJPf1DMsaW1uxjNaZaM" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">CF（进位标志位）</span></summary><div id="31p2om7b7u69DC5dYnAEJK" class="wolai-block wolai-text"><div><span class="inline-wrap">如果无符号数相减产生借位，则设置为<span class="jill"></span>1；否则为<span class="jill"></span>0。</span></div></div></details><details id="w3ACV2Y2vrRppJAqRYRT6d" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">SF（符号标志位）</span></summary><div id="uRXctteycfLqYN1EXoMDU1" class="wolai-block wolai-text"><div><span class="inline-wrap">如果结果为负数，则设置为<span class="jill"></span>1；否则为<span class="jill"></span>0。</span></div></div></details><details id="moYN2dRX9D2o5gcp2UN4Qh" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">OF（溢出标志位）</span></summary><div id="uXfdtfR7NdFmWXpAYFowhL" class="wolai-block wolai-text"><div><span class="inline-wrap">如果有符号数相减产生溢出，则设置为<span class="jill"></span>1；否则为<span class="jill"></span>0。</span></div></div></details><div id="6MMqzCKDCQnwcwGYvvZvYu" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></details></h1><h1 id="8dwCFWYYnys5anNwvMPfff" class="wolai-block"><span class="inline-wrap">算术</span><details id="9rC3nRQUPKafJEmpZeXsyi" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">除法</span></summary><details id="bnjyeH3w2AkiQ9yySfs2Yx" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><code-block id="5W5E4RxJ3sd9LppfPVDz6o" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">div <span class="token punctuation">[</span>word<span class="token operator">/</span>dword<span class="token punctuation">]</span> <span class="token punctuation">[</span>寄存器<span class="token operator">/</span>引用地址<span class="token punctuation">]</span>
<span class="token punctuation">;</span>div 长度 除数</pre></div></code-block></details><details id="itnF3Zf83cBEc18gsZSsRG" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">寄存器</span></summary><div id="vCsQYGAiXy4GMF5byxR3uH" class="wolai-block wolai-simple-table"><table><tbody><tr><td style="width: 100px"><span class="inline-wrap">除数</span></td><td style="width: 100px"><span class="inline-wrap">被除数</span></td><td style="width: 100px"><span class="inline-wrap">商</span></td><td style="width: 100px"><span class="inline-wrap">余</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">M8/R8</span></td><td style="width: 100px"><span class="inline-wrap">ax</span></td><td style="width: 100px"><span class="inline-wrap">al</span></td><td style="width: 100px"><span class="inline-wrap">ah</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">M16/R16</span></td><td style="width: 100px"><span class="inline-wrap">dx:ax</span></td><td style="width: 100px"><span class="inline-wrap">ax</span></td><td style="width: 100px"><span class="inline-wrap">dx</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">M32/R32</span></td><td style="width: 100px"><span class="inline-wrap">edx:eax</span></td><td style="width: 100px"><span class="inline-wrap">eax</span></td><td style="width: 100px"><span class="inline-wrap">edx</span></td></tr><tr><td style="width: 100px"><span class="inline-wrap">M64/R64</span></td><td style="width: 100px"><span class="inline-wrap">rdx:rax</span></td><td style="width: 100px"><span class="inline-wrap">rax</span></td><td style="width: 100px"><span class="inline-wrap">rdx</span></td></tr></tbody></table></div></details><details id="sYivw8wj4VK9E8936McN7R" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码：无符号运算、8<span class="jill"></span>位</span></summary><code-block id="xiNk8ALKcoVL6664DeqzuF" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">    <span class="token literal-property property">BPB_SecPerTrk</span><span class="token operator">:</span> dw <span class="token number">2</span>
    <span class="token literal-property property">SectorNo</span><span class="token operator">:</span> db <span class="token number">18</span>
    
    mov ax<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token maybe-class-name">SectorNo</span><span class="token punctuation">]</span>
    div word <span class="token punctuation">[</span><span class="token maybe-class-name">BPB_SecPerTrk</span><span class="token punctuation">]</span>
    <span class="token punctuation">;</span> 商 al<span class="token operator">=</span><span class="token number">9</span>
    <span class="token punctuation">;</span> 余 ah<span class="token operator">=</span><span class="token number">0</span></pre></div></code-block></details><details id="abj3Na7PE3EGuy6jRSkQPc" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码：无符号运算、32<span class="jill"></span>位</span></summary><code-block id="iHt7Up7vTSW5Y9Qh4zQJ4J" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token punctuation">;</span>把被除数edx<span class="token operator">:</span>eax 设置为<span class="token number">32</span>
mov edx<span class="token punctuation">,</span> <span class="token number">0</span>
mov eax<span class="token punctuation">,</span> <span class="token number">32</span>

<span class="token punctuation">;</span> 把除数设置为<span class="token number">3</span>
div <span class="token number">3</span>
<span class="token punctuation">;</span> <span class="token number">32</span> <span class="token operator">/</span><span class="token number">3</span> <span class="token operator">=</span> 10r2
<span class="token punctuation">;</span> 商 eax<span class="token operator">=</span>ah
<span class="token punctuation">;</span> 余 edx<span class="token operator">=</span>2h</pre></div></code-block></details></details><details id="if8QLorSVkTdmx4WcHbU5d" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">加法</span></summary><details id="dHYNhgnYo6pVxVTw5pPMDD" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">带进位加法</span></summary><details id="nEH6CX3wUdh2fdYE6CP7AZ" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><div id="euA1NTbXEJKP3xNsGoGyEU" class="wolai-block wolai-text"><div><span class="inline-wrap">用执行<span class="jill"></span>ADC<span class="jill"></span>指令时，它会将源操作数的值与目标操作数的值相加，再加上进位标志的值（如果有进位的话），然后将结果存储到目标操作数中。</span></div></div></details><details id="7QTw37YJTzbeX8agEh5kAZ" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">影响标志位</span></summary><div id="pvc4gad8bXSRnfcrE8H5Lj" class="wolai-block wolai-text"><div><span class="inline-wrap">零标志位<span class="jill"></span>ZF、进位标志位<span class="jill"></span>CF</span></div></div></details><details id="4dK6zxvi5ta62RWLvvw4yU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><div id="tUADqq4TR5oxm1K3c8HCkB" class="wolai-block wolai-text"><div><span class="inline-wrap">destination<span class="jill"></span>表示要进行相加的目标操作数，而<span class="jill"></span>source<span class="jill"></span>表示要与目标操作数相加的源操作数。</span></div></div><code-block id="jKYYKZFhTzcxKMdGvkCic1" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">ADC</span> destination<span class="token punctuation">,</span> source</pre></div></code-block></details></details></details><details id="eASxTBedsFcitYLBcEavPi" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">递增</span></summary><details id="5LSEQvmcFi7Zc4JtpSkDVu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><div id="aKVG2ZFW7mKF5nx3Kc8neD" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>dec</code></span><span class="inline-wrap">是&quot;decrement&quot;（递减）的缩写。它是一条用于将寄存器或内存中的值减一的指令。具体来说，</span><span class="inline-wrap"><code>dec</code></span><span class="inline-wrap">指令会将操作数的值减一，并将结果存储回原来的位置。</span></div></div></details><details id="j7bPw2pMLhTL8P9mWPCdJ4" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">用法</span></summary><code-block id="csVif4pahgtNSzJLD3XdZ5" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>dec byte ptr <span class="token punctuation">[</span>eax<span class="token punctuation">]</span>  <span class="token punctuation">;</span> 递减存储在eax寄存器指向的内存位置的<span class="token number">8</span>位值
dec word ptr <span class="token punctuation">[</span>ebx<span class="token punctuation">]</span>  <span class="token punctuation">;</span> 递减存储在ebx寄存器指向的内存位置的<span class="token number">16</span>位值
dec dword ptr <span class="token punctuation">[</span>ecx<span class="token punctuation">]</span> <span class="token punctuation">;</span> 递减存储在ecx寄存器指向的内存位置的<span class="token number">32</span>位值</pre></div></code-block></details><div id="iraW4YggtM2j4TpxUzzwVc" class="wolai-block wolai-text"><div><span class="inline-wrap">需要注意的是，</span><span class="inline-wrap"><code>dec</code></span><span class="inline-wrap">指令会影响标志寄存器中的标志位，比如溢出标志（overflow flag）和零标志（zero flag）。</span></div></div></details></h1><h1 id="iPFa5sowN3g4UHdJRugwK5" class="wolai-block"><span class="inline-wrap">位</span><details id="jiQ2ZWbmjNyN9zVcix3kqL" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">操作</span></summary><details id="3h8BG4jWKjcUzcT6X87VVa" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">左移</span></summary><div id="a9bwFEMtEPrvMFfAVHwNBN" class="wolai-block wolai-text"><div><span class="inline-wrap">说明：将累加器 </span><span class="inline-wrap"><code>al</code></span><span class="inline-wrap"> 的值向左移动一位。</span></div></div><div id="pHbSmioRwtdfFvs5ad2uz8" class="wolai-block wolai-text"><div><span class="inline-wrap">算术：al*2</span></div></div><div id="5AcKmUZf4QqqZ8DT18BRQn" class="wolai-block wolai-text"><div><span class="inline-wrap">记作：</span><span class="inline-wrap"><code>al&lt;&lt;1</code></span></div></div><details id="vqG2hhxpKcGKxTDoak3d2c" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码</span></summary><code-block id="ei7QixqkLUkw8tEL1Tnss9" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">shl al<span class="token punctuation">,</span> <span class="token number">1</span></pre></div></code-block></details></details><details id="5vVJycugHbsu5qEtqjpW9r" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">右移</span></summary><div id="gWp9GwJwazDBd6wuKzt2ms" class="wolai-block wolai-text"><div><span class="inline-wrap">说明：将累加器 </span><span class="inline-wrap"><code>al</code></span><span class="inline-wrap"> 的值向右边移动一位。</span></div></div><div id="521midP6HtLPSXSn1LMQMx" class="wolai-block wolai-text"><div><span class="inline-wrap">算术：al/2，</span></div></div><div id="7bpD4nVHedtRUC4ypmzxBu" class="wolai-block wolai-text"><div><span class="inline-wrap">记作：</span><span class="inline-wrap"><code>al&gt;&gt;1</code></span></div></div><details id="65xiUFhAABhmxdzKkVwpnU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码</span></summary><code-block id="wpKkN17DuKNqAi2kR7E3i4" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">shr al<span class="token punctuation">,</span> <span class="token number">1</span></pre></div></code-block></details></details></details><details id="ngurRNzzoaEChusXR2bRwS" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">运算</span></summary><details id="fszyja1VoK7D6d87GbJbTC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">OR（逻辑或</span><span class="inline-wrap">）</span></summary><details id="fKqxbKeR22KrnnDvzdYcMi" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">作用</span></summary><div id="35vpL3noVnBreKwdPUugCQ" class="wolai-block wolai-text"><div><span class="inline-wrap">命令执行的操作是将两个操作数的对应位进行逻辑或运算，生成一个结果。如果任何一个位上的操作数为<span class="jill"></span>1，那么结果对应的位就是<span class="jill"></span>1，否则为<span class="jill"></span>0。</span></div></div></details><details id="3rXedxEXD81HpE9iJyL3A3" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><div id="ms5NB8FgTtNUZVuWvYXkKS" class="wolai-block wolai-text"><div><span class="inline-wrap">destination<span class="jill"></span>和<span class="jill"></span>source<span class="jill"></span>可以是寄存器、内存位置或立即数</span></div></div><code-block id="xsPdm9VzRZhow633KjAhQo" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">or destination<span class="token punctuation">,</span> source</pre></div></code-block></details><details id="wrj7MTdxem55MuXx9SuHkE" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码</span></summary><code-block id="t4qhgKYdn5Gy6XkEGTt4Q4" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>or eax<span class="token punctuation">,</span> ebx  <span class="token punctuation">;</span> 将寄存器eax与寄存器ebx进行逻辑或操作，并将结果存储在eax中
or ecx<span class="token punctuation">,</span> <span class="token number">0x12</span> <span class="token punctuation">;</span> 将寄存器ecx与立即值<span class="token number">0x12</span>进行逻辑或操作，并将结果存储在ecx中
or <span class="token punctuation">[</span>esi<span class="token punctuation">]</span><span class="token punctuation">,</span> dl <span class="token punctuation">;</span> 将内存位置<span class="token punctuation">[</span>esi<span class="token punctuation">]</span>与寄存器dl进行逻辑或操作，并将结果存储在<span class="token punctuation">[</span>esi<span class="token punctuation">]</span>中</pre></div></code-block></details></details></details></h1><h1 id="phfjrPCSeP71b21ChWbroD" class="wolai-block"><span class="inline-wrap">字符串</span><details id="sANrRAjdma5MGcm2jdNUBC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">对比</span></summary><details id="8XaYTK3v36tEqLR6rwcPkC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">cmps</span></summary><div id="q7soC54JiijwrZ9sxPN5YD" class="wolai-block wolai-text"><div><span class="inline-wrap">用于比较两个字符串的内容。</span></div></div></details></details><details id="q2LhijjxzryfPrSsmerCwJ" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">逐字节加载</span></summary><div id="bQB8k9WwF1oRAAZTCk3UAg" class="wolai-block wolai-text"><div><span class="inline-wrap">命令：lodsb</span></div></div><div id="8pXjMZsYbSMH3g4mqbKUPr" class="wolai-block wolai-text"><div><span class="inline-wrap">相关命令：lodsw/lodsd/lodsq</span></div></div><div id="qtPNRfVLnPu2jbMED1kcFY" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：从<span class="jill"></span>DS:RSI / DS:ESI / DS:SI<span class="jill"></span>寄存器指定的内存地址中读取数据到<span class="jill"></span>RAX/EAX/AX<span class="jill"></span>寄存器 。</span></div></div><div id="mJwMB2N6aQxtuDaojNzRaM" class="wolai-block wolai-text"><div><span class="inline-wrap">标志符：如果方向标志位（DF）被设置为<span class="jill"></span>0，则<span class="jill"></span>SI<span class="jill"></span>自动递增；如果<span class="jill"></span>DF<span class="jill"></span>被设置为<span class="jill"></span>1，则<span class="jill"></span>SI<span class="jill"></span>自动递减</span></div></div><details id="raRTq3KzrFBrENeE1xxTf6" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码</span></summary><code-block id="4wpdTt5DRa3sWVzMszEGfX" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">section <span class="token punctuation">.</span><span class="token property-access">data</span>
    myString db <span class="token string">'Hello, World!'</span><span class="token punctuation">,</span> <span class="token number">0</span>

section <span class="token punctuation">.</span><span class="token property-access">text</span>
    global _start

<span class="token literal-property property">_start</span><span class="token operator">:</span>
    <span class="token punctuation">;</span> 设置数据段寄存器
    mov ax<span class="token punctuation">,</span> <span class="token number">0x0000</span>
    mov ds<span class="token punctuation">,</span> ax

    <span class="token punctuation">;</span> 设置源索引寄存器
    mov si<span class="token punctuation">,</span> myString

    <span class="token punctuation">;</span> 使用 lodsb 加载一个字节到 <span class="token constant">AL</span> 寄存器中
    lodsb

    <span class="token punctuation">;</span> 在这里可以对 <span class="token constant">AL</span> 寄存器中的值进行处理
    <span class="token punctuation">;</span> 例如，可以将其打印到屏幕上

    <span class="token punctuation">;</span> 退出程序
    mov eax<span class="token punctuation">,</span> <span class="token number">1</span>
    xor ebx<span class="token punctuation">,</span> ebx
    int <span class="token number">0x80</span></pre></div></code-block></details></details></h1><h1 id="dNh3LDCwta5panFWvQr32G" class="wolai-block"><span class="inline-wrap">对比</span><details id="bdBwnDMdePaxNBf46VyDP8" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">cmp</span></summary><details id="jfuvEJsFsY1LzCkihMKu8j" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><div id="j8NyMT5jvcfCG8juoMR11N" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>cmp</code></span><span class="inline-wrap">（比较）指令用于比较两个操作数的值。该指令会将两个操作数相减，并根据结果设置标志寄存器的相应位。</span></div></div></details><details id="5tuK3CgzE9t44Ayd35qhiB" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><div id="hYnrg3iH8Zhjg6jBqHtm72" class="wolai-block wolai-text"><div><span class="inline-wrap"> </span><span class="inline-wrap"><code>destination</code></span><span class="inline-wrap"> 和 </span><span class="inline-wrap"><code>source</code></span><span class="inline-wrap"> 是要进行比较的操作数。它们可以是寄存器、内存位置或立即数。</span></div></div><code-block id="78akMYocPCwgWob7JH2zGa" class="wolai-block"><div class="wolai-pre"><div data-lang="Text" class="marker"></div><pre>cmp destination, source</pre></div></code-block></details><details id="dKsFY2sgvFP4maY6sD9z6q" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">执行过程</span></summary><ol class="wolai-block"><li id="jjmSrfxpiMsjSRd9gJr2as"><div class="marker"></div><span class="inline-wrap">将 </span><span class="inline-wrap"><code>destination</code></span><span class="inline-wrap"> 和 </span><span class="inline-wrap"><code>source</code></span><span class="inline-wrap"> 的值相减，但不保存结果。</span></li><li id="ufMwZBGdWKegYVT8b3N9GP"><div class="marker"></div><span class="inline-wrap">根据减法的结果设置标志寄存器的标志位。这些标志位包括零标志位（ZF）、进位标志位（CF）、符号标志位（SF）、溢出标志位（OF）等。</span></li></ol></details><details id="wMUdUnBnUWN3uFiH6mFAr1" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例</span></summary><code-block id="vt83CS7o9MKNppj9S5Jozk" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>mov eax<span class="token punctuation">,</span> <span class="token number">10</span>     <span class="token punctuation">;</span> 将值<span class="token number">10</span>存储到 eax 寄存器
mov ebx<span class="token punctuation">,</span> <span class="token number">20</span>     <span class="token punctuation">;</span> 将值<span class="token number">20</span>存储到 ebx 寄存器
cmp eax<span class="token punctuation">,</span> ebx    <span class="token punctuation">;</span> 比较 eax 和 ebx 的值</pre></div></code-block><div id="xiQjsfc3fPb53TbakNUxKh" class="wolai-block wolai-text"><div><span class="inline-wrap">在这个示例中，</span><span class="inline-wrap"><code>cmp</code></span><span class="inline-wrap"> 指令将比较 </span><span class="inline-wrap"><code>eax</code></span><span class="inline-wrap"> 和 </span><span class="inline-wrap"><code>ebx</code></span><span class="inline-wrap"> 寄存器的值。根据比较结果，可以使用条件跳转指令来执行不同的指令路径。</span></div></div><div id="qr7QbzpqG6iRr12DhZqeHC" class="wolai-block wolai-text"><div><span class="inline-wrap">总结一下，</span><span class="inline-wrap"><code>cmp</code></span><span class="inline-wrap"> 指令用于比较两个操作数的值，并设置标志寄存器的标志位，以便后续的条件跳转或其他操作可以根据比较结果进行决策。</span></div></div></details></details></h1><h1 id="rxNJ48Y8MoY9iFDyWGnBCp" class="wolai-block"><span class="inline-wrap">循环</span><details id="hmdoGYmMSUDmSm1hqr823V" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">LOOPNE（zero<span class="jill"></span>标志位不等于<span class="jill"></span>0</span><span class="inline-wrap">）</span></summary><details id="qqjnu3nnV6x348C9wAw2dp" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">作用</span></summary><div id="9CeXfwujLcu1UoqktPaS1T" class="wolai-block wolai-text"><div><span class="inline-wrap">用于在满足循环计数器不为零且标志寄存器中的<span class="jill"></span>Zero<span class="jill"></span>标志位不为<span class="jill"></span>0<span class="jill"></span>时，重复执行接下来的指令快</span></div></div></details><details id="5o3TS1RQgnNNC3TT5Popah" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><code-block id="vi7JeJvq97Ck8KsYsxNviN" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token literal-property property">label</span><span class="token operator">:</span>
    <span class="token punctuation">;</span> 循环体指令
    <span class="token punctuation">;</span> <span class="token spread operator">...</span>

    loopne label</pre></div></code-block></details></details></h1><h1 id="ar4ZcaDRJVHdJrngEKSRJ7" class="wolai-block"><span class="inline-wrap">跳转</span><details id="wCCvK6oM4G98vELYcryu5W" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">无条件的远跳转: JMP</span></summary><code-block id="j6iTuKbGW8GeK7cXdxgeRt" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token punctuation">;</span>段地址和段内偏移组成
<span class="token constant">JMP</span> <span class="token constant">FAR</span> <span class="token constant">SECTION</span><span class="token operator">:</span><span class="token constant">OFFSET</span></pre></div></code-block></details><details id="jYbqpSjyB9Ng4BrrZ7dCth" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap">根据 EFLAGS 寄存器的标志位跳转</span></summary></details><details id="wy2UZWCa43KnCDCZaWRa26" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">有条件跳转</span></summary><details id="ro4nUr6vDiJk8ehFviUBz" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">带符号数与无符号数</span></summary><div id="oanR33AgQ8TBo18XDgW3Jz" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 246.66666666666666px"><span class="inline-wrap">标志</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">指令</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">如果<span class="jill"></span>xxx，就跳转</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">OF=1</span></td><td><span class="inline-wrap">JO</span></td><td><span class="inline-wrap">溢出</span></td></tr><tr><td><span class="inline-wrap">OF=0</span></td><td><span class="inline-wrap">JNO</span></td><td><span class="inline-wrap">不溢出</span></td></tr><tr><td><span class="inline-wrap">PF=1</span></td><td><span class="inline-wrap">JP</span></td><td><span class="inline-wrap">奇偶校验位 置位</span></td></tr><tr><td><span class="inline-wrap">PF=0</span></td><td><span class="inline-wrap">JNP</span></td><td><span class="inline-wrap">奇偶校验位 不置位</span></td></tr><tr><td><span class="inline-wrap">SF=1</span></td><td><span class="inline-wrap">JS</span></td><td><span class="inline-wrap">符号位 置位</span></td></tr><tr><td><span class="inline-wrap">SF=0</span></td><td><span class="inline-wrap">JNS</span></td><td><span class="inline-wrap">符号位 不置位</span></td></tr><tr><td><span class="inline-wrap">ZF=1</span></td><td><span class="inline-wrap">JE</span></td><td><span class="inline-wrap">相等</span></td></tr><tr><td><span class="inline-wrap">ZF=1</span></td><td><span class="inline-wrap">JZ</span></td><td><span class="inline-wrap">为<span class="jill"></span>0</span></td></tr><tr><td><span class="inline-wrap">ZF=0</span></td><td><span class="inline-wrap">JNE</span></td><td><span class="inline-wrap">不相等</span></td></tr><tr><td><span class="inline-wrap">ZF=0</span></td><td><span class="inline-wrap">JNZ</span></td><td><span class="inline-wrap">不为<span class="jill"></span>0</span></td></tr><tr><td><span class="inline-wrap">CX=0</span></td><td><span class="inline-wrap">JCXZ</span></td><td><span class="inline-wrap">CX<span class="jill"></span>为<span class="jill"></span>0</span></td></tr><tr><td><span class="inline-wrap">ECX=0</span></td><td><span class="inline-wrap">JECXZ</span></td><td><span class="inline-wrap">ECX<span class="jill"></span>为<span class="jill"></span>0</span></td></tr><tr><td><span class="inline-wrap">RCX=0</span></td><td><span class="inline-wrap">JRCXZ</span></td><td><span class="inline-wrap">RCX<span class="jill"></span>为<span class="jill"></span>0</span></td></tr></tbody></table></div></details><details id="nnJBEgN4vKgZ9QRJ7Z7JV5" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">带符号数</span></summary><div id="maqoK7BZFthzp4mKGAD7FX" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 246.66666666666666px"><span class="inline-wrap">标志</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">指令</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">如果<span class="jill"></span>xxx，就跳转</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">SF != OF</span></td><td><span class="inline-wrap">JL</span></td><td><span class="inline-wrap">小于</span></td></tr><tr><td><span class="inline-wrap">SF != OF</span></td><td><span class="inline-wrap">JNGE</span></td><td><span class="inline-wrap">不大于或不等于</span></td></tr><tr><td><span class="inline-wrap">SF = OF</span></td><td><span class="inline-wrap">JGE</span></td><td><span class="inline-wrap">大于或等于</span></td></tr><tr><td><span class="inline-wrap">SF = OF</span></td><td><span class="inline-wrap">JNL</span></td><td><span class="inline-wrap">不小于</span></td></tr><tr><td><span class="inline-wrap">ZF=1 or SF != OF</span></td><td><span class="inline-wrap">JLE</span></td><td><span class="inline-wrap">小于或等于</span></td></tr><tr><td><span class="inline-wrap">ZF=1 or SF != OF</span></td><td><span class="inline-wrap">JNLG</span></td><td><span class="inline-wrap">不大于</span></td></tr><tr><td><span class="inline-wrap">ZF=0 and SF!=OF</span></td><td><span class="inline-wrap">JG</span></td><td><span class="inline-wrap">大于</span></td></tr><tr><td><span class="inline-wrap">ZF=0 and SF!=OF</span></td><td><span class="inline-wrap">JNLE</span></td><td><span class="inline-wrap">不小于或等于</span></td></tr></tbody></table></div></details><details id="dcN6HGLtzEMLRr92hczAjJ" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">无符号数</span></summary><div id="jjWDh8BDeoEpvkRG6eabdE" class="wolai-block wolai-simple-table"><table><thead><tr><th style="width: 246.66666666666666px"><span class="inline-wrap">标志</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">指令</span></th><th style="width: 246.66666666666666px"><span class="inline-wrap">如果<span class="jill"></span>xxx，就跳转</span></th></tr></thead><tbody><tr><td><span class="inline-wrap">CF=1</span></td><td><span class="inline-wrap">JB</span></td><td><span class="inline-wrap">低于</span></td></tr><tr><td><span class="inline-wrap">CF=1</span></td><td><span class="inline-wrap">JC</span></td><td><span class="inline-wrap">进位标志位置位</span></td></tr><tr><td><span class="inline-wrap">CF=1</span></td><td><span class="inline-wrap">JNAE</span></td><td><span class="inline-wrap">不高于或不等于</span></td></tr><tr><td><span class="inline-wrap">CF=0</span></td><td><span class="inline-wrap">JAE</span></td><td><span class="inline-wrap">高于或等于</span></td></tr><tr><td><span class="inline-wrap">CF=0</span></td><td><span class="inline-wrap">JNB</span></td><td><span class="inline-wrap">不低于</span></td></tr><tr><td><span class="inline-wrap">CF=0</span></td><td><span class="inline-wrap">JNC</span></td><td><span class="inline-wrap">进位标志 不置位</span></td></tr><tr><td><span class="inline-wrap">CF=1 or ZF=1</span></td><td><span class="inline-wrap">JBE</span></td><td><span class="inline-wrap">低于或等于</span></td></tr><tr><td><span class="inline-wrap">CF=1 or ZF=1</span></td><td><span class="inline-wrap">JNA</span></td><td><span class="inline-wrap">不高于</span></td></tr><tr><td><span class="inline-wrap">CF=0 or ZF=0</span></td><td><span class="inline-wrap">JA</span></td><td><span class="inline-wrap">高于</span></td></tr><tr><td><span class="inline-wrap">CF=0 or ZF=0</span></td><td><span class="inline-wrap">JNBE</span></td><td><span class="inline-wrap">不低于或等于</span></td></tr></tbody></table></div></details></details></h1><h1 id="nhcdX6oXVPSt3vuiGTaHjp" class="wolai-block"><span class="inline-wrap">函数</span><details id="cD95ZERutLf4J3LXUfmPzq" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">栈</span></summary><details id="6a6jftHKgRSf48sww18yTE" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">特点</span></summary><div id="mJCT8VeK26BPmHTCWJ5tfw" class="wolai-block wolai-text"><div><span class="inline-wrap">在调用函数时增长，并在调用结束时结束收缩</span></div></div><div id="o6Pb1okJj8DqfsjrRXvAKT" class="wolai-block wolai-text"><div><span class="inline-wrap">会在推入局部变量时增长，弹出局部变量时收缩</span></div></div><div id="6LXxC9wVcFcPbXesqqW5F6" class="wolai-block wolai-text"><div><span class="inline-wrap">向下增长（推人栈中的新内容会出现在地址值较低的位置中）</span></div></div></details><details id="kjNuZj9hZhaRRUANi85h9L" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">大小</span></summary><div id="934Ujq3ffu647eWsT48osc" class="wolai-block wolai-text"><div><span class="inline-wrap">32 位环境下，栈中的每个元素占据<span class="jill"></span>4 个字节</span></div></div><div id="aLsutXH83uwtF6VeJ2oDZD" class="wolai-block wolai-text"><div><span class="inline-wrap">64<span class="jill"></span>位环境下，栈中的每个元素占据<span class="jill"></span>8 个字节</span></div></div></details><details id="qdKFrCpG6aeo6U9GR6aUZu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">组成部分</span></summary><details id="2498FNvQAK7r5bNsWBydoo" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">栈帧（Stack Frame）</span></summary><details id="e4Tad1rJfpBsyoCUAWYazB" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">定义</span></summary><div id="byCbUeBmuDXdXPobokaRep" class="wolai-block wolai-text"><div><span class="inline-wrap">栈帧是在函数调用期间在栈中分配的一块内存区域。</span></div></div></details><details id="g9dSHxtW6UwSiVfMcW1Afo" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">创建</span></summary><div id="vMpKv4buZS2kCDcwSpu3g" class="wolai-block wolai-text"><div><span class="inline-wrap">每当函数被调用时，会自动创建一个新的栈帧，会被压入栈中。</span></div></div></details><details id="hXSjGXrNMn4BHhXc7TG55r" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">目的</span></summary><div id="inkysQuvYTbqWsePLLFou1" class="wolai-block wolai-text"><div><span class="inline-wrap">保存局部变量和必要的上下文</span></div></div></details><details id="m6RCUFs8yYyzuBcsSYBjFM" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">寄存器</span></summary><details id="wBiFovmmhHKDYWeyJUU7zk" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">SP</span></summary><div id="pPRRNLvGdAmKQUPEYY2Q7r" class="wolai-block wolai-text"><div><span class="inline-wrap">定义：是一个指向栈顶的指针寄存器。它指向当前栈帧的顶部，即栈中最后一个压入的数据的位置。</span></div></div><div id="k8E6gQ7iCAAxxZmR2XvNAJ" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：SP<span class="jill"></span>主要用于栈的操作，如推入和弹出数据。当需要将数据压入栈时，可以使用<span class="jill"></span>SP<span class="jill"></span>来计算新数据的位置，并将<span class="jill"></span>SP<span class="jill"></span>递减以指向新的栈顶。当需要弹出数据时，可以使用<span class="jill"></span>SP<span class="jill"></span>来访问当前栈顶的数据，并将<span class="jill"></span>SP<span class="jill"></span>递增以指向下一个数据。</span></div></div><div id="bkHQyPczs3u87guzVey7ip" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：分配局部变量（方式：减小栈指针<span class="jill"></span>SP<span class="jill"></span>的值来分配）</span></div></div><div id="wNpEy1LZqNZ73i5unV5pe6" class="wolai-block wolai-text"><div><span class="inline-wrap">注意：在函数调用过程中，SP<span class="jill"></span>的值会随着数据的推入和弹出而变化，以维护栈的正确状态</span></div></div></details><details id="rb5BE1dx2gJdk7GRHUqm4C" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">BP</span></summary><div id="pUMfrsUxfhyoKeWnp5ZFy2" class="wolai-block wolai-text"><div><span class="inline-wrap">定义：是一个用于定位当前栈帧的基址寄存器。它通常指向当前函数栈帧的底部，也就是栈帧中的参数和局部变量的起始位置。</span></div></div><div id="dmv1ijpvXM5axTaCBmm48U" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：用于访问函数的参数和局部变量。通过偏移量和<span class="jill"></span>BP<span class="jill"></span>的值，可以访问相对于当前栈帧的参数和局部变量的位置。</span></div></div><div id="hSrwUoSBYZAen2f49R6YFf" class="wolai-block wolai-text"><div><span class="inline-wrap">注意：在函数调用过程中，BP<span class="jill"></span>的值通常会被保存到栈中，以便在函数返回时恢复上一个函数的栈帧。</span></div></div></details></details><details id="fMFf7jzq6GwQU6jpY4B2vZ" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">组成部分</span></summary><details id="tgAUgtTFyy5fdeyi6WgtMB" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">参数（Arguments）</span></summary><div id="vvHTAKQAEXM9tCcjGcjgAf" class="wolai-block wolai-text"><div><span class="inline-wrap">函数调用时传递给函数的参数通常会被存储在栈帧中。参数可以通过相对于栈帧基址（SP<span class="jill"></span>寄存器）的偏移量来访问。</span></div></div></details></details><details id="n9HYhfPoJHZqaPe9ZeEiPU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">位置</span></summary><div id="mVBGs2QngZH5fn3vCmhtSB" class="wolai-block wolai-text"><div><span class="inline-wrap">栈帧顶部：由<span class="jill"></span>SP<span class="jill"></span>确定</span></div></div><div id="mKJavwgpPUv36XbypsZY2Q" class="wolai-block wolai-text"><div><span class="inline-wrap">栈</span><span class="inline-wrap">帧</span><span class="inline-wrap">底</span><span class="inline-wrap">部</span><span class="inline-wrap">：由<span class="jill"></span>BP<span class="jill"></span>确定</span></div></div><div id="Nx5xbHJ8HP8RLWjMRykdy" class="wolai-block wolai-text"><div><span class="inline-wrap">栈帧在内存中的位置是通过栈指针（SP）和基址指针（BP）来确定的。具体的位置计算方式取决于采用的编程约定和机器架构。</span></div></div><div id="pi6Ddmcm9PDNjatvCE1z3f" class="wolai-block wolai-text"><div><span class="inline-wrap">在一般情况下，栈帧的位置相对于基址指针（BP）来进行偏移计算。基址指针（BP）通常指向当前栈帧的底部，也就是栈帧中的参数和局部变量的起始位置。</span></div></div><div id="fbRkzvqq4NVuuULPBF3gV9" class="wolai-block wolai-text"><div><span class="inline-wrap">以下是一个示例，展示了在<span class="jill"></span>x86<span class="jill"></span>架构下，使用基址指针（BP）和栈指针（SP）来计算栈帧中的位置偏移量：</span></div></div><code-block id="v6vD3jhouJzXkD8UqRfhHg" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>push bp         <span class="token punctuation">;</span> 将上一个函数的基址指针推入栈中
mov bp<span class="token punctuation">,</span> sp      <span class="token punctuation">;</span> 将栈指针的值赋给基址指针，建立当前栈帧

sub sp<span class="token punctuation">,</span> <span class="token number">16</span>      <span class="token punctuation">;</span> 为局部变量分配<span class="token number">16</span>字节的空间，栈指针减去<span class="token number">16</span>

mov dword <span class="token punctuation">[</span>bp<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span>    <span class="token punctuation">;</span> 将值<span class="token number">10</span>存储到基址指针偏移量为<span class="token operator">-</span><span class="token number">8</span>的位置
mov word <span class="token punctuation">[</span>bp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span>     <span class="token punctuation">;</span> 将值<span class="token number">20</span>存储到基址指针偏移量为<span class="token number">4</span>的位置
</pre></div></code-block><div id="4NVCnakBqE1hcAJDtWsjDY" class="wolai-block wolai-text"><div><span class="inline-wrap">在上述示例中，通过</span><span class="inline-wrap"><code>mov bp, sp</code></span><span class="inline-wrap">语句，将栈指针（SP）的值赋给基址指针（BP），建立了当前栈帧。然后，使用基址指针（BP）和偏移量来访问栈帧中的位置。例如，</span><span class="inline-wrap"><code>mov dword [bp-8], 10</code></span><span class="inline-wrap">将值<span class="jill"></span>10<span class="jill"></span>存储到基址指针偏移量为-8<span class="jill"></span>的位置，而</span><span class="inline-wrap"><code>mov word [bp+4], 20</code></span><span class="inline-wrap">将值<span class="jill"></span>20<span class="jill"></span>存储到基址指针偏移量为<span class="jill"></span>4<span class="jill"></span>的位置。</span></div></div><div id="u5dB7Us9wbfYsgytnQ5EdT" class="wolai-block wolai-text"><div><span class="inline-wrap">需要注意的是，不同的编程约定和机器架构可能会有不同的栈帧布局和偏移计算规则。在编写汇编代码时，应根据目标平台和约定来确定正确的偏移量计算方式。</span></div></div><div id="5VRnoYeznhhb1H9xSG3P4n" class="wolai-block wolai-text"><div><span class="inline-wrap"></span><br/></div></div></details></details><details id="nJpkK5tcgdofejYC7NzFpF" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">返回地址（Return Address）</span></summary><div id="8Ev4ioGZHRAxDt6Nyfb58P" class="wolai-block wolai-text"><div><span class="inline-wrap">返回地址是指调用函数后需要继续执行的下一条指令的地址。在函数调用时，返回地址会被推入栈中，以便在函数执行结束后能够返回到正确的位置。</span></div></div></details><details id="ew265VXok656TbZpPmQUKc" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">局部变量（Local Variables）</span></summary><div id="v71i4KrMq5S3Y3U6JCseyb" class="wolai-block wolai-text"><div><span class="inline-wrap">函数中声明的局部变量也会被分配在栈帧中。局部变量相对于基址指针（BP）的偏移量是负的。</span></div></div></details><details id="dD4Ntb9bm9AJDiZH7FT4eD" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">传入参数（可能有</span><span class="inline-wrap">）</span></summary><div id="f2bkNi6dTPoYunbzcn9FjU" class="wolai-block wolai-text"><div><span class="inline-wrap">函数的局部变量和传入的参数在栈上是相邻存放的，传入的函数参数相对于基址指针（BP）的偏移量是正的。</span></div></div></details><details id="6kXBpGb7BHn3uThHg5zvt9" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">保存的寄存器（Saved Registers）</span></summary><div id="gAL7q9VWToLASUnA5ZBgBJ" class="wolai-block wolai-text"><div><span class="inline-wrap">某些寄存器的值在函数调用期间需要被保存，以便在函数返回时能够恢复原始值。这些寄存器的值通常会被保存在栈帧中。</span></div></div></details></details><details id="abiCMnjxMLNbwFEtfkV2X" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">压入</span></summary><details id="mvi8VEXBmTkxbnvBj4PKvV" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">push（</span><span class="inline-wrap">单个寄存器</span><span class="inline-wrap">）</span></summary><details id="5FWNQHa8RceAXYmtXVCEQT" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">作用</span></summary><div id="5MaRF2HHVTyVRh8PgYxXMv" class="wolai-block wolai-text"><div><span class="inline-wrap">将一个值或寄存器中的内容压入堆栈的栈顶，并更新堆栈指针。</span></div></div></details><details id="cWq9sjzifie2kwFVNH4qrh" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例</span></summary><code-block id="cufEXtRWoKRcUKzwcsWA7" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">mov eax<span class="token punctuation">,</span> <span class="token number">42</span>     <span class="token punctuation">;</span> 将值 <span class="token number">42</span> 存储在寄存器 eax 中
push eax        <span class="token punctuation">;</span> 将寄存器 eax 中的值压入堆栈</pre></div></code-block></details></details></details><details id="dCP69kU3C3VxoapZtRGTtu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">弹出</span></summary><details id="j8azJq7xXrbdoqdaJ5qYUb" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap">pop（单个寄存器</span><span class="inline-wrap">）</span></summary></details><details id="sWHeu4zexu5xxcP7rPv1pF" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">popa（多个寄存器，仅<span class="jill"></span>x86<span class="jill"></span>以下）</span></summary><details id="3uFRkYwAvp8q6LS6QbxnRw" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">作用</span></summary><div id="6VbfFdzopjfYrb8JM9k9kX" class="wolai-block wolai-text"><div><span class="inline-wrap">将栈顶的数据弹出并按照以下顺序存储到一组通用寄存器中：EDI、ESI、EBP、ESP、EBX、EDX、ECX、EAX（或相应的<span class="jill"></span>16<span class="jill"></span>位寄存器）。</span></div></div></details><details id="4Djtrf4Hd1qvdQuGhSV6oG" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">注意</span></summary><div id="s2L9Bi3zcVf1egD83CTtPh" class="wolai-block wolai-text"><div><span class="inline-wrap">这个指令通常与</span><span class="inline-wrap"><code>pusha</code></span><span class="inline-wrap">指令配对使用，用于保存和恢复寄存器的状态。通过将寄存器的值推入栈中，然后使用</span><span class="inline-wrap"><code>popa</code></span><span class="inline-wrap">指令将值从栈中弹出到寄存器中，可以方便地保存和恢复多个寄存器的内容。</span></div></div></details></details></details></details><details id="bkV7kMRz8fxn32xKJqCis7" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">调用方式</span></summary><details id="3eUG37dhGmwbBSRKmJZCus" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">直接调用</span></summary><code-block id="cKoznadpjB4tw5Mszwfcxm" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">CALL</span> 函数名</pre></div></code-block></details><details id="jZn3AUNPUTX6FCna5rvssx" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">远调用</span></summary><code-block id="nBCiUaGkYQFxQnzRKMZiwH" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token punctuation">;</span>段地址和段内偏移组成
<span class="token constant">CALL</span> <span class="token constant">FAR</span> <span class="token constant">SECTION</span><span class="token operator">:</span><span class="token constant">OFFSET</span></pre></div></code-block></details></details><details id="rFKLA1mwgGrJWwuKapu4hj" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">返回</span></summary><div id="iAHPko6BACs6uyFmraRMy9" class="wolai-block wolai-text"><div><span class="inline-wrap">远返回<span class="jill"></span>RET：无操作数</span></div></div><code-block id="e9f6fcAHbtogiW3ikStCYz" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">RET</span></pre></div></code-block></details><details id="mSaucS8xVcymJRdvKbvshU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例：传参</span></summary><div id="hyjCJ58coq7bQ6bKtCKCeN" class="wolai-block wolai-text"><div><span class="inline-wrap">假设有一个名为</span><span class="inline-wrap"><code>add_numbers</code></span><span class="inline-wrap">的函数，它接受两个整数作为参数，并返回它们的和。</span></div></div><code-block id="6nkRxQWtEBvUEmVRr8eXBt" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre>section <span class="token punctuation">.</span><span class="token property-access">text</span>
    global _start

<span class="token literal-property property">_start</span><span class="token operator">:</span>
    <span class="token punctuation">;</span> 推送第一个参数
    mov eax<span class="token punctuation">,</span> <span class="token number">10</span>        <span class="token punctuation">;</span> 第一个参数为<span class="token number">10</span>
    push eax           <span class="token punctuation">;</span> 将第一个参数推入栈

    <span class="token punctuation">;</span> 推送第二个参数
    mov eax<span class="token punctuation">,</span> <span class="token number">20</span>        <span class="token punctuation">;</span> 第二个参数为<span class="token number">20</span>
    push eax           <span class="token punctuation">;</span> 将第二个参数推入栈

    <span class="token punctuation">;</span> 调用add_numbers函数
    call add_numbers

    <span class="token punctuation">;</span> 清理栈上的参数
    add esp<span class="token punctuation">,</span> <span class="token number">8</span>         <span class="token punctuation">;</span> 清理推入栈的两个参数（每个参数<span class="token number">4</span>个字节）

    <span class="token punctuation">;</span> 程序终止
    mov eax<span class="token punctuation">,</span> <span class="token number">1</span>         <span class="token punctuation">;</span> 退出系统调用号
    xor ebx<span class="token punctuation">,</span> ebx       <span class="token punctuation">;</span> 返回值为<span class="token number">0</span>
    int <span class="token number">0x80</span>           <span class="token punctuation">;</span> 执行系统调用

<span class="token punctuation">;</span> 函数体
<span class="token literal-property property">add_numbers</span><span class="token operator">:</span>
    mov ebx<span class="token punctuation">,</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>   <span class="token punctuation">;</span> 第一个参数在esp<span class="token operator">+</span><span class="token number">4</span>的位置
    mov ecx<span class="token punctuation">,</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span>   <span class="token punctuation">;</span> 第二个参数在esp<span class="token operator">+</span><span class="token number">8</span>的位置
    add ebx<span class="token punctuation">,</span> ecx       <span class="token punctuation">;</span> 将两个参数相加
    ret                <span class="token punctuation">;</span> 返回</pre></div></code-block><div id="qUvaFyCAjWHsJfFfr4sKuF" class="wolai-block wolai-text"><div><span class="inline-wrap">在上面的示例中，假设函数的参数为<span class="jill"></span>32<span class="jill"></span>位整数。首先，我们将第一个参数<span class="jill"></span>10<span class="jill"></span>赋给寄存器<span class="jill"></span>eax，并使用</span><span class="inline-wrap"><code>push</code></span><span class="inline-wrap">指令将其推入栈。然后，我们将第二个参数<span class="jill"></span>20<span class="jill"></span>赋给<span class="jill"></span>eax，并再次使用</span><span class="inline-wrap"><code>push</code></span><span class="inline-wrap">指令将其推入栈。接下来，我们使用</span><span class="inline-wrap"><code>call</code></span><span class="inline-wrap">指令调用</span><span class="inline-wrap"><code>add_numbers</code></span><span class="inline-wrap">函数。在函数内部，我们使用</span><span class="inline-wrap"><code>mov</code></span><span class="inline-wrap">指令将栈中的参数加载到寄存器<span class="jill"></span>ebx<span class="jill"></span>和<span class="jill"></span>ecx<span class="jill"></span>中，并使用</span><span class="inline-wrap"><code>add</code></span><span class="inline-wrap">指令将它们相加。最后，我们使用</span><span class="inline-wrap"><code>ret</code></span><span class="inline-wrap">指令返回到调用者。</span></div></div><div id="aNV5gUhnDNLyCaH53CoDSA" class="wolai-block wolai-text"><div><span class="inline-wrap">在函数返回后，我们需要清理栈上推入的参数，以确保栈指针恢复到正确的位置。在示例中，我们使用</span><span class="inline-wrap"><code>add</code></span><span class="inline-wrap">指令将栈指针<span class="jill"></span>esp<span class="jill"></span>增加<span class="jill"></span>8<span class="jill"></span>个字节，以清理两个参数（每个参数占<span class="jill"></span>4<span class="jill"></span>个字节）。最后，我们执行系统调用来终止程序。</span></div></div><div id="8q3Mv5ZzxRb2qX1tyEoKBi" class="wolai-block wolai-text"><div><span class="inline-wrap">需要注意的是，不同的汇编语言和架构可能有不同的参数传递约定和调用约定。上述示例是基于<span class="jill"></span>x86<span class="jill"></span>架构和<span class="jill"></span>Linux<span class="jill"></span>操作系统的示例。在其他情况下，可能会使用不同的寄存器或栈结构来传递参数。因此，在编写汇编代码时，应该根据目标平台和约定进行适当的调整。</span></div></div></details></h1><h1 id="9EPJnaiooBZGuMafymyEiq" class="wolai-block"><span class="inline-wrap">占位</span><details id="cushKXwZ37iqmFiSfEVx9" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">nop</span></summary><div id="uSaZA8Wu8BHeKjts4MiSuB" class="wolai-block wolai-text"><div><span class="inline-wrap">作用：为了填充指令序列或者用作占位符，以保持程序的结构或满足特定的要求。循环中插入<span class="jill"></span>nop<span class="jill"></span>指令以延迟循环的执行。</span></div></div></details></h1><h1 id="c1TnrHVtZssTN1acZy5KL8" class="wolai-block"><span class="inline-wrap">IO<span class="jill"></span>端口</span><details id="pwioQgixhmQLGHHG8osDmH" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">insb（从<span class="jill"></span>IO<span class="jill"></span>端口读取数据</span><span class="inline-wrap">）</span></summary><details id="cNQz4kXmazv2349fBATMmv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">作用</span></summary><div id="4vqrZhzQUZeTpiNnkdj9VA" class="wolai-block wolai-text"><div><span class="inline-wrap">用于从<span class="jill"></span>I/O<span class="jill"></span>端口读取一个字节数据，并将其存储到<span class="jill"></span>ES<span class="jill"></span>段寄存器指向的内存地址中。</span></div></div></details><details id="pzysfB8UMTMSv4DSqmV9M6" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">示例代码</span></summary><div id="wuLXbXHJCPWFog8WEuxZ5H" class="wolai-block wolai-text"><div><span class="inline-wrap">是从<span class="jill"></span>DX<span class="jill"></span>指定的<span class="jill"></span>I/O<span class="jill"></span>端口读取一个字节的数据，并将其存储到<span class="jill"></span>ES:DI<span class="jill"></span>指定的内存地址中。该指令用于输入字符串操作，常用于从设备读取数据或接收输入。</span></div></div><code-block id="mtqE4Yz1SMPidVH3sgudAn" class="wolai-block"><div class="wolai-pre"><div data-lang="6502 Assembly" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">insb byte ptr es<span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span><span class="token punctuation">,</span> dx

<span class="token punctuation">;</span> insb：表示输入字符串（Input <span class="token known-class-name class-name">String</span>），从<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span>端口读取数据。
<span class="token punctuation">;</span> byte ptr：表示操作数的大小为一个字节。
<span class="token punctuation">;</span> es<span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span>：表示目标内存地址，其中<span class="token constant">ES</span>段寄存器存储段基址，<span class="token constant">DI</span><span class="token literal-property property">寄存器存储偏移地址。因此，es</span><span class="token operator">:</span><span class="token punctuation">[</span>di<span class="token punctuation">]</span>表示通过<span class="token constant">ES</span><span class="token operator">:</span><span class="token constant">DI</span>提供的内存地址。
<span class="token punctuation">;</span> dx：表示源<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span>端口的地址，其中<span class="token constant">DX</span>寄存器存储<span class="token constant">I</span><span class="token operator">/</span><span class="token constant">O</span>端口的地址。
</pre></div></code-block></details><div id="ddrg1foJyDi94Uj6QymHrg" class="wolai-block wolai-text"><div></div></div></details><details id="6nCoP2rmUFtadro3UfefNo" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">outsw（从<span class="jill"></span>CPU<span class="jill"></span>到<span class="jill"></span>I/O<span class="jill"></span>端口</span><span class="inline-wrap">）</span></summary><details id="esvvwc9KepYWn1zC2CuRvw" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><div id="bkLQW4KHth44DBEk2QkNs1" class="wolai-block wolai-text"><div><span class="inline-wrap">用于将字符串数据从<span class="jill"></span>CPU<span class="jill"></span>的数据段（DS:ESI）复制到由<span class="jill"></span>DX<span class="jill"></span>寄存器指定的<span class="jill"></span>I/O<span class="jill"></span>端口。
outs`指令将从内存中指定的源操作数地址开始的连续字数据复制到由<span class="jill"></span>DX<span class="jill"></span>寄存器中指定的<span class="jill"></span>I/O<span class="jill"></span>端口。每个字节数据都会被依次输出到<span class="jill"></span>I/O<span class="jill"></span>端口，并且<span class="jill"></span>DX<span class="jill"></span>的值会自动递增，以便指向下一个<span class="jill"></span>I/O<span class="jill"></span>端口。</span></div></div></details><details id="bNjftkov5qihDdqNeY91ms" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式</span></summary><code-block id="8XR7joWctXuVTpkbKJcLXp" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">outsw</pre></div></code-block></details><details id="pvFYuAQhCmmPmFp5kdxRex" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">注意</span></summary><div id="mxM4XzF6sECHCGufvRHsyk" class="wolai-block wolai-text"><div><span class="inline-wrap">只能用于特权级为<span class="jill"></span>0<span class="jill"></span>的程序或内核代码中，因为它涉及到与<span class="jill"></span>I/O<span class="jill"></span>设备的直接交互，而这通常需要操作系统或内核的特权级别。</span></div></div></details></details></h1><div id="qGmsp7EKouKhhR5FUavp8g" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>