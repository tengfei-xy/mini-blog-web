<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>安装 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="安装" class="main-title"></div></div></header><article><details id="kGSFnTV4HTq4nWdxct8Ybj" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">安装<span class="jill"></span>containerd</span></summary><div id="en52pMbNXnP9UJX5sq36Yj" class="wolai-block wolai-text"><div><span class="inline-wrap">下载</span></div></div><code-block id="phEBxiWu61nGrw55ZRqu5" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">wget</span> https://github.com/containerd/containerd/releases/download/v1.7.12/containerd-1.7.12-linux-amd64.tar.gz</pre></div></code-block><div id="a4wFQW7s1SRfWH8qAuNKe9" class="wolai-block wolai-text"><div><span class="inline-wrap">安装位置</span></div></div><code-block id="4xaQJfsiuUYXiUa3XzKc2J" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token assign-left variable">install_path</span><span class="token operator">=</span>/usr/local/service/containerd-1.7.12
</pre></div></code-block><div id="hU5m99PNETvSgVQtCDTeR2" class="wolai-block wolai-text"><div><span class="inline-wrap">解压</span></div></div><code-block id="ap4SS6hKBCz6wLZzbJL6bu" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">tar</span> xf containerd-1.7.12-linux-amd64.tar.gz <span class="token parameter variable">-C</span> <span class="token string">"<span class="token variable">${install_path}</span>"</span></pre></div></code-block><div id="oEe9eGyCq2JjDG8bKNJbUD" class="wolai-block wolai-text"><div><span class="inline-wrap">添加配置文件</span></div></div><code-block id="td9kAdveACDrgmrBmvhXh7" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token builtin class-name">echo</span> <span class="token string">'[plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
  [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc.options]
    SystemdCgroup = true'</span> <span class="token operator">></span> <span class="token string">"<span class="token variable">$install_path</span>"</span>/containerd.toml</pre></div></code-block><div id="2DcBGuDp6ACGNuMdkJ6zJC" class="wolai-block wolai-text"><div><span class="inline-wrap">添加配置文件</span><span class="inline-wrap"><code>containerd.service</code></span></div></div><code-block id="hprinjby63krRnRxB47Aem" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token builtin class-name">echo</span> <span class="token string">"
# Copyright The containerd Authors.
#
# Licensed under the Apache License, Version 2.0 (the "</span>License<span class="token string">");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "</span>AS IS<span class="token string">" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

[Unit]
Description=containerd container runtime
Documentation=https://containerd.io
After=network.target local-fs.target

[Service]
ExecStartPre=-/sbin/modprobe overlay
ExecStart=<span class="token variable">${install_path}</span>/bin/containerd --config <span class="token variable">${install_path}</span>/containerd.toml

Type=notify
Delegate=yes
KillMode=process
Restart=always
RestartSec=5

# Having non-zero Limit*s causes performance problems due to accounting overhead
# in the kernel. We recommend using cgroups to do container-local accounting.
LimitNPROC=infinity
LimitCORE=infinity

# Comment TasksMax if your systemd version does not supports it.
# Only systemd 226 and above support this version.
TasksMax=infinity
OOMScoreAdjust=-999

[Install]
WantedBy=multi-user.target
"</span> <span class="token operator">></span> /usr/lib/systemd/system/containerd.service</pre></div></code-block><div id="kra3ExhLtx2FECsj63nBJv" class="wolai-block wolai-text"><div><span class="inline-wrap">启动服务</span></div></div><code-block id="63v8LMk7oSmyN1AjUqXxZm" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">systemctl daemon-reload
systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> containerd</pre></div></code-block></details><details id="3aikTsCfLhwmdCrL5o63Kt" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">安装</span><span class="inline-wrap">runc</span></summary><div id="nKm1cYR1c2JdnvD99y82Tn" class="wolai-block wolai-text"><div><span class="inline-wrap">下载</span></div></div><code-block id="sXejXLb5psUFY8ZuLqtMdq" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">wget</span> https://github.com/opencontainers/runc/releases/download/v1.1.11/runc.amd64</pre></div></code-block><div id="8BW1aajYNVksytuHpC446Q" class="wolai-block wolai-text"><div><span class="inline-wrap">安装</span></div></div><code-block id="hqrR8giMkGVSRnuxPaG6QN" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">install</span> <span class="token parameter variable">-m</span> <span class="token number">755</span> runc.amd64 /usr/local/sbin/runc</pre></div></code-block></details><details id="x9ygbXWhpu9wbHdddvSSX2" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">安装<span class="jill"></span>CNI<span class="jill"></span>插件</span></summary><div id="mCGs2EmWXzqxzxmviPyQmE" class="wolai-block wolai-text"><div><span class="inline-wrap">下载</span></div></div><code-block id="kfJR838kyKRW9YHfZsnQqc" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">wget</span> https://github.com/containernetworking/plugins/releases/download/v1.4.0/cni-plugins-linux-amd64-v1.4.0.tgz</pre></div></code-block><div id="u42QnBYZ3Gr2AkLYHMaBL2" class="wolai-block wolai-text"><div><span class="inline-wrap">设定安装目录</span></div></div><code-block id="rhBvE7584gjRvc8ZdPZmdg" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token assign-left variable">containerd_home</span><span class="token operator">=</span>/usr/local/service/containerd-1.7.12
<span class="token assign-left variable">cni_home</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${containerd_home}</span>"</span>/cni
<span class="token function">mkdir</span> <span class="token string">"<span class="token variable">${cni_home}</span>"</span></pre></div></code-block><div id="ioxbp6yuRHcPJXFb2ycJYT" class="wolai-block wolai-text"><div><span class="inline-wrap">添加到<span class="jill"></span>PATH<span class="jill"></span>环境变量</span></div></div><code-block id="4xVCmZ6UWwNn4nLBVVWKQy" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
<span class="token assign-left variable">containerd_home</span><span class="token operator">=</span>/usr/local/service/containerd-1.7.12
<span class="token assign-left variable">cni_home</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${containerd_home}</span>"</span>/cni
<span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$containerd_home</span>/bin:<span class="token variable">$cni_home</span>
<span class="token builtin class-name">export</span> <span class="token environment constant">PATH</span></pre></div></code-block></details><div id="mTVnAzr6ewovZefVHDdLjb" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>