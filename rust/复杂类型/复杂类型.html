<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../css/wolai.css"/><title>复杂类型 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="复杂类型" class="main-title"></div></div></header><article><details id="oqyhnv4ykSMpneD6DPQMay" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><a href="https://rustwiki.org/zh-CN/std/string/struct.String.htm"><span>String（标准库）</span></a></span></summary><div id="hn1kw1hA1R3RGmidmq4cUU" class="wolai-block wolai-text"><div><span class="blue inline-wrap">定义：</span><span class="inline-wrap">是复杂类型，由存储在栈中的堆指针、字符串长度、字符串容量，</span><span class="red inline-wrap">拥有所有权</span><span class="inline-wrap">。</span></div></div><div id="wUQjTD7gvMGXQbXeWGSvQ1" class="wolai-block wolai-text"><div><span class="blue inline-wrap">性质：</span><span class="inline-wrap">但是 </span><span class="inline-wrap"><code>String</code></span><span class="inline-wrap"> 则是一个可增长、可改变且具有所有权的 UTF-8 编码字符串</span></div></div><div id="ueHsY1oSpkcZgBzG6eDb4S" class="wolai-block wolai-text"><div><span class="blue inline-wrap">原理：</span><span class="inline-wrap">在程序运行时，在堆上分配一块在编译时未知大小的内存来存放内容</span></div></div><details id="vq2aNcKKcYE7prSFFsKooG" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">声明</span></summary><code-block id="uCf1jWVxJ8aKJ8BWPyhUYz" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="nSyu3ZfmER9nwdUJLJmqBU" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">索引</span></summary><div id="6VJfMWoQ4bGBQJ4GtWkReW" class="wolai-block wolai-text"><div><span class="inline-wrap">不允许被索引，因为</span><span class="inline-wrap"><code>String</code></span><span class="inline-wrap">是<span class="jill"></span>UTF-8<span class="jill"></span>字符数组，每个<span class="jill"></span>UTF-8<span class="jill"></span>字符是三个字节。仅仅只能转换为字节数组来通过索引访问</span></div></div><code-block id="abWMoDbTiD4PrL78UK6VPU" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Hello, Rust!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> bytes <span class="token operator">=</span> my_string<span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 访问第一个字符</span>
<span class="token keyword">let</span> first_byte <span class="token operator">=</span> bytes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></div></code-block><div id="bvBCzkAJQu4FoUbtNe3CRJ" class="wolai-block wolai-text"><div><span class="inline-wrap">或使用切片的方式反问，但是切片的起始和结束要落在字符的边界处</span></div></div><code-block id="8ysiaJmefUuPHfjRqXRaLG" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hi,中国"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> h <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 修改当前行来修复错误，提示: `h` 字符在 UTF-8 格式中只需要 1 个字节来表示</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> h1 <span class="token operator">=</span> <span class="token operator">&amp;</span>s1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">..</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 修改当前行来修复错误，提示: `中` 字符在 UTF-8 格式中需要 3 个字节来表示</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>h1<span class="token punctuation">,</span> <span class="token string">"中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="3V3qG4AvXXzfNQ68398DWs" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">添加</span></summary><details id="urLL51hTzkSXa5K7TGHDAs" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">指定位置插入</span></summary><div id="fmfxR5VS1sLao3KCLt3q4B" class="wolai-block wolai-text"><div><span class="inline-wrap">可以使用 </span><span class="inline-wrap"><code>insert()</code></span><span class="inline-wrap"> 方法插入单个字符 </span><span class="inline-wrap"><code>char</code></span><span class="inline-wrap">，也可以使用 </span><span class="inline-wrap"><code>insert_str()</code></span><span class="inline-wrap"> 方法插入字符串字面量，与 </span><span class="inline-wrap"><code>push()</code></span><span class="inline-wrap"> 方法不同，这俩方法需要传入两个参数，第一个参数是字符（串）插入位置的索引，第二个参数是要插入的字符（串），索引从 0 开始计数，如果越界则会发生错误。由于字符串插入操作要</span><span class="inline-wrap"><b>修改原来的字符串</b></span><span class="inline-wrap">，则该字符串必须是可变的，即</span><span class="inline-wrap"><b>字符串变量必须由 </b></span><span class="inline-wrap"><b><code>mut</code></b></span><span class="inline-wrap"><b> 关键字修饰</b></span><span class="inline-wrap">。</span></div></div><div id="6xByeef3kBYXb6CC11EP2B" class="wolai-block wolai-text"><div><span class="inline-wrap">示例代码如下：</span></div></div><code-block id="aDZ7EMMMtCeW6zMmBdkSXu" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Hello rust!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"插入字符 insert() -> {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token function">insert_str</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">" I like"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"插入字符串 insert_str() -> {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 运行结果</span>
<span class="token comment">// 插入字符 insert() -> Hello, rust!</span>
<span class="token comment">// 插入字符串 insert_str() -> Hello, I like rust!</span>
</pre></div></code-block></details><details id="6ELFPoXLo8eMPkd85f7QLK" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">尾部追加</span></summary><div id="tgZuSaCzLaRpvfjhKSuyM3" class="wolai-block wolai-text"><div><span class="inline-wrap">在字符串尾部可以使用 </span><span class="inline-wrap"><code>push()</code></span><span class="inline-wrap"> 方法追加字符 </span><span class="inline-wrap"><code>char</code></span><span class="inline-wrap">，也可以使用 </span><span class="inline-wrap"><code>push_str()</code></span><span class="inline-wrap"> 方法追加字符串字面量。这两个方法都是</span><span class="inline-wrap"><b>在原有的字符串上追加，并不会返回新的字符串</b></span><span class="inline-wrap">。由于字符串追加操作要修改原来的字符串，则该字符串必须是可变的，即</span><span class="inline-wrap"><b>字符串变量必须由 </b></span><span class="inline-wrap"><b><code>mut</code></b></span><span class="inline-wrap"><b> 关键字修饰</b></span><span class="inline-wrap">。</span></div></div><div id="9QuhioNX8vG3gvmrupDsFn" class="wolai-block wolai-text"><div><span class="inline-wrap">示例代码如下：</span></div></div><code-block id="ugoz18cwPopvwZBLMbGGwq" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"Hello "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">"rust"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"追加字符串 push_str() -> {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char">'!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"追加字符 push() -> {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 代码运行结果：</span>
<span class="token comment">// 追加字符串 push_str() -> Hello rust</span>
<span class="token comment">// 追加字符 push() -> Hello rust!</span></pre></div></code-block></details></details><details id="dJf81qBgQTJ14Me1AFGsRM" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><a href="https://course.rs/basic/compound-type/string-slice.html#替换-replace"><span>替换</span></a></span></summary></details><details id="rAVQxfzTnJmg6xWnGoVskQ" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><a href="https://course.rs/basic/compound-type/string-slice.html#删除-delete"><span>删除</span></a></span></summary></details><details id="woXR6ynLFXxqCsJZCG8ep5" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><a href="https://course.rs/basic/compound-type/string-slice.html#连接-concatenate"><span>连接</span></a></span></summary></details><details id="foAC4ZPKY4XMUYewz36Qov" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><a href="https://course.rs/basic/compound-type/string-slice.html#字符串转义"><span>转义</span></a></span></summary><details id="dZA5umkoRPzscWCd6QHNKT" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">在字符串中使用<span class="jill"></span>Unicode<span class="jill"></span>形式的转义字符</span></summary><code-block id="vcJaFa2jh2wpAxCZLgvq2w" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> unicode_codepoint <span class="token operator">=</span> <span class="token string">"\u{211D}"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> character_name <span class="token operator">=</span> <span class="token string">"\"DOUBLE-STRUCK CAPITAL R\""</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="qy3NkphFn5KoCkfFWzCVaR" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">在字符串中使用</span><span class="inline-wrap"><code>&quot;&quot;</code></span></summary><code-block id="i549Bg3fsjNNDwnuYocyhS" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> quotes <span class="token operator">=</span> <span class="token string">r#"And then I said: "There is no escape!""#</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> quotes<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="kVzVbmT5uCeGNhuYPkKX78" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">在字符串中使用</span><span class="inline-wrap"><code>#</code></span></summary><code-block id="37JymkT7G1CAr4rszvFNnS" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span>  delimiter <span class="token operator">=</span> <span class="token string">r###"A string with "# in it. And even "##!"###</span><span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> delimiter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details></details><details id="wFNZvHXMTLbmr59NqEUYKj" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">遍历字符</span></summary><code-block id="sJ6gAUHGgD77GtxBeUSk5R" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"中国人"</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="uaheMgwSUvAnfCZQtFNEVr" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">遍历字节</span></summary><code-block id="dNDCu5vvKKSn3uzDS6Bqzw" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token string">"中国人"</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="rik7FDbFkfWYPmW5cSDuS4" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">获取子串</span></summary><div id="3Gm76F1wHsFtGyfQYu1Ndf" class="wolai-block wolai-text"><div><span class="inline-wrap">想要准确的从 UTF-8 字符串中获取子串是较为复杂的事情，例如想要从 </span><span class="inline-wrap"><code>holla<span class="jill"></span>中国人नमस्ते</code></span><span class="inline-wrap"> 这种变长的字符串中取出某一个子串，使用标准库你是做不到的。 你需要在 </span><span class="inline-wrap"><code>crates.io</code></span><span class="inline-wrap"> 上搜索 </span><span class="inline-wrap"><code>utf8</code></span><span class="inline-wrap"> 来寻找想要的功能。</span></div></div><div id="twaKvCGF4KschMJxbiby7D" class="wolai-block wolai-text"><div><span class="inline-wrap">可以考虑尝试下这个库：</span><span class="inline-wrap"><a href="https://crates.io/crates/utf8_slice"><span>utf8_slice</span></a></span><span class="inline-wrap">。</span></div></div><code-block id="3N6ytZeshrMdWcMLeagDjz" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">use</span> utf8_slice<span class="token punctuation">;</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">"The 🚀 goes to the 🌑!"</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> rocket <span class="token operator">=</span> <span class="token namespace">utf8_slice<span class="token punctuation">::</span></span><span class="token function">slice</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 结果是 "🚀"</span>
<span class="token punctuation">}</span>
</pre></div></code-block></details><div class="block-ref"><div class="decorator"></div><details id="9ZErDoPp6xD6uxLTTHvRAL" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">类型转换</span></summary><details id="j5GS6XAsSViCzSqPYxNWvG" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>&amp;str</code></span><span class="inline-wrap"> → </span><span class="inline-wrap"><code>String</code></span></summary><code-block id="khCsmn8i1jSLvRj6ahrU5m" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment">// 方法一</span>
<span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,world"</span><span class="token punctuation">)</span>
<span class="token comment">// 方法二</span>
<span class="token string">"hello,world"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></div></code-block></details><details id="dQrc4Aig2zPHUuwRDajXUY" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>String</code></span><span class="inline-wrap"> → </span><span class="inline-wrap"><code>&amp;str</code></span></summary><code-block id="mm782bWgojHXFKpuf2FP1D" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello,world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">say_hello</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">say_hello</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">[</span><span class="token punctuation">..</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">say_hello</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">as_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">say_hello</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="czHdgxCTQYcB2HaC57Dj1p" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap"><code>Vec&lt;u8</code></span><span class="inline-wrap"> → </span><span class="inline-wrap"><code>String</code></span></summary><div id="eALxsHKXkBgVssszUpMz5g" class="wolai-block wolai-text"><div><span class="inline-wrap"><code>String::from_utf8()</code></span><span class="inline-wrap"> 函数将 Vec&lt;u8&gt; 转换为 String，如果转换成功，则返回一个 String 类型的值，如果转换失败，则返回一个 Result&lt;String, Error&gt; 类型的值。</span></div></div><code-block id="c8336BHPZJdLxHBvdwaQVH" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> bytes <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from_utf8</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div></code-block></details></details></div><details id="s1sCi7RZu48L3C2NGnPrCk" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">克隆 / 深拷贝</span></summary><aside id="3JmnJFxVeJmCXDf9QSS3mk" class="bg-cultured wolai-block"><div data-symbol="📌" class="icon"></div><span class="inline-wrap">Rust 永远也不会自动创建数据的 “深拷贝”</span></aside><div id="oiRAMcjSmbJkAax5LyQA1Z" class="wolai-block wolai-text"><div><span class="inline-wrap">示例</span></div></div><code-block id="bQHTKmZDyyYRvJyRqBMRbY" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"s1 = {}, s2 = {}"</span><span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="5EeRmLiwEPyL7SEN9vFPHC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">获取字节长度</span></summary><code-block id="9UdRqL6kqQnQ41CVr4WoGd" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建了一个包含三个字符的字符串，其中一个字符是 Unicode 字符 "ƒ"（一个拉丁小写字母 f 带有一个附加的标记），它的 UTF-8 编码占用了两个字节，</span>
<span class="token keyword">let</span> fancy_f <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"ƒoo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>fancy_f<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>fancy_f<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="b8nVUmt693Fpdwu2KsjG9L" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">获取字符长度</span></summary><code-block id="m45EA7DiAkosgrwKvZRtmo" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> my_string <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"你好, Rust!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> num_chars <span class="token operator">=</span> my_string<span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"字符串字符数: {}"</span><span class="token punctuation">,</span> num_chars<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="mVRc7fsdgpt3o8Tzcp12EW" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">格式转换</span></summary><code-block id="naDyM2AAmo8xNEZW5hWcd8" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> <span class="token class-name">B</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"8589934592"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token constant">GB</span> <span class="token operator">=</span> <span class="token punctuation">(</span>size<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token keyword">f64</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024.0</span> <span class="token operator">/</span> <span class="token number">1024.0</span><span class="token operator">/</span> <span class="token number">1024.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token keyword">i32</span><span class="token punctuation">;</span></pre></div></code-block></details><details id="dVF9CXdGJDy9HuDqP51XHC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">正则表达式匹配</span></summary><div id="oZ5Xxo9kXzUsBA1XygFs5a" class="wolai-block wolai-text"><div><span class="inline-wrap">添加<span class="jill"></span>regex<span class="jill"></span>库</span></div></div><code-block id="6vHEFDxcJq7yxQasykrjQb" class="wolai-block"><div class="wolai-pre"><div data-lang="Bash" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token function">cargo</span> <span class="token function">add</span> regex</pre></div></code-block><details id="eDN3XC9UhKAL6ybZChW4HN" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">匹配示例</span></summary><code-block id="6y5mrg7eoH8UZtasHDp3yo" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">use</span> <span class="token namespace">regex<span class="token punctuation">::</span></span><span class="token class-name">Regex</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> text <span class="token operator">=</span> <span class="token string">"https://www.elastic.co/guide/en/elasticsearch/reference/8.7/release-notes-"</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> re <span class="token operator">=</span> <span class="token class-name">Regex</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">r"https://www\.elastic\.co/guide/en/elasticsearch/reference/\d+\.\d+/release-notes-"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> re<span class="token punctuation">.</span><span class="token function">is_match</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Matched!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Not matched!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="6cWkNo9c5AZJY1kjaMJQww" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"></span><br/></summary></details></details></details><details id="qXUofAY78pWnoidF2BwnyN" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">元组</span></summary><div id="54s4SApm73htSaf1VByPA9" class="wolai-block wolai-text"><div><span class="blue inline-wrap">特点：</span><span class="inline-wrap">长度、顺序是固定的。</span></div></div><div id="eGUAArw8tsU533PoaedpqJ" class="wolai-block wolai-text"><div><span class="inline-wrap">声明：</span></div></div><code-block id="sD9mFBewQ8vqjQQp5WpBfn" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> tup<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div></code-block><div id="RRvLGcE5noiRbm1ci4er8" class="wolai-block wolai-text"><div><span class="inline-wrap">解构：</span></div></div><code-block id="eK8FrhL8rMPcuHgJRuEuQh" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> tup <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token operator">=</span> tup<span class="token punctuation">;</span>
<span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"The value of y is: {}"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><div id="uKPHbt6h9MkMvZ4X1zdQDA" class="wolai-block wolai-text"><div><span class="inline-wrap">访问元组的元素</span></div></div><code-block id="jQdiFEp92WCNXqxwP59FbQ" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> <span class="token keyword">u8</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">6.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> five_hundred <span class="token operator">=</span> x<span class="token number">.0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> six_point_four <span class="token operator">=</span> x<span class="token number">.1</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> one <span class="token operator">=</span> x<span class="token number">.2</span><span class="token punctuation">;</span></pre></div></code-block><details id="j9EbePYuSakCU7SqnTJvrx" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">在函数中匹配元组</span></summary><code-block id="9ryNBQh4hkN6FBAYNnX2s8" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token keyword">fn</span> <span class="token function-definition function">print_coordinates</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Current location: ({}, {})"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_coordinates</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></code-block></details><details id="ohy2Z95esH2aEqrSmYjLMF" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">带<span class="jill"></span>mut<span class="jill"></span>和数据类型的</span></summary><code-block id="aNT8p4QskZ3mAk6xT15rF9" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">fn</span> <span class="token function-definition function">elasticsearch_bug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">-></span> <span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">,</span><span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">elasticsearch_code</span><span class="token punctuation">(</span>s <span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">,</span> h<span class="token punctuation">:</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// </span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">mut</span> retval<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=</span> 
<span class="token function">elasticsearch_code</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> retval<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
</pre></div></code-block></details></details><details id="nwWjxaoy7khGsoRwrimrRW" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">结构体</span></summary><details id="nup2a5cxsReVMTAeUiRh98" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">一般结构体</span></summary><details id="3kcZGV42FiFrRQLQ9jM9zj" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">说明</span></summary><details id="qQUYTsyYGNGMxcp31y6rXY" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">内存排列</span></summary><div id="gZbBRLPDHb6GPbpNZcb3JZ" class="wolai-block wolai-text"><div><span class="inline-wrap">从图中可以清晰地看出 </span><span class="inline-wrap"><code>File</code></span><span class="inline-wrap"> 结构体两个字段 </span><span class="inline-wrap"><code>name</code></span><span class="inline-wrap"> 和 </span><span class="inline-wrap"><code>data</code></span><span class="inline-wrap"> 分别拥有底层两个 </span><span class="inline-wrap"><code>[u8]</code></span><span class="inline-wrap"> 数组的所有权(</span><span class="inline-wrap"><code>String</code></span><span class="inline-wrap"> 类型的底层也是 </span><span class="inline-wrap"><code>[u8]</code></span><span class="inline-wrap"> 数组)，通过 </span><span class="inline-wrap"><code>ptr</code></span><span class="inline-wrap"> 指针指向底层数组的内存地址，这里你可以把 </span><span class="inline-wrap"><code>ptr</code></span><span class="inline-wrap"> 指针理解为 Rust 中的引用类型。</span></div></div><div id="cA7MUDcsNnEwQGuLJKyS78" class="wolai-block wolai-text"><div><span class="inline-wrap">该图片也侧面印证了：</span><span class="inline-wrap"><b>把结构体中具有所有权的字段转移出去后，将无法再访问该字段，但是可以正常访问其它的字段</b></span><span class="inline-wrap">。</span></div></div><div id="9K7BgJWuNtnTjRBXz875um" class="wolai-block"><figure class="wolai-left" style="width: 444px; flex-direction: column"><img src="https://pic3.zhimg.com/80/v2-8cc4ed8cd06d60f974d06ca2199b8df5_1440w.png" style="width: 100%"/></figure></div></details></details><details id="ikdK5zQkQgpMwiNxxdDUyp" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">定义</span></summary><details id="mdXTiTh3Q2zgcETEHWy25X" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">一般示例</span></summary><code-block id="xnzMPDubzWfmWTTu614pd1" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment">// 声明</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{</span>
    active<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    sign_in_count<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 注意:</span>
<span class="token comment">// 初始化实例时，每个字段都需要进行初始化</span>
<span class="token comment">// 初始化时的字段顺序不需要和结构体定义时的顺序一致</span>
    <span class="token keyword">let</span> user1 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someone@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someusername123"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 简化创建</span>
<span class="token keyword">fn</span> <span class="token function-definition function">build_user</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> email<span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 再简化</span>
<span class="token keyword">fn</span> <span class="token function-definition function">build_user</span><span class="token punctuation">(</span>email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span> username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">,</span>
        username<span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></div></code-block></details><details id="xnHUJkg5ZBXSFpqBq3ro6i" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">包含引用类型时</span></summary><div id="34nu7q2u2EuneQ51MZQxSt" class="wolai-block wolai-text"><div><span class="inline-wrap">此时需要</span><span class="inline-wrap"><a href="https://course.rs/basic/lifetime.html"><span>生命周期</span></a></span></div></div><code-block id="7EkdZ1a8bCDByBGyEdzuju" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">{</span>
    <span class="token comment">// 代码错误</span>
    username<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">,</span>
    sign_in_count<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span>
    active<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> user1 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> <span class="token string">"someone@example.com"</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token string">"someusername123"</span><span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details></details><details id="fXV3bhr7BhGYzwh9BY9mdv" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">访问字段</span></summary><code-block id="dCCcUuUyB9t7fufjJQ5XLH" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token comment">// 注意:</span>
<span class="token comment">// 必须要将结构体实例声明为可变的，才能修改其中的字段。</span>
<span class="token comment">// Rust 不支持将某个结构体某个字段标记为可变。</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> user1 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someone@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"someusername123"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        active<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    user1<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"anotheremail@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div></code-block></details><details id="4fuZcH6CbPCCajEbvm9KHu" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">更新（创建根据已有的结构体</span><span class="inline-wrap">）</span></summary><code-block id="i7q6FL37FnhdCeEiQR1rx8" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">  <span class="token keyword">let</span> user2 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        active<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>active<span class="token punctuation">,</span>
        username<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"another@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        sign_in_count<span class="token punctuation">:</span> user1<span class="token punctuation">.</span>sign_in_count<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
<span class="token comment">// 简化语法</span>
<span class="token comment">// 注意:</span>
<span class="token comment">// ..user1 必须在结构体的尾部使用。</span>
<span class="token comment">// 由于 username并没有实现COPY特征，所以会发生所有权转移</span>
<span class="token comment">// 而bool,u64实现了，所以发生了拷贝</span>
  <span class="token keyword">let</span> user2 <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
        email<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"another@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">..</span>user1
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre></div></code-block></details><details id="hN6VRXVrRa8wBparBPXyyF" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">人性化打印</span></summary><code-block id="mHws5p9if3qhuiR2dpB9Dg" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> rect1 <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
        width<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"rect1 is {:?}"</span><span class="token punctuation">,</span> rect1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="boGPb2MmVvZq3pfDsUfFLC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">绑定变量并解构</span></summary><code-block id="xfva65LuFpNgtf59yrQ9cP" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 绑定新变量 `p`，同时对 `Point` 进行解构</span>
    <span class="token keyword">let</span> p <span class="token operator">@</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> px<span class="token punctuation">,</span> y<span class="token punctuation">:</span> py <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"x: {}, y: {}"</span><span class="token punctuation">,</span> px<span class="token punctuation">,</span> py<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token keyword">let</span> p <span class="token operator">@</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">}</span> <span class="token operator">=</span> point <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"x is 10 and y is {} in {:?}"</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"x was not 10 :("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出结果</span>
<span class="token comment">// x: 10, y: 23</span>
<span class="token comment">// Point { x: 10, y: 23 }</span>
<span class="token comment">// x is 10 and y is 5 in Point { x: 10, y: 5 }</span>
</pre></div></code-block></details><details id="cZr9B8gMxjfLDpznEFdg88" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">实现</span><span class="inline-wrap"><code>Display</code></span><span class="inline-wrap">特征</span></summary><code-block id="knnja1w7jzodiNfoNsw3hQ" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">Person</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token keyword">u8</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>
<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>
            f<span class="token punctuation">,</span>
            <span class="token string">"大佬在上，请受我一拜，小弟姓名{}，年芳{}，家里无田又无车，生活苦哈哈"</span><span class="token punctuation">,</span>
            <span class="token keyword">self</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>age
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">"sunface"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details></details><details id="dpGWTZKEnEAEQfwScw5Chc" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">元组结构体</span></summary><div id="nSAGWPiT1rWon52wxxkrnb" class="wolai-block wolai-text"><div><span class="blue inline-wrap">用处：</span><span class="inline-wrap">希望有一个整体名称，但是不关心里面字段的名称</span></div></div><code-block id="uXdoKRXAq4wMCNb38cgntY" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">    <span class="token keyword">struct</span> <span class="token type-definition class-name">Color</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> black <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> origin <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></div></code-block><details id="a5bR5cpoj8kpTPXF4eh4DC" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">为元组实现<span class="jill"></span>Display<span class="jill"></span>特征</span></summary><code-block id="cLemtv2GSsGrCVpmFZCs8P" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">Array</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fmt<span class="token punctuation">;</span>
<span class="token keyword">impl</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token namespace">fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">"数组是：{:?}"</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details></details><details id="nzriK6CNxU2Kw4xBprBgoT" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">单元结构体</span></summary><div id="fDpYhfeZTyH445K1MoxhMX" class="wolai-block wolai-text"><div><span class="blue inline-wrap">用处：</span><span class="inline-wrap">当定义一个类型，但是不关心该类型的内容, 只关心它的行为时，就可以使用 </span><span class="inline-wrap"><code>单元结构体</code></span></div></div><div id="9T77KCLNHSFDWpgoccNLYs" class="wolai-block wolai-text"><div><span class="inline-wrap">示例</span></div></div><code-block id="bjWUi1Qr45ioak7J6A1Eqw" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">struct</span> <span class="token type-definition class-name">AlwaysEqual</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> subject <span class="token operator">=</span> <span class="token class-name">AlwaysEqual</span><span class="token punctuation">;</span>

<span class="token comment">// 我们不关心 AlwaysEqual 的字段数据，只关心它的行为，因此将它声明为单元结构体，然后再为它实现某个特征</span>
<span class="token keyword">impl</span> <span class="token class-name">SomeTrait</span> <span class="token keyword">for</span> <span class="token class-name">AlwaysEqual</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span></pre></div></code-block></details></details><details id="poUbsAhNTToqD89U1gRQpm" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">枚举</span></summary><div id="xhPchWfuPi2KGmCeCMmamJ" class="wolai-block wolai-text"><div><span class="blue inline-wrap">定义：</span><span class="inline-wrap">枚举类型是一个类型，它会包含所有可能的枚举成员, 而枚举值是该类型中的具体某个成员的实例。</span></div></div><div id="ky1JRUu3LBCjoS7PFPnqia" class="wolai-block wolai-text"><div><span class="blue inline-wrap">理解：</span><span class="inline-wrap">多个结构体选其一是枚举</span></div></div><details id="bdwaf8WTPGunjXTAprvGim" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">创建</span></summary><code-block id="xdS2sf7VLz9CxPVKdJiqHr" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token comment">// 声明</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">PokerSuit</span> <span class="token punctuation">{</span>
  <span class="token class-name">Clubs</span><span class="token punctuation">,</span>
  <span class="token class-name">Spades</span><span class="token punctuation">,</span>
  <span class="token class-name">Diamonds</span><span class="token punctuation">,</span>
  <span class="token class-name">Hearts</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>


<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建</span>
    <span class="token keyword">let</span> heart <span class="token operator">=</span> <span class="token class-name">PokerSuit</span><span class="token punctuation">::</span><span class="token class-name">Hearts</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> diamond <span class="token operator">=</span> <span class="token class-name">PokerSuit</span><span class="token punctuation">::</span><span class="token class-name">Diamonds</span><span class="token punctuation">;</span>

    <span class="token function">print_suit</span><span class="token punctuation">(</span>heart<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">print_suit</span><span class="token punctuation">(</span>diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 函数调用</span>
<span class="token keyword">fn</span> <span class="token function-definition function">print_suit</span><span class="token punctuation">(</span>card<span class="token punctuation">:</span> <span class="token class-name">PokerSuit</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"{:?}"</span><span class="token punctuation">,</span>card<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre></div></code-block></details><details id="hetFa6RDsE6fAAhYqhLVy5" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">枚举对于结构体</span></summary><div id="hoapmNjH8q8dGAnFz3S2vf" class="wolai-block wolai-text"><div><span class="inline-wrap">枚举创建</span></div></div><code-block id="9s66gzzUJvF9S9j7bETJ89" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token comment">// Quit 没有任何关联数据</span>
<span class="token comment">// Move 包含一个匿名结构体</span>
<span class="token comment">// Write 包含一个 String 字符串</span>
<span class="token comment">// ChangeColor 包含三个 i32</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Message</span> <span class="token punctuation">{</span>
    <span class="token class-name">Quit</span><span class="token punctuation">,</span>
    <span class="token class-name">Move</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token class-name">Write</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">ChangeColor</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> m1 <span class="token operator">=</span> <span class="token class-name">Message</span><span class="token punctuation">::</span><span class="token class-name">Quit</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> m2 <span class="token operator">=</span> <span class="token class-name">Message</span><span class="token punctuation">::</span><span class="token class-name">Move</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>y<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> m3 <span class="token operator">=</span> <span class="token class-name">Message</span><span class="token punctuation">::</span><span class="token class-name">ChangeColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block><div id="7hVBfpqxN45cVsTxomDDXn" class="wolai-block wolai-text"><div><span class="inline-wrap">结构体创建</span></div></div><code-block id="aEg3d4sQ2pyX3xK475bjq5" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">QuitMessage</span><span class="token punctuation">;</span> <span class="token comment">// 单元结构体</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">MoveMessage</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">WriteMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元组结构体</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">ChangeColorMessage</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 元组结构体</span></pre></div></code-block></details><details id="gGRQRecHgzaiQdfuLyKp4y" class="wolai-block"><summary><div class="marker placeholder"></div><span class="inline-wrap"><a href="https://course.rs/basic/compound-type/enum.html#option-枚举用于处理空值"><span>处理空值</span></a></span></summary></details><details id="riDDtLHC3RaNS63NJEYsWT" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">实现方法</span></summary><code-block id="6gga6pCx5SxjfYuEq7nhzv" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre><span class="token attribute attr-name">#![allow(unused)]</span>
<span class="token keyword">enum</span> <span class="token type-definition class-name">Message</span> <span class="token punctuation">{</span>
    <span class="token class-name">Quit</span><span class="token punctuation">,</span>
    <span class="token class-name">Move</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token class-name">Write</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">ChangeColor</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token keyword">i32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Message</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">call</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 在这里定义方法体</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token class-name">Message</span><span class="token punctuation">::</span><span class="token class-name">Write</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></pre></div></code-block></details><details id="8CPceRSEp6fPexyBMsRtLq" class="wolai-block"><summary><div class="marker"></div><span class="inline-wrap">判断等于（实现<span class="jill"></span>PariaEq<span class="jill"></span>特征）</span></summary><div id="v47T5ETWqCwe8ktpb33cwL" class="wolai-block wolai-text"><div><span class="inline-wrap">类型定义</span></div></div><code-block id="no3VJj6jDncSM2sqj3PYje" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">BusinessInfo</span> <span class="token punctuation">{</span>
    description<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
    category<span class="token punctuation">:</span> <span class="token class-name">BusinessType</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span>  <span class="token type-definition class-name">BusinessType</span><span class="token punctuation">{</span>
    <span class="token class-name">Free</span><span class="token punctuation">,</span>
    <span class="token class-name">Donation</span><span class="token punctuation">,</span>
    <span class="token class-name">WorthlessAdd</span><span class="token punctuation">,</span>
    <span class="token class-name">Paid</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> </pre></div></code-block><div id="55rDP5bLiLpRmhBo6mHjST" class="wolai-block wolai-text"><div><span class="inline-wrap">想想要实现</span><span class="inline-wrap"><code>v.category == BusinessType::Paid</code></span><span class="inline-wrap">,需要特征</span><span class="inline-wrap"><code>PartialEq</code></span></div></div><code-block id="4aAnn7BxjtDqdsEZwm3cTu" class="wolai-block"><div class="wolai-pre"><div data-lang="Rust" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token keyword">impl</span> <span class="token class-name">PartialEq</span> <span class="token keyword">for</span> <span class="token class-name">BusinessType</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">eq</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Free</span><span class="token punctuation">,</span> <span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Free</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Donation</span><span class="token punctuation">,</span> <span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Donation</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">WorthlessAdd</span><span class="token punctuation">,</span> <span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">WorthlessAdd</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Paid</span><span class="token punctuation">,</span> <span class="token class-name">BusinessType</span><span class="token punctuation">::</span><span class="token class-name">Paid</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            _ <span class="token operator">=></span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></div></code-block><div id="dMJzC43P8cnPhQNRHnyb8K" class="wolai-block wolai-text"><div><span class="inline-wrap">=</span></div></div></details></details><div id="oG98YqUhA5zcDKzchmrrMu" class="wolai-block wolai-text"><div></div></div></article><footer></footer></body></html>