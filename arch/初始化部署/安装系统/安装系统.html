<!DOCTYPE html>
<html lang="zh-Hans-CN"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><link rel="stylesheet" type="text/css" href="../../../css/modern-norm.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/prism.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/katex.min.css"/><link rel="stylesheet" type="text/css" href="../../../css/wolai.css"/><title>安装系统 - wolai 笔记</title><link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 800 800&apos;%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fff;%7D%3C/style%3E%3C/defs%3E%3Cg%3E%3Cpath class=&apos;cls-1&apos; d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Z&apos;/%3E%3Cpath d=&apos;M610.08,0c66,0,90,6.88,114.13,19.79a134.62,134.62,0,0,1,56,56l2.28,4.4C793.93,103,800,127.88,800,189.92V610.08l-.08,11.56c-.78,57.38-7.58,79.89-19.71,102.57a134.62,134.62,0,0,1-56,56l-4.4,2.28C697,793.93,672.12,800,610.08,800H189.92l-11.56-.08c-57.38-.78-79.89-7.58-102.57-19.71a134.62,134.62,0,0,1-56-56l-2.28-4.4C6.44,697.75.4,673.72,0,616L0,189.92c0-66,6.88-90,19.79-114.13a134.62,134.62,0,0,1,56-56l4.4-2.28C102.25,6.44,126.28.4,184,0Zm4.72,88.9H185.2L172.42,89c-32.78.62-43.68,3.24-54.71,9.14a45.84,45.84,0,0,0-19.54,19.54c-6.61,12.36-9.11,24.55-9.27,67.49V614.8L89,627.58c.62,32.78,3.24,43.68,9.14,54.71a45.84,45.84,0,0,0,19.54,19.54c12.36,6.61,24.55,9.11,67.49,9.27H610.08c46.79,0,59.41-2.44,72.21-9.28a45.84,45.84,0,0,0,19.54-19.54c6.61-12.36,9.11-24.55,9.27-67.49V189.92c0-46.79-2.44-59.41-9.28-72.21a45.84,45.84,0,0,0-19.54-19.54C669.93,91.56,657.74,89.06,614.8,88.9ZM233.33,493.33A73.34,73.34,0,1,1,160,566.67,73.35,73.35,0,0,1,233.33,493.33Z&apos;/%3E%3C/g%3E%3C/svg%3E"></link></head><body class="full-width small-font less-lead"><header><div class="image"></div><div class="title"><div class="banner"><div class="icon"></div></div><div data-title="安装系统" class="main-title"></div></div></header><article><div id="isJujgqQtj7KohEfS3axrs" class="wolai-block wolai-text"><div><span class="inline-wrap">参考</span><span class="inline-wrap"><a href="https://wiki.archlinux.org/title/Installation_guide"><span>官方文档</span></a></span></div></div><h1 id="shDTEjUK9ekZs1b9NMn2eL" class="wolai-block"><span class="inline-wrap">预安装</span></h1><h2 id="kBfnqbtkymHJaFSJCrK6X2" class="wolai-block"><span class="inline-wrap">检查网络</span></h2><ul class="wolai-block"><li id="1EDvHGANeBrxrSWJpEPjtX"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">WLAN 使用 </span><span class="inline-wrap"><a href="https://wiki.archlinux.org/title/Iwctl"><span>iwctl</span></a></span><span class="inline-wrap">.</span></li><li id="jEaYFR2WHSZbho8T7HojXd"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">Mobile broadband modem—使用 </span><span class="inline-wrap"><a href="https://wiki.archlinux.org/title/Mmcli"><span>mmcli</span></a></span></li></ul><div id="eXqxmbg1BjhATvGsD2AfHj" class="wolai-block wolai-text"><div><span class="inline-wrap">DHCP<span class="jill"></span>分配，需要<span class="jill"></span>systemd-networkd<span class="jill"></span>和<span class="jill"></span>systemd-resolved<span class="jill"></span>服务的启动</span></div></div><div id="kyW9uqU4pXhP4LysZDVgJm" class="wolai-block wolai-text"><div><span class="inline-wrap">静态配置，</span><span class="inline-wrap"><a href="https://wiki.archlinux.org/title/Network_configuration#Static_IP_address"><span>Network configuration#Static IP address</span></a></span></div></div><div id="hwrE9o35CxjNkLrhnKhJ38" class="wolai-block wolai-text"><div><span class="inline-wrap">测试网络</span></div></div><code-block id="3Be2kfUG4LSEv4hHKoYSBE" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">ping baidu<span class="token punctuation">.</span><span class="token property-access">com</span></pre></div></code-block><h2 id="d7kffCtTHv1qq9fL6KosQb" class="wolai-block"><span class="inline-wrap">更新系统时间</span></h2><div id="r4tyNHsQwTX8LmQ7p1S7Bb" class="wolai-block wolai-text"><div><span class="inline-wrap">查看当前时间</span></div></div><code-block id="vazPXS6K5Hs7Jo5j6Q9R55" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">timedatectl status</pre></div></code-block><div id="1da3Jc5PC9WptpD7ZKHhLc" class="wolai-block wolai-text"><div><span class="inline-wrap">更新为上海的时区</span></div></div><code-block id="x4EPoDoLRCR2p4X4A7USsL" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">timedatectl set<span class="token operator">-</span>timezone <span class="token maybe-class-name">Asia</span><span class="token operator">/</span><span class="token maybe-class-name">Shanghai</span></pre></div></code-block><h2 id="xaKTaHqHJaYENcukz7XPqU" class="wolai-block"><span class="inline-wrap">更新硬盘</span></h2><div id="uVQcKnX3KFZEu484sXUqew" class="wolai-block wolai-text"><div><span class="inline-wrap">通过进入硬盘分区模式</span></div></div><code-block id="ujUXAtudExQiw6vXhwJUxD" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">fdisk <span class="token operator">/</span>dev<span class="token operator">/</span>sda</pre></div></code-block><div id="xgDvYhCSUC2m8ypEMXevAj" class="wolai-block wolai-text"><div><span class="inline-wrap">g: 创建<span class="jill"></span>gpt<span class="jill"></span>分区</span></div></div><div id="9C1SzEDnhhM74x4tqn6Q43" class="wolai-block wolai-text"><div><span class="inline-wrap">t：修改分区类型</span></div></div><ul class="wolai-block"><li id="9wnCrAkcQQQELxwHhWZ1nF"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">1-EFI SYSTEM</span></li><li id="73tFrvNU1M9QVK4bs9g6tQ"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">19-Linuxswap</span></li><li id="d2x5xoN7s9SkE7sbVL53EH"><div class="marker"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 14.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path></svg></div><span class="inline-wrap">23-Linux root(x86-64)</span></li></ul><div id="bbSZo8ky37ceAsEB5VuX3D" class="wolai-block wolai-text"><div><span class="inline-wrap">格式化</span></div></div><code-block id="sbE9cCbohWigg9xbT4q1tG" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">mkfs<span class="token punctuation">.</span><span class="token property-access">ext4</span> <span class="token operator">/</span>dev<span class="token operator">/</span>root_partition
mkswap <span class="token operator">/</span>dev<span class="token operator">/</span>swap_partition

# 对于<span class="token constant">UEFI</span>的系统，需要把<span class="token operator">/</span>dev<span class="token operator">/</span>efi_system_partition格式化为fat32
mkfs<span class="token punctuation">.</span><span class="token property-access">fat</span> <span class="token operator">-</span><span class="token constant">F</span> <span class="token number">32</span> <span class="token operator">/</span>dev<span class="token operator">/</span>sda1</pre></div></code-block><div id="m9rT7ZUtjgWE2s4AzmF5Rc" class="wolai-block wolai-text"><div><span class="inline-wrap">挂载系统分区和<span class="jill"></span>EFI<span class="jill"></span>分区</span></div></div><code-block id="n386q6jTpFtPv5aiuKEDC8" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">mount <span class="token operator">/</span>dev<span class="token operator">/</span>sda3 <span class="token operator">/</span>mnt
mount <span class="token operator">--</span>mkdir <span class="token operator">/</span>dev<span class="token operator">/</span>efi_system_partition <span class="token operator">/</span>mnt<span class="token operator">/</span>boot</pre></div></code-block><div id="xuxexQxydmtvBPf2fWhGN9" class="wolai-block wolai-text"><div><span class="inline-wrap">启动<span class="jill"></span>swap<span class="jill"></span>分区</span></div></div><code-block id="kvZwjrmxEPr7tskoAvcgVj" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">swap on <span class="token operator">/</span>dev<span class="token operator">/</span>sda2</pre></div></code-block><h1 id="6JKFbZzBCqowouXcqZMwr2" class="wolai-block"><span class="inline-wrap">安装</span></h1><code-block id="nrd84A9GvJtcjkgiADkCjB" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token maybe-class-name">Server</span> <span class="token operator">=</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span><span class="token number">163</span><span class="token punctuation">.</span><span class="token property-access">com</span><span class="token operator">/</span>archlinux<span class="token operator">/</span>$repot<span class="token operator">/</span>os<span class="token operator">/</span>$arch</pre></div></code-block><code-block id="ugVLK98PeU4wq8zhJgR6Yv" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">pacman <span class="token operator">-</span><span class="token maybe-class-name">Syu</span> pacman<span class="token operator">-</span>mirrorlistY</pre></div></code-block><div id="rMpTJf7VeEjmXqSYLddkJ5" class="wolai-block wolai-text"><div><span class="inline-wrap">安装基本包</span></div></div><code-block id="4wj858GWfLHAMpb3Qcs32D" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">pacstrap <span class="token operator">-</span><span class="token constant">K</span> <span class="token operator">/</span>mnt base linux linux<span class="token operator">-</span>firmware</pre></div></code-block><h1 id="v7LiGyHWsjVzFs4hZEneLZ" class="wolai-block"><span class="inline-wrap">配置系统</span></h1><div id="mQTcXVu1PVPxur4Km1Tjse" class="wolai-block wolai-text"><div><span class="inline-wrap">生成<span class="jill"></span>fatab<span class="jill"></span>文件</span></div></div><code-block id="jQyazm1pH5AGK7toNVJWoA" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">genfstab <span class="token operator">-</span><span class="token constant">U</span> <span class="token operator">/</span>mnt <span class="token operator">>></span> <span class="token operator">/</span>mnt<span class="token operator">/</span>etc<span class="token operator">/</span>fstab</pre></div></code-block><div id="x178NZHdeFXtNr116Ypcga" class="wolai-block wolai-text"><div><span class="inline-wrap">chroot<span class="jill"></span>到新系统</span></div></div><code-block id="gvrwed22RXD1ZDibgvuyvW" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">rch<span class="token operator">-</span>chroot <span class="token operator">/</span>mnt</pre></div></code-block><div id="3ExzDum1UDmENBZUXywtWW" class="wolai-block wolai-text"><div><span class="inline-wrap">设置时区</span></div></div><code-block id="xyLoAUxAAEtZLXd2UGbs9H" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">ln <span class="token operator">-</span>sf usr<span class="token operator">/</span>share<span class="token operator">/</span>zoneinfo<span class="token operator">/</span><span class="token maybe-class-name">Asia</span><span class="token operator">/</span><span class="token maybe-class-name">Shanghai</span> <span class="token operator">/</span>etc<span class="token operator">/</span>localtime</pre></div></code-block><div id="4gwezzL2BVahqa7mWeFt6T" class="wolai-block wolai-text"><div><span class="inline-wrap">生成/etc/adjtime</span></div></div><code-block id="wnV3JMLFCoqkcNnnRFF3CQ" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">hwclock <span class="token operator">--</span>systohc</pre></div></code-block><div id="26hCKKApdwmeYPDqZZZmnT" class="wolai-block wolai-text"><div><span class="inline-wrap">安装<span class="jill"></span>vim</span></div></div><code-block id="nVRBpdXQ1R1oQWAxGxEoKN" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">pacman <span class="token operator">-</span><span class="token constant">S</span> vim</pre></div></code-block><div id="fLWq8bVhE19ZPXYHq6o6Vp" class="wolai-block wolai-text"><div><span class="inline-wrap">生成 /etc/locale.gen</span></div></div><code-block id="nj4at9enNfPQkwrr5pAMvA" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">locale<span class="token operator">-</span>gen</pre></div></code-block><div id="2ihLfyzPZLjWLNUgztE87E" class="wolai-block wolai-text"><div><span class="inline-wrap">取消注释/etc/locale.gen<span class="jill"></span>的下列内容</span></div></div><code-block id="uWdVSkByud9LHD7VnaLBso" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">en_US<span class="token punctuation">.</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span> <span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>
zh_CN<span class="token punctuation">.</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span> <span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span></pre></div></code-block><div id="c79Rxte78HsFNxx5bCiGcA" class="wolai-block wolai-text"><div><span class="inline-wrap">创建/etc/locale.conf<span class="jill"></span>并保存以下内容</span></div></div><code-block id="g5ojo77pF7PMQAeiwHyVG4" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all"><span class="token constant">LANG</span><span class="token operator">=</span>zh_CN<span class="token punctuation">.</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span></pre></div></code-block><div id="3hjSP8ebnPH6QfvqGXcBcf" class="wolai-block wolai-text"><div><span class="inline-wrap">创建主机名</span></div></div><code-block id="dG8m6zk1B7ahym97tWSokX" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">echo <span class="token string">"arch"</span> <span class="token operator">></span> <span class="token operator">/</span>etc<span class="token operator">/</span>hostname</pre></div></code-block><div id="81YzyWQcvh1RmZWQ49yyxM" class="wolai-block wolai-text"><div><span class="inline-wrap">更新<span class="jill"></span>root<span class="jill"></span>密码</span></div></div><code-block id="jLaNGCxsMJnUyFxsdNCKdZ" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">passwd tengfei</pre></div></code-block><div id="mA6aV3ocSzPW3N3muCAWu2" class="wolai-block wolai-text"><div><span class="inline-wrap">安装<span class="jill"></span>grub</span></div></div><code-block id="eHDJ2Y45xwXQzFr2adtDuq" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">pacman <span class="token operator">-</span><span class="token constant">S</span> pacman efibootmgr</pre></div></code-block><div id="g8AMMdz2bNhdkYNRfoFeE4" class="wolai-block wolai-text"><div><span class="inline-wrap">配置<span class="jill"></span>grub</span></div></div><code-block id="687PSwf9FNycird3q7tzS5" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">grub<span class="token operator">-</span>mkconfig <span class="token operator">-</span>o <span class="token operator">/</span>boot<span class="token operator">/</span>grub<span class="token operator">/</span>grub<span class="token punctuation">.</span><span class="token property-access">cfg</span>
grub<span class="token operator">-</span>install <span class="token operator">--</span>target<span class="token operator">=</span>x86_64<span class="token operator">-</span>efi <span class="token operator">--</span>efi<span class="token operator">-</span>directory<span class="token operator">=</span><span class="token operator">/</span>boot<span class="token operator">/</span>efi <span class="token operator">--</span>bootloader<span class="token operator">-</span>id<span class="token operator">=</span><span class="token constant">GRUB</span></pre></div></code-block><div id="51QjcHG2dpLuyBUfFmLrmc" class="wolai-block wolai-text"><div><span class="inline-wrap">退出<span class="jill"></span>chroot</span></div></div><code-block id="q2Bzvw4gowHiTUUnZoKJsY" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">exit</pre></div></code-block><div id="fjLgW9JDhydFWWkZuRV3kV" class="wolai-block wolai-text"><div><span class="inline-wrap">取消挂载</span></div></div><code-block id="vgVtupu7Zt1XgHMQKrn8W3" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">umount <span class="token operator">/</span><span class="token constant">R</span> <span class="token operator">/</span>mnt</pre></div></code-block><div id="ibpJvv8v2fn2C1iiGJnsSY" class="wolai-block wolai-text"><div><span class="inline-wrap">重启</span></div></div><code-block id="kDWfnPJ45iy5C7wNArqHWs" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">reboot</pre></div></code-block><h2 id="seuCYA4mKR4P2TqMcDZHCT" class="wolai-block"><span class="inline-wrap">其他</span></h2><div id="r52eb3SmzNnigGrUzkN4Pi" class="wolai-block wolai-text"><div><span class="inline-wrap">必装项目</span></div></div><code-block id="wrAAuSVfPFJzjKQVSydKFp" class="wolai-block"><div class="wolai-pre"><div data-lang="纯文本" class="marker"></div><pre style="white-space: pre-wrap; word-break: break-all">pacman <span class="token operator">-</span><span class="token constant">S</span> base<span class="token operator">-</span>devel  yay</pre></div></code-block><div id="wJr4zMJMRur7EGx3dh3vEg" class="wolai-block wolai-text"><div><span class="inline-wrap">配置<span class="jill"></span>DHCP、sudo、普通用户、GUI</span></div></div></article><footer></footer></body></html>